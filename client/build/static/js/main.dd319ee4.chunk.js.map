{"version":3,"sources":["App/assets/mockups.png","App/utilities/SearchResultUtilities.js","App/components/PlayerSearchResult.js","App/components/ClubSearchResult.js","App/components/SearchBar.js","App/components/LoadingSpinner.js","App/pages/Home.js","App/pages/Search.js","App/utilities/SliceUtilities.js","App/components/SliceOptions.js","App/components/Slice.js","App/components/GlossaryOverlay.js","App/components/CompareSearchOverlay.js","App/components/LoaderOverlay.js","App/pages/Stats.js","App/pages/Compare.js","App/pages/Error.js","App/components/ExplanationOverlay.js","App/pages/AdvancedSearch.js","App/App.js","index.js"],"names":["module","exports","leagueNames","getAllEntriesFromObject","object","allInfo","season","i","value","includes","filter","item","unshift","length","PlayerSearchResult","props","isMobile","clubs","positions","state","page","forComparison","comparisonCode","code","name","age","nationalities","countryCodes","link","this","flagSizeMultiplier","flagsDisplay","countryCode","push","basePath","country","format","pngSize","width","height","shiny","alt","to","tabIndex","className","join","Component","ClubSearchResult","SearchBar","_isMounted","_firstRequest","getSearchResults","query","signal","liveSearchEnabled","controller","AbortController","Promise","resolve","reject","fetch","method","headers","body","JSON","stringify","then","res","ok","json","Error","searchResults","catch","error","handleChange","event","setState","target","handleChangeLive","abort","liveResultsOpen","isLoading","updateLiveSearchResults","playerSearchResults","clubSearchResults","handleFocus","$","css","handleBlur","handleSubmit","preventDefault","history","handleSubmitLive","currentPlayerCode","e","containerID","displayHomeButton","undefined","playerCards","current","key","clubCards","id","style","display","color","onOutsideClick","onSubmit","type","placeholder","autoComplete","onChange","onFocus","withRouter","LoadingSpinner","Home","getDatabaseSize","databaseSize","Math","max","document","documentElement","clientHeight","window","innerHeight","addClass","toggleNavbar","responsiveNavbar","attr","removeClass","hideNavbar","title","recordPageViewGA","location","pathname","message","onClick","href","rel","toLocaleString","fontWeight","src","mockUps","backgroundColor","Search","searchByClub","processSearchResults","filteredPlayerSearchResults","filterByName","parse","input","normalize","replace","toUpperCase","filterValue","match","params","nextProps","nextContext","searchText","marginTop","cookies","Cookies","colorArrays","alignments","filterStats","stats","selectedCompetitions","playerCode","filteredStats","competition","stat","calculateStats","percentileEntries","percentileSeason","percentileArrays","template","padjTypes","pAdjTypes","selectedSeasons","percentileArrayOccurrences","statsPer90","percentiles","minutesOverNinety","touchesOverHundred","isFinite","calculatePercentileRank","array","occurrences","constructChartInput","statsByPosition","playerName","minutes","isForComparison","index","colors","verticalAlignments","horizontalAlignments","isSecondPlayer","p90_labels","someStats","threeDigitStats","precision","parseFloat","round","toFixed","truncate","percentile_labels","roundedStats","roundNumbers","chartInput","y","p90_label","percentile_label","ordinalSuffix","dataLabels","align","verticalAlign","Highcharts","Color","setOpacity","get","tooltipColor","borderColor","borderWidth","aNumber","j","k","ageRangesString","ageArray","rstart","rend","ranges","changeTemplate","codes","competitions","newTemplate","isOutfieldGK","outfieldGKStats","standardStats","isAnimated","changeSelectedCompetitions","entry","clickedSeason","clickedCompetition","clickedValues","split","isLastCompetition","counter","splice","indexOf","changePAdjTypes","clickedType","set","path","changeLabelType","labelType","toggleCreditsPosition","newPosition","creditsPosition","exportChart","a","showExportLoaderOverlay","renderForExport","Object","values","names","on","setTimeout","node","getElementById","firstExport","domtoimage","toPng","bgcolor","blob","console","log","alert","saveAs","remove","toggleGlossaryOverlay","currentState","showGlossaryOverlay","toggleCompareSearchOverlay","showCompareSearchOverlay","focus","SliceOptions","constructCompetitionLabels","competitionsForms","competitionLabels","multipleClubs","marginBottom","currentCompetition","isIncluded","label","substring","checked","templateOpen","labelTypes","offensive","defensive","isGK","templateLabels","mobileTemplateLabels","position","mobileClassName","disabled","templatesForm","open","trigger","transitionTime","transitionCloseTime","mobileTemplatesForm","playerCompetitions","labelTypeForm","labelTypeLabels","pAdjTypeLabels","pAdjTypeForm","HighchartsMore","NoDataToDisplay","Slice","chartEvents","xAxisLabelDistance","isForExport","fontSizes","subtitle","noData","xAxisLabels","dataLabelsOutline","tooltipHeader","tooltip","legend","credits","yAxisLabels","legendTitle","categories","statTypes","offensiveVariable","defensiveVariable","constant","competitionDict","subtitles","load","element","onclick","tooltipPositioner","labelWidth","labelHeight","point","x","scrollHeight","plotX","plotY","creditsText","lastUpdated","chartOptions","useHTML","text","fontSize","margin","pane","startAngle","chart","fontFamily","animation","polar","marginLeft","marginRight","events","zoomType","panning","panKey","xAxis","labels","zIndex","distance","padding","gridLineWidth","gridLineColor","gridZIndex","yAxis","visible","enabled","lineWidth","endOnTick","showFirstLabel","showLastLabel","min","tickPositions","series","plotOptions","duration","isAnimatedInitial","states","hover","textOutline","allowOverlap","z","mouseOut","slice","hide","column","grouping","shadow","hasTooltip","shared","outside","positioner","followPointer","headerFormat","pointFormat","symbolPadding","layout","itemStyle","itemHoverStyle","itemMarginTop","lineHeight","lang","wrap","Axis","prototype","proceed","call","seriesGroup","renderer","g","add","coll","gridGroup","options","afterChartCreated","bind","allItems","legendSymbol","setAttribute","drawLegendBorders","prevProps","prevState","snapshot","allCompetitions","allSeasons","currentSeasonString","currentSeason","allCompetitionsClubDict","selectedCompetitionsClubDict","isSelected","competitionName","competitionClub","url","temp","player1","selectedCompetitionsString","player2","competitionStringParts","ages","offensiveSuffix","defensiveSuffix","map","data","pointPadding","groupPadding","stickyTracking","helpButton","constructorType","highcharts","containerProps","callback","GlossaryOverlay","CompareSearchOverlay","currentPlayerName","LoaderOverlay","Stats","getStats","response","processStats","redirect","newPercentileArrays","updatePercentileArrays","playerData","seasons","keys","fbrefURL","dateFormat","isSafari","pAdjTypesCookie","labelTypeCookie","creditsPositionCookie","calculatedStats","exportSlice","require","Compare","urls","hasOutfieldGKStats","code1","code2","ExplanationOverlay","toggleExplanationOverlay","Option","Select","_","AdvancedSearch","_firstSearchMade","_referenceData","_statsReferenceDataArraySorted","_parametersOriginalState","_baseColumns","selector","minWidth","sortable","sortFunction","rowA","rowB","localeCompare","ignoreRowClick","cell","row","_customStyles","headCells","getReferenceData","referenceData","processReferenceData","statsReferenceDataArray","statsReferenceData","sort","b","displayOrder","filterOptions","parameters","queryParameters","ageReferenceData","minutesReferenceData","aggregateStats","ranges_agg","nationalitiesOptions","countries","toLowerCase","clubsOptions","club","aggregateStatsOptions","statData","types","averageStatsOptions","suffix","averageStats","buildPercentileRankSelectList","leagues","buildClubsSelectList","handleQueryParameters","isEqual","fromQueryString","showSearchLoaderOverlay","percentileRanks","statRanges","tableColumns","displayType","cloneDeep","searchResultsDisplay","buildSearchResultsDisplay","showExplanationOverlay","handleTableButtonClick","handleCardsButtonClick","tableRows","Array","isArray","columns","theme","customStyles","striped","pagination","paginationPerPage","fixedHeader","allowOverflow","overflowY","overflowX","defaultSortAsc","handleSingleSelectChange","oldValue","setQuery","handleIncludeEuropeanCompetitionsClick","includeEuropeanCompetitions","handleRangeSliderChange","handleSelectListAdd","handleSelectListRemove","handleSelectListClear","percentileRankOptions","hasOwnProperty","eligibleClubs","selectedLeagues","clubsReferenceData","handleLookupStatSelectListAdd","parametersKey","rangesKey","handleLookupStatSelectListRemove","handleLookupStatsSelectListClear","resetParameters","parametersOriginalState","tooltipFormatter","seasonOptions","positionsOptions","leaguesOptions","league","displayTypeCookie","createTheme","background","default","aggregateStatSliders","range","step","step_agg","averageStatsSliders","tipFormatter","percentileRanksSliders","val","defaultValue","mode","allowClear","onSelect","onDeselect","onClear","filterOption","option","children","overlayClassName","withQueryParams","JsonParam","isMobileOnly","ReactGA","initialize","createBrowserHistory","listen","action","reload","App","getPercentileArrays","localStorage","setItem","pageview","getItem","exact","render","component"],"mappings":"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AAkB,EAAKlL,MAAMkL,gBAGlC,EAAKoI,eAAYpO,EACb,EAAKmO,YACL,EAAKC,UAAa,CACdlM,MAAO,EAAKnH,SAAW,QAAU,QACjCsT,SAAU,MACVC,OAAQ,SACRC,YAAa,QACbjH,WAAY,SACZkH,kBAAmB,SACnBC,cAAe,MACfC,QAAS,MACTC,OAAQ,QACRC,QAAS,QACTC,YAAa,UAIb,EAAK9T,SACL,EAAKqT,UAAa,CACdlM,MAAO,MACPmM,SAAU,QACVC,OAAQ,QACRC,YAAa,SACbjH,WAAY,QACZkH,kBAAmB,QACnBC,cAAe,QACfC,QAAS,QACTC,OAAQ,QACRG,YAAa,MACbF,QAAS,QACTC,YAAa,OAIjB,EAAKT,UAAa,CACdlM,MAAO,QACPmM,SAAU,QACVC,OAAQ,SACRC,YAAa,SACbjH,WAAY,SACZkH,kBAAmB,SACnBC,cAAe,SACfC,QAAS,SACTC,OAAQ,QACRG,YAAa,MACbF,QAAS,QACTC,YAAa,SAMrB,EAAK9T,WAAa,EAAKoT,YACvB,EAAKY,WAAa,CACd,GAAM,CACF,oBACA,iBACA,sBACA,cACA,eACA,iBACA,KACA,kBACA,sBACA,oBACA,YACA,wBAEJ,GAAM,CACF,oBACA,iBACA,sBACA,KACA,2BACA,kBACA,mBACA,eACA,sBACA,oBACA,YACA,wBAEJ,GAAM,CACF,KACA,2BACA,wBACA,oBACA,eACA,sBACA,oBACA,YACA,uBACA,iBACA,qBACA,2BAEJ,GAAM,CACF,KACA,wBACA,mBACA,eACA,sBACA,oBACA,YACA,uBACA,gBACA,gBACA,0BACA,gBAEJ,GAAM,CACF,wBACA,mBACA,eACA,oBACA,kBACA,gBACA,qBACA,0BACA,kBACA,cACA,eACA,cAEJ,GAAM,CACF,SACA,mBACA,yBAEJ,MAAO,CACH,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,IACA,MAKR,EAAKA,WAAa,CACd,GAAM,CACF,oBACA,iBACA,sBACA,cACA,eACA,iBACA,KACA,kBACA,sBACA,oBACA,YACA,wBAEJ,GAAM,CACF,oBACA,iBACA,sBACA,KAC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","file":"static/js/main.dd319ee4.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/mockups.c413c538.png\";","const leagueNames = {\r\n    \"_england\": \"Premier League\",\r\n    \"es\": \"La Liga\",\r\n    \"it\": \"Serie A\",\r\n    \"de\": \"Bundesliga\",\r\n    \"fr\": \"Ligue 1\"\r\n};\r\n\r\n\r\nexport function getLeaguesDisplay(leagueCodesArray){\r\n\r\n    let leagueNamesArray = leagueCodesArray.map(x => leagueNames[x]);\r\n\r\n    return leagueNamesArray.join(\", \");\r\n\r\n}\r\n\r\n\r\nexport function getMostRecentPositions(positions){\r\n\r\n    let latestPositions = [];\r\n\r\n    let seasons = Object.keys(positions);\r\n\r\n    for (let i=seasons.length-1; i>=0; i--){\r\n        let season = seasons[i];\r\n        let currentSeasonPositions = positions[season];\r\n        latestPositions = (currentSeasonPositions === undefined || currentSeasonPositions.length < 1 || currentSeasonPositions[0] === \"N/A\") ? [\"-\"] : currentSeasonPositions;\r\n        if (latestPositions[0] !== \"-\"){\r\n            break;\r\n        }\r\n    }\r\n\r\n}\r\n\r\n\r\nexport function getAllEntriesFromObject(object){\r\n\r\n    let allInfo = [];\r\n\r\n    for (let season in object){\r\n\r\n        for (let i=0; i<object[season].length; i++){\r\n\r\n            let value = object[season][i];\r\n\r\n            if (value === \"N/A\")\r\n                value = \"-\";\r\n\r\n            if (allInfo.includes(value))\r\n                allInfo = allInfo.filter(item => item !== value);\r\n\r\n            allInfo.unshift(value)\r\n\r\n        }\r\n\r\n    }\r\n\r\n    if (allInfo.length > 1){\r\n        allInfo = allInfo.filter(item => item !== \"-\");\r\n    }\r\n\r\n    return allInfo;\r\n\r\n\r\n}\r\n","import React, { Component } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport Flag from \"react-flags\";\r\nimport { getAllEntriesFromObject } from \"../utilities/SearchResultUtilities\";\r\n\r\n/**\r\n * Component to render a player search result\r\n */\r\nclass PlayerSearchResult extends Component {\r\n\r\n    constructor(props) {\r\n\r\n        super(props);\r\n\r\n        this.isMobile = this.props.isMobile;\r\n\r\n        let season = this.props.season;\r\n\r\n        let clubs = this.props.clubs;\r\n        let positions = this.props.positions;\r\n\r\n        if (season !== null){\r\n            clubs = clubs[season];\r\n            positions = positions[season];\r\n\r\n            if (positions[0] === \"N/A\"){\r\n                positions[0] = \"-\";\r\n            }\r\n        }\r\n\r\n        else {\r\n            clubs = getAllEntriesFromObject(clubs);\r\n            positions = getAllEntriesFromObject(positions);\r\n        }\r\n\r\n        this.state = {\r\n            page: this.props.page,\r\n            forComparison: this.props.forComparison,\r\n            comparisonCode: this.props.comparisonCode,\r\n            code: this.props.code,\r\n            name: this.props.name,\r\n            age: this.props.age,\r\n            clubs: clubs,\r\n            nationalities: this.props.nationalities,\r\n            countryCodes: this.props.countryCodes,\r\n            positions: positions\r\n        };\r\n\r\n    }\r\n\r\n    /**\r\n     * render function\r\n     * @return {*} - JSX code for a player search result\r\n     */\r\n    render() {\r\n\r\n        let {\r\n            page,\r\n            forComparison,\r\n            comparisonCode,\r\n            code,\r\n            name,\r\n            age,\r\n            clubs,\r\n            nationalities,\r\n            countryCodes,\r\n            positions\r\n        } = this.state;\r\n\r\n        let link;\r\n        //set the link to the comparison page if it is a result for a player comparison\r\n        if (forComparison) {\r\n            link = `/compare/${comparisonCode}_${code}`;\r\n        }\r\n        //set the link to the stats page otherwise\r\n        else {\r\n            link = `/stats/${code}`;\r\n        }\r\n\r\n        let flagSizeMultiplier = this.isMobile ? 1.8 : 1;\r\n\r\n        let flagsDisplay = [];\r\n\r\n        for (let i=0; i<countryCodes.length; i++){\r\n\r\n            let countryCode = countryCodes[i];\r\n\r\n            flagsDisplay.push(\r\n                <Flag\r\n                    basePath={\"/flags\"}\r\n                    country={countryCode}\r\n                    format=\"png\"\r\n                    pngSize={32}\r\n                    width={(page === \"live\" ? 20 : 28) * flagSizeMultiplier}\r\n                    height={(page === \"live\" ? 20 : 28) * flagSizeMultiplier}\r\n                    shiny={true}\r\n                    alt={`${nationalities} Flags`}\r\n                />\r\n            )\r\n\r\n        }\r\n\r\n        return (\r\n            <Link to={link}>\r\n                <div tabIndex=\"0\" className=\"search-result\">\r\n                    <div className=\"bio\">\r\n                        <span className=\"name\">{name}</span>\r\n                        <div>\r\n                            {flagsDisplay}\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"bio-extra\">\r\n                        <span className=\"club\">{clubs?.join(\", \")}</span>\r\n                        <span className=\"position-age\">{`${age} | ${positions?.join(\", \")}`}</span>\r\n                    </div>\r\n                </div>\r\n            </Link>\r\n        );\r\n    }\r\n\r\n}\r\n\r\nexport default (PlayerSearchResult);\r\n","import React, { Component } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport Flag from \"react-flags\";\r\n\r\n\r\n/**\r\n * Component to render a club search result\r\n */\r\nclass ClubSearchResult extends Component {\r\n\r\n    constructor(props) {\r\n\r\n        super(props);\r\n\r\n        this.isMobile = this.props.isMobile;\r\n\r\n        this.state = {\r\n            page: this.props.page,\r\n            name: this.props.name,\r\n            countryCode: this.props.countryCode\r\n        };\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * render function\r\n     * @return {*} - JSX code for a club search result\r\n     */\r\n    render() {\r\n\r\n        let { page, name, countryCode } = this.state;\r\n\r\n        let flagSizeMultiplier = this.isMobile ? 2 : 1;\r\n\r\n        return (\r\n            <Link to={\"/search/\" + name + \"/all\"}>\r\n                <div tabIndex=\"0\" className=\"search-result\">\r\n                    <div className=\"bio\">\r\n                        <span className=\"name\">{name}</span>\r\n                        <Flag\r\n                            basePath={\"/flags\"}\r\n                            country={countryCode}\r\n                            format=\"png\"\r\n                            pngSize={32}\r\n                            width={(page === \"live\" ? 20 : 28) * flagSizeMultiplier}\r\n                            height={(page === \"live\" ? 20 : 28) * flagSizeMultiplier}\r\n                            shiny={true}\r\n                            alt={`${countryCode} Flag`}\r\n                        />\r\n                    </div>\r\n                </div>\r\n            </Link>\r\n        );\r\n    }\r\n\r\n}\r\n\r\nexport default (ClubSearchResult);\r\n","import React, { Component } from 'react';\r\nimport { Link, withRouter } from 'react-router-dom';\r\nimport OutsideClickHandler from 'react-outside-click-handler';\r\n\r\n//import components\r\nimport PlayerSearchResult from \"./PlayerSearchResult\";\r\nimport ClubSearchResult from \"./ClubSearchResult\";\r\nimport $ from \"jquery\";\r\n\r\n\r\n/**\r\n * Component to render a div containing a searchbar\r\n * Also handles the live search requests and aborts\r\n */\r\nclass SearchBar extends Component {\r\n\r\n    //class variable to track if the component is mounted\r\n    _isMounted = false;\r\n    _firstRequest = true;\r\n\r\n    constructor(props) {\r\n\r\n        super(props);\r\n\r\n        this.page = this.props.page;\r\n        this.isMobile = this.props.isMobile;\r\n        this.currentPlayerCode = this.props.currentPlayerCode;\r\n        this.liveSearchEnabled = true;\r\n\r\n        //try to create the abort controller for live search requests\r\n        //AbortController is relatively new, so we catch an error and disable live search if it is undefined\r\n        try {\r\n            this.controller = new AbortController();\r\n            // throw new Error(\"ERROR\");\r\n        }\r\n        catch (e) {\r\n            this.liveSearchEnabled = false;\r\n        }\r\n\r\n        //change the searchbar container id based on the page so that the CSS rules modify it accordingly\r\n        this.containerID = \"\";\r\n        switch (this.page) {\r\n            case \"search\":\r\n                this.containerID = \"searchbar-container2\";\r\n                break;\r\n            case \"stats\":\r\n                this.containerID = \"searchbar-container3\";\r\n                break;\r\n            default:\r\n                this.containerID = \"searchbar-container1\";\r\n        }\r\n\r\n        //attach a home button to the searchbar if it is not being displayed on the homepage or the compare dialog\r\n        this.displayHomeButton = 'default';\r\n        if (this.page === \"home\" || this.page === \"compare\"){\r\n            this.displayHomeButton = 'none';\r\n        }\r\n\r\n        this.state = {\r\n            query: this.props.query || \"\",\r\n            isLoading: this.props.query !== undefined,\r\n            error: null,\r\n            liveResultsOpen: false,\r\n            playerSearchResults: [],\r\n            clubSearchResults: [],\r\n        };\r\n\r\n        this.updateLiveSearchResults(this.state.query);\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * Called after component has mounted\r\n     */\r\n    componentDidMount() {\r\n        this._isMounted = true;\r\n    }\r\n\r\n\r\n    /**\r\n     * Function to send a post request to the server to retrieve the search results matching the query\r\n     */\r\n    getSearchResults = (query) => {\r\n\r\n        //create a new abort controller for every request and retrieve its signal\r\n        let signal = null;\r\n        if (this.liveSearchEnabled){\r\n            this.controller = new AbortController();\r\n            signal = this.controller.signal;\r\n        }\r\n\r\n        return new Promise((resolve, reject) => {\r\n            //fetch search results\r\n            //pass signal to the fetch request so it can be cancelled\r\n            //this is done with live searches to cancel the previous request every time a new letter is typed\r\n            fetch('/api/search', {\r\n                signal,\r\n                method: 'post',\r\n                headers: {\r\n                    \"Content-Type\": \"application/json\"\r\n                },\r\n                body: JSON.stringify({\r\n                    \"query\": query,\r\n                    \"type\": \"playersAndClubs\",\r\n                    \"isLive\": true\r\n                })\r\n            })\r\n                .then(res => {\r\n                    if (res.ok) {\r\n                        return res.json()\r\n                    }\r\n                    else {\r\n                        throw new Error(\"Failed to fetch search results. Please refresh the page and try again.\")\r\n                    }\r\n                },\r\n                    () => {\r\n                        reject()\r\n                    })\r\n                .then(searchResults => {\r\n                    resolve(searchResults);\r\n                })\r\n                .catch(error => {\r\n                    reject(error);\r\n                });\r\n        })\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Called just before the component un-mounts\r\n     */\r\n    componentWillUnmount() {\r\n        this._isMounted = false;\r\n    }\r\n\r\n\r\n    /**\r\n     * Function to handle an input to the searchbar if live search is NOT enabled\r\n     * Updates searchbar input value\r\n     * @param {Object} event - the input event from the searchbar input\r\n     */\r\n    handleChange = (event) => {\r\n\r\n        this.setState({\r\n            query: event.target.value,\r\n        });\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Function to handle an input to the searchbar if live search is enabled\r\n     * Updates searchbar input value, fetches search results and sets state\r\n     * @param {Object} event - the input event from the searchbar input\r\n     */\r\n    handleChangeLive = (event) => {\r\n\r\n        let query = event.target.value;\r\n\r\n        //cancel previous request if it's not the first request\r\n        if (this._firstRequest){\r\n            this._firstRequest = false;\r\n        }\r\n        else {\r\n            this.controller.abort();\r\n        }\r\n\r\n        //set searchbar input value and open live search results container\r\n        this.setState({\r\n            query: query,\r\n            liveResultsOpen: query.length > 0,\r\n            isLoading: true\r\n        });\r\n\r\n        this.updateLiveSearchResults(query);\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Function to update the arrays of search results\r\n     * Also handles the display of the loading spinner and error messages (if applicable) in the live container\r\n     */\r\n    updateLiveSearchResults = (query) => {\r\n\r\n        if (query.length > 0){\r\n            this.getSearchResults(query)\r\n                .then((searchResults) => {\r\n                    let playerSearchResults = searchResults['playerSearchResults'];\r\n                    let clubSearchResults = searchResults['clubSearchResults'];\r\n                    if (this._isMounted){\r\n                        this.setState({\r\n                            playerSearchResults: [],\r\n                            clubSearchResults: []\r\n                        }, () => {\r\n                            this.setState({\r\n                                playerSearchResults: playerSearchResults,\r\n                                clubSearchResults: clubSearchResults,\r\n                                error: null,\r\n                                isLoading: false\r\n                            })\r\n                        })\r\n                    }\r\n                }, (error) => {\r\n                    if (this._isMounted){\r\n                        if (error){\r\n                            this.setState({\r\n                                error: error,\r\n                                isLoading: false\r\n                            })\r\n                        }\r\n                    }\r\n                })\r\n        }\r\n        else {\r\n            if (this._isMounted){\r\n                this.setState({\r\n                    error: null,\r\n                    isLoading: false,\r\n                    playerSearchResults: [],\r\n                    clubSearchResults: []\r\n                })\r\n            }\r\n        }\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Function to handle the searchbar being focused\r\n     * Displays the live search results on focus\r\n     * @param {Object} event - the focus event from the searchbar input\r\n     */\r\n    handleFocus = (event) => {\r\n\r\n        let query = event.target.value;\r\n        if (this.isMobile && this.page === \"home\"){\r\n            $(\"#searchbar-container1\").css({\r\n                \"position\": \"fixed\",\r\n                \"top\": 0,\r\n                \"left\": 0,\r\n                \"width\": \"100%\",\r\n                \"z-index\": 7\r\n            });\r\n\r\n            $(\"h1\").css({\r\n                \"display\": \"none\"\r\n            });\r\n\r\n            $(\"#lucky-button\").css({\r\n                \"display\": \"none\"\r\n            });\r\n        }\r\n        this.setState({\r\n            liveResultsOpen: this.liveSearchEnabled && query.length > 0\r\n        })\r\n\r\n    };\r\n\r\n    /**\r\n     * Function to handle the searchbar being blurred (un-focused)\r\n     * hides the live search results\r\n     */\r\n    handleBlur = () => {\r\n\r\n        if (this.isMobile && this.page === \"home\"){\r\n            $(\"#searchbar-container1\").css({\r\n                \"position\": \"relative\",\r\n                \"width\": '75%',\r\n                \"z-index\": 1\r\n            });\r\n\r\n            $(\"h1\").css({\r\n                \"display\": \"block\"\r\n            });\r\n\r\n            $(\"#lucky-button\").css({\r\n                \"display\": \"block\"\r\n            });\r\n\r\n        }\r\n\r\n        this.setState({\r\n            liveResultsOpen: false\r\n        })\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Function to handle submit events from the searchbar input if live search is NOT enabled\r\n     * Redirects to the search URL with the correct URL params\r\n     * @param {Object} event - the submit event from the searchbar input\r\n     */\r\n    handleSubmit = (event) => {\r\n\r\n        event.preventDefault();\r\n\r\n        if (this.page !== \"compare\"){\r\n            this.props.history.push('/search/' + this.state.query);\r\n        }\r\n        else {\r\n\r\n            let query = this.state.query;\r\n\r\n            //open live search results container\r\n            this.setState({\r\n                liveResultsOpen: query.length > 0,\r\n                isLoading: true\r\n            });\r\n\r\n            this.updateLiveSearchResults(query);\r\n\r\n        }\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Function to handle submit events from the searchbar input if live search is enabled\r\n     * Redirects to the search URL with the correct URL params\r\n     * @param {Object} event - the submit event from the searchbar input\r\n     */\r\n    handleSubmitLive = (event) => {\r\n\r\n        event.preventDefault();\r\n\r\n        if (this.page !== \"compare\"){\r\n            this.props.history.push('/search/' + this.state.query);\r\n        }\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * render function\r\n     * modifies searchbar based on the page it is to be displayed on\r\n     * @return {*} - JSX code for the searchbar and its container\r\n     */\r\n    render() {\r\n\r\n        const {\r\n            query,\r\n            isLoading,\r\n            liveResultsOpen,\r\n            playerSearchResults,\r\n            clubSearchResults\r\n        } = this.state;\r\n\r\n        //construct the player cards\r\n        let playerCards = [];\r\n        for (let i=0; i<playerSearchResults.length; i++){\r\n            let current = playerSearchResults[i];\r\n            playerCards.push(\r\n                <PlayerSearchResult\r\n                    isMobile={this.isMobile}\r\n                    page=\"live\"\r\n                    forComparison={this.page === \"compare\"}\r\n                    comparisonCode={this.currentPlayerCode}\r\n                    code={current.code}\r\n                    name={current.name}\r\n                    age={current.age}\r\n                    season={null}\r\n                    clubs={current.clubs}\r\n                    nationalities={current.nationalities}\r\n                    countryCodes={current.countryCodes}\r\n                    positions={current.positions}\r\n                    key={i}\r\n                />\r\n            );\r\n        }\r\n\r\n        //construct the club cards\r\n        let clubCards = [];\r\n        for (let i=0; i<clubSearchResults.length; i++){\r\n            let current = clubSearchResults[i];\r\n            clubCards.push(\r\n                <ClubSearchResult\r\n                    isMobile={this.isMobile}\r\n                    page=\"live\"\r\n                    name={current.name}\r\n                    countryCode={current.countryCode}\r\n                    key={i}\r\n                />\r\n            )\r\n        }\r\n\r\n        //return JSX code for the searchbar\r\n        return (\r\n            <div className=\"searchbar-container\" id={this.containerID}>\r\n                <Link id=\"home-button\" to={'/'}>\r\n                    <div style={{display: this.displayHomeButton}}>\r\n                        <div>\r\n                            Football\r\n                            <span style={{color: '#e4c000', display: 'block'}}>\r\n                                Slices\r\n                                <span style={{color: 'black'}}>.com</span>\r\n                            </span>\r\n                        </div>\r\n                    </div>\r\n                </Link>\r\n                <OutsideClickHandler\r\n                    onOutsideClick={this.handleBlur}\r\n                >\r\n                    <form id=\"searchbar-form\" onSubmit={this.liveSearchEnabled ? this.handleSubmitLive : this.handleSubmit}>\r\n                        <input\r\n                            type=\"text\"\r\n                            id=\"searchbar-input\"\r\n                            value={query}\r\n                            placeholder={this.page === \"compare\" ? \"Search for players...\" : \"Search for players, clubs...\"}\r\n                            autoComplete=\"off\"\r\n                            onChange={this.liveSearchEnabled ? this.handleChangeLive : this.handleChange}\r\n                            onFocus={this.handleFocus}\r\n                        />\r\n                        <div id=\"live-search-results\" style={{display: liveResultsOpen ? 'block' : 'none'}}>\r\n                            <div id=\"live-search-loader\">\r\n                                <div style={{display: isLoading ? 'block' : 'none'}} className=\"loader\">\r\n                                    Loading...\r\n                                </div>\r\n                            </div>\r\n                            <div>\r\n                                <div>\r\n                                    <h3>Players</h3>\r\n                                    {playerCards}\r\n                                    {playerCards.length === 0 ? <p>{isLoading ? \"...\" : \" No results found\"}</p> : null}\r\n                                </div>\r\n                                <div style={{display: this.page === \"compare\" ? 'none' : 'block'}}>\r\n                                    <h3>Clubs</h3>\r\n                                    {clubCards}\r\n                                    {clubCards.length === 0 ? <p>{isLoading ? \"...\" : \" No results found\"}</p> : null}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </form>\r\n                </OutsideClickHandler>\r\n            </div>\r\n\r\n        );\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default withRouter (SearchBar);\r\n","import React, { Component } from 'react';\r\n\r\n\r\n/**\r\n * Renders a pure CSS loading spinner\r\n * taken from: https://projects.lukehaas.me/css-loaders/\r\n */\r\nclass LoadingSpinner extends Component {\r\n\r\n    render() {\r\n        return (\r\n            <div id=\"main\">\r\n                <div className=\"screen\" id=\"loading-screen\">\r\n                    <div className=\"loader\">Loading...</div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n}\r\nexport default (LoadingSpinner);\r\n","import React, { Component } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport OutsideClickHandler from 'react-outside-click-handler';\r\nimport $ from \"jquery\";\r\n\r\n//import components\r\nimport SearchBar from \"../components/SearchBar\"\r\nimport LoadingSpinner from \"../components/LoadingSpinner\";\r\n\r\n//import assets\r\nimport mockUps from \"../assets/mockups.png\"\r\n\r\n\r\n/**\r\n * Homepage component\r\n */\r\nclass Home extends Component {\r\n\r\n    //class variable to track if the component is mounted\r\n    _isMounted = false;\r\n\r\n    /**\r\n     * Constructor\r\n     * @param props\r\n     */\r\n    constructor(props) {\r\n\r\n        super(props);\r\n\r\n        this.isMobile = this.props.isMobile;\r\n\r\n        this.state = {\r\n            isLoading: true,\r\n            error: null,\r\n            databaseSize: 0,\r\n        };\r\n        this.getDatabaseSize();\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * Called after component has mounted\r\n     */\r\n    componentDidMount() {\r\n        this._isMounted = true;\r\n        document.title = \"Home | Football Slices\";\r\n        this.props.recordPageViewGA(window.location.pathname);\r\n    }\r\n\r\n\r\n    /**\r\n     * Function to send a post request to the server to retrieve the number of players currently in the database\r\n     */\r\n    getDatabaseSize = () => {\r\n\r\n        //fetch sample players\r\n        fetch('/api/databaseSize', {\r\n            method: 'post',\r\n            headers: {\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            body: JSON.stringify({})\r\n        })\r\n        .then(res => res.json())\r\n        .then(databaseSize => {\r\n            //only set state if the component is mounter\r\n            if (this._isMounted){\r\n                this.setState({databaseSize: databaseSize.value, isLoading: false});\r\n                //hard code the height of home and the navbar container if it is a mobile device\r\n                //this is done because the soft keyboards on mobile devices affect the view-height\r\n                if (this.isMobile){\r\n                    let height = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);\r\n                    $(\"#home\").css({\"height\": height});\r\n                }\r\n                //add preload class to the hidden menu to disable the first animation\r\n                $(\"#navbar-hidden\").addClass('preload');\r\n            }\r\n        })\r\n        .catch(error => {\r\n            if (this._isMounted){\r\n                this.setState({\r\n                    error: error,\r\n                    isLoading: false\r\n                })\r\n            }\r\n        });\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Called just before the component un-mounts\r\n     */\r\n    componentWillUnmount() {\r\n        this._isMounted = false;\r\n    }\r\n\r\n\r\n    /**\r\n     * Function to display/hide the responsive navbar\r\n     */\r\n    toggleNavbar = () => {\r\n\r\n        //select the responsive navbar element\r\n        let responsiveNavbar = $(\".responsive-navbar\");\r\n\r\n        //expand or hide based on current state\r\n        if (responsiveNavbar.attr(\"id\") === \"navbar-hidden\"){\r\n            responsiveNavbar.attr(\"id\", \"navbar-expanded\");\r\n        }\r\n        else {\r\n            //remove preload class when expanding to re-enable animations\r\n            $(\"#navbar-expanded\").removeClass('preload');\r\n            responsiveNavbar.attr(\"id\", \"navbar-hidden\");\r\n        }\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Function to hide the navbar (called after one of the menu options is clicked)\r\n     */\r\n    hideNavbar = () => {\r\n\r\n        $(\"#navbar-expanded\").removeClass('preload');\r\n        $(\".responsive-navbar\").attr(\"id\", \"navbar-hidden\");\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * render function\r\n     * @return {*} - JSX code for the homepage\r\n     */\r\n    render() {\r\n\r\n        let { isLoading, error, databaseSize } = this.state;\r\n\r\n        //display loading spinner while the server responds to POST request for the sample players\r\n        if (isLoading) {\r\n            return (\r\n                <LoadingSpinner/>\r\n            )\r\n        }\r\n\r\n        //display the error message screen if an error is caught\r\n        else if (error !== null) {\r\n            return (\r\n                <div id=\"main2\">\r\n                    <SearchBar\r\n                        isMobile={this.isMobile}\r\n                        page=\"home\"\r\n                    />\r\n                    <div className=\"screen\" id=\"error-screen\">\r\n                        <p>{error.message}</p>\r\n                    </div>\r\n                </div>\r\n            )\r\n        }\r\n\r\n        //return homepage code otherwise\r\n        else {\r\n\r\n            // //construct the sample player buttons\r\n            // let samplePlayerButton = [];\r\n            // for (let i=0; i<samplePlayers.length; i++){\r\n            //     let current = samplePlayers[i];\r\n            //     samplePlayerButton.push(\r\n            //         <PlayerSearchResult\r\n            //             page = \"home\"\r\n            //             code = {current.code}\r\n            //             name = {current.name}\r\n            //             clubs = {current.clubs}\r\n            //             nationality = {current.nationality}\r\n            //             key = {i}\r\n            //         />\r\n            //     );\r\n            // }\r\n\r\n            //static JSX code for the homepage\r\n            return (\r\n                <div id=\"homepage\">\r\n                    <OutsideClickHandler\r\n                        onOutsideClick={this.hideNavbar}\r\n                    >\r\n                        <div id=\"navbar-container\">\r\n                            <div className=\"navbar\" id=\"navbar-normal\">\r\n                                <a onClick={this.hideNavbar} href=\"#home\">\r\n                                    <div>Home</div>\r\n                                </a>\r\n                                <a href=\"#about\">\r\n                                    <div>About</div>\r\n                                </a>\r\n                                <a href=\"#glossary\">\r\n                                    <div>Glossary</div>\r\n                                </a>\r\n                                <a href=\"#faq\">\r\n                                    <div>F.A.Q.</div>\r\n                                </a>\r\n                                <a href=\"#contact\">\r\n                                    <div>Contact</div>\r\n                                </a>\r\n                                <button onClick={this.toggleNavbar} id=\"burger-icon-container\">\r\n                                    <div id=\"burgerIcon\"><i className=\"fa fa-bars\"/></div>\r\n                                </button>\r\n                            </div>\r\n                            <div className=\"navbar responsive-navbar\" id=\"navbar-hidden\">\r\n                                <a onClick={this.hideNavbar} href=\"#about\">\r\n                                    <div>About</div>\r\n                                </a>\r\n                                <a onClick={this.hideNavbar} href=\"#glossary\">\r\n                                    <div>Glossary</div>\r\n                                </a>\r\n                                <a onClick={this.hideNavbar} href=\"#faq\">\r\n                                    <div>F.A.Q.</div>\r\n                                </a>\r\n                                <a onClick={this.hideNavbar} href=\"#contact\">\r\n                                    <div>Contact</div>\r\n                                </a>\r\n                            </div>\r\n                        </div>\r\n                    </OutsideClickHandler>\r\n                    <div id=\"home\">\r\n                        <h1>Football<span style={{color: '#e4c000'}}>Slices</span></h1>\r\n                        <SearchBar\r\n                            isMobile={this.isMobile}\r\n                            page=\"home\"\r\n                        />\r\n                        <br/>\r\n                        <br/>\r\n                        <br/>\r\n                        <Link to={\"/advancedSearch\"}>\r\n                            <button id=\"lucky-button\">\r\n                                Advanced Search\r\n                            </button>\r\n                        </Link>\r\n                    </div>\r\n                    <div id=\"about\" className=\"homepage-section-container centered-section\">\r\n                        <div id=\"about-section-container\">\r\n                            <div id=\"about-text\">\r\n                                <h2>About</h2>\r\n                                <p>\r\n                                    Football Slices is a stats visualization tool powered\r\n                                    by <a href=\"https://www.highcharts.com\" target=\"_blank\" rel=\"noopener noreferrer\">Highcharts.js</a>,\r\n                                    and adapted from <a href=\"https://projects.fivethirtyeight.com/world-cup-comparisons/\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n                                    FiveThirtyEight's World Cup player profiles.</a>\r\n                                </p>\r\n                                <p>\r\n                                    It is built on a database of <b>{databaseSize.toLocaleString()} players</b> from <b>Europe's top 5 leagues</b>,\r\n                                    with stats from the <b>2018/19 season onwards</b>.\r\n                                </p>\r\n                                <p>\r\n                                    Football Slices is made possible by the incredible work done by the people over\r\n                                    at <a href=\"https://www.fbref.com\" target=\"_blank\" rel=\"noopener noreferrer\">FBref.com</a>,\r\n                                    who provide advanced stats courtesy of <a href=\"https://www.statsbomb.com\" target=\"_blank\" rel=\"noopener noreferrer\">StatsBomb</a>.\r\n                                    Every chart title has a link to the player's page on FBref, where you can find that player's\r\n                                    complete stats sheet. Please do make sure to check out FBref and spread the word about\r\n                                    them if you'd like to see them continue adding more data to their site.\r\n                                </p>\r\n                                <br/>\r\n                                <p><span className=\"accented-p\">Interpreting the Slices</span></p>\r\n                                <p>\r\n                                    A Football Slice is made up of a number of wedges (12 for outfield players, 3 for goalkeepers),\r\n                                    each representing a relevant stat. The length of each wedge corresponds to the\r\n                                    selected player's percentile rank for the stat when they are compared to top-5 league\r\n                                    players who play in a similar position.\r\n                                </p>\r\n                                <p>\r\n                                    The colours help to group similar-ish stats together (as well as improve the charts'\r\n                                    visual impact).\r\n                                </p>\r\n                                <ul>\r\n                                    <li><span style={{color: '#f15c80', fontWeight: 'bold'}}>Red</span> is for goal-scoring & shooting stats,</li>\r\n                                    <li><span style={{color: '#e4c000', fontWeight: 'bold'}}>Yellow</span> is for passing, chance creation & ball progression</li>\r\n                                    <li><span style={{color: '#87e179', fontWeight: 'bold'}}>Green</span> is for dribbling & ball retention</li>\r\n                                    <li><span style={{color: '#7db9f0', fontWeight: 'bold'}}>Blue</span> is for defending</li>\r\n                                    <li>and <span style={{color: '#787ccd', fontWeight: 'bold'}}>Purple</span> is for goalkeeping stats</li>\r\n                                </ul>\r\n                            </div>\r\n                            <div id=\"about-image\">\r\n                                <img src={mockUps} alt=\"Mock-ups\"/>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div id=\"glossary\" style={{backgroundColor: '#f5f6f7'}} className=\"homepage-section-container centered-section\">\r\n                        <div id=\"glossary-section-container\">\r\n                            <h2>Glossary</h2>\r\n                            <ul>\r\n                                <li>\r\n                                    <span style={{color: '#f15c80', fontWeight: 'bold'}}>Non-Penalty Goal</span>&nbsp;\r\n                                    A goal that did not stem directly from a penalty kick.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#f15c80', fontWeight: 'bold'}}>Non-Penalty xG (Expected Goals)</span>&nbsp;\r\n                                    Expected goals that did not stem directly from penalty kicks.*\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#f15c80', fontWeight: 'bold'}}>Non-Penalty xG/Shot</span>&nbsp;\r\n                                    The average expected goal value of shots taken, excluding penalty kicks.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#f15c80', fontWeight: 'bold'}}>Aerial Win</span>&nbsp;\r\n                                    Winning the ball in a duel that was challenged in the air.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#f15c80', fontWeight: 'bold'}}>Aerial Win %</span>&nbsp;\r\n                                    The percentage of aerials duels contested that were won.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#e4c000', fontWeight: 'bold'}}>Touch in Box</span>&nbsp;\r\n                                    Having possession of the ball in the opposition's penalty area.\r\n                                    (Note: Receiving a pass, then dribbling, then sending a pass counts as one touch)\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#e4c000', fontWeight: 'bold'}}>xA (Expected Assists)</span>&nbsp;\r\n                                    Expected goals that resulted from a player's shot assists, including set pieces.*\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#e4c000', fontWeight: 'bold'}}>OP (Open Play) Shot-Creating Action</span>&nbsp;\r\n                                    Excluding set pieces, one of the last two offensive actions that directly\r\n                                    led to a shot; such as a pass, dribble or a drawn foul.\r\n                                    (Note: A single player can receive credit for multiple actions and the shot-taker can also receive credit)\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#e4c000', fontWeight: 'bold'}}>Pass into Box</span>&nbsp;\r\n                                    A completed pass that entered the opposition's penalty area, excluding set pieces.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#e4c000', fontWeight: 'bold'}}>Pass into Final 1/3</span>&nbsp;\r\n                                    A completed pass that entered the third of the pitch that is closest to the opposition's goal, excluding set pieces.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#e4c000', fontWeight: 'bold'}}>Yards Progressed</span>&nbsp;\r\n                                    Distance, in yards, that the ball was moved towards the oppositions's goal\r\n                                    with passes and carries.\r\n                                    (Note: Passes and carries away from the oppositions's goal are counted as zero progressive yards)\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#e4c000', fontWeight: 'bold'}}>Pass Completion %</span>&nbsp;\r\n                                    The percentage of attempted passes that successfully found a teammate.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#e4c000', fontWeight: 'bold'}}>Long Pass Completion %</span>&nbsp;\r\n                                    The percentage of attempted passes of 25 yards or more that successfully found a teammate.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#e4c000', fontWeight: 'bold'}}>Launched Pass Completion %</span>&nbsp;\r\n                                    The percentage of attempted passes of 40 yards or more that successfully found a teammate, including goal kicks.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#87e179', fontWeight: 'bold'}}>Successful Dribble</span>&nbsp;\r\n                                    A successful attempt at taking on a player and making it past them whilst retaining possession.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#87e179', fontWeight: 'bold'}}>Dribble Success %</span>&nbsp;\r\n                                    The percentage of attempted dribbles that were successful.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#87e179', fontWeight: 'bold'}}>Turnover</span>&nbsp;\r\n                                    A miscontrol, or being tackled by an opponent and losing possession of the ball without attempting a dribble.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#7db9f0', fontWeight: 'bold'}}>pAdj</span>&nbsp;\r\n                                    Possession Adjusted (using the StatsBomb sigmoid function).**\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#7db9f0', fontWeight: 'bold'}}>Successful Pressure</span>&nbsp;\r\n                                    A pressing action that led to the team regaining possession within the next 5 seconds.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#7db9f0', fontWeight: 'bold'}}>Interception</span>&nbsp;\r\n                                    A prevention of an opponent's pass from reaching another opponent by moving into the line of the pass.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#7db9f0', fontWeight: 'bold'}}>Successful Tackle</span>&nbsp;\r\n                                    A successful dispossession of an opponent (whether the tackler's team won possession of the ball or not).\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#7db9f0', fontWeight: 'bold'}}>Tackle/Dribbled Past %</span>&nbsp;\r\n                                    The percentage of dribblers faced that were tackled.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#7db9f0', fontWeight: 'bold'}}>Aerial Win</span>&nbsp;\r\n                                    Winning the ball in a duel that was challenged in the air.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#7db9f0', fontWeight: 'bold'}}>Aerial Win %</span>&nbsp;\r\n                                    The percentage of aerials duels contested that were won.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#7db9f0', fontWeight: 'bold'}}>Clearance</span>&nbsp;\r\n                                    An action where a player kicked/headed the ball away from their own goal.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#787ccd', fontWeight: 'bold'}}>GSAA (Goals Saved Above Average) %</span>&nbsp;\r\n                                    (Post-Shot xG  Goals Conceded (excluding own goals))  Shots on Target Faced.***\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#787ccd', fontWeight: 'bold'}}>Cross Stopping %</span>&nbsp;\r\n                                    The percentage of attempted crosses into the penalty area that were stopped by the goalkeeper.\r\n                                </li>\r\n                            </ul>\r\n                            <div id=\"glossary-links\">\r\n                                <span>\r\n                                    * <a href=\"https://fbref.com/en/expected-goals-model-explained/\" target=\"_blank\" rel=\"noopener noreferrer\">Expected goals/assists model explanation</a>\r\n                                </span>\r\n                                <span>\r\n                                    ** <a href=\"https://statsbomb.com/2014/06/introducing-possession-adjusted-player-stats/\" target=\"_blank\" rel=\"noopener noreferrer\">Possession adjustment explanation</a>\r\n                                </span>\r\n                                <span>\r\n                                    *** <a href=\"https://statsbomb.com/2018/12/introducing-goalkeeper-radars/\" target=\"_blank\" rel=\"noopener noreferrer\">GSAA % explanation</a>\r\n                                </span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div id=\"faq\" className=\"homepage-section-container centered-section\">\r\n                        <div id=\"faq-section-container\">\r\n                            <h2>F.A.Q.</h2>\r\n                            <div id=\"faq-container\">\r\n                                <div className=\"faq-item\">\r\n                                    <p><span className=\"accented-p\">Where does the data come from?</span></p>\r\n                                    <p>\r\n                                        All stats are from <a href=\"https://www.fbref.com\" target=\"_blank\" rel=\"noopener noreferrer\">FBref.com</a>,\r\n                                        who provide advanced stats courtesy of <a href=\"https://www.statsbomb.com\" target=\"_blank\" rel=\"noopener noreferrer\">StatsBomb</a>.\r\n                                        The metadata is from <a href=\"https://www.whoscored.com\" target=\"_blank\" rel=\"noopener noreferrer\">WhoScored.com</a>.\r\n                                    </p>\r\n                                </div>\r\n                                <div className=\"faq-item\">\r\n                                    <p><span className=\"accented-p\">Who's included in the database? How often is it updated?</span></p>\r\n                                    <p>\r\n                                        The database includes all top 5 league players who've made 4 or more league appearances\r\n                                        in any of the covered seasons. It is updated about once a week.\r\n                                    </p>\r\n                                </div>\r\n                                <div className=\"faq-item\">\r\n                                    <p><span className=\"accented-p\">How are the percentile ranks calculated?</span></p>\r\n                                    <p>\r\n                                        The percentile rank of a score is the percentage of scores within a dataset\r\n                                        that are equal to or lower than the score. This is reversed for stats where\r\n                                        a lower value is better, such as 'turnovers'.\r\n                                    </p>\r\n                                    <p>\r\n                                        The percentile ranks for FootballSlices are position-specific. For example,\r\n                                        selecting the 'forward' template compares the selected player only to other forwards in the\r\n                                        database. The percentile ranks are also season-specific. For example, selecting competitions\r\n                                        from the 2018/19 season will only compare the selected player to the 2018/19 dataset. Selecting\r\n                                        competitions from multiple seasons will compare the selected player to the combined dataset.\r\n                                    </p>\r\n                                    <p>\r\n                                        However, please note that the percentile ranks are not competition-specific. In other words,\r\n                                        the selected player's stats are always compared to other players' stats from all competitions, regardless\r\n                                        of which competitions are toggled for the selected player.\r\n                                    </p>\r\n                                </div>\r\n                                <div className=\"faq-item\">\r\n                                    <p><span className=\"accented-p\">How are the possession-adjusted stats calculated?</span></p>\r\n                                    <p>\r\n                                        Possession-adjusted offensive stats are obtained by calculating the number of times\r\n                                        a player completes an action for every 100 touches of the ball they have.\r\n                                    </p>\r\n                                    <p>\r\n                                        Defensive stats are adjusted for possession using the StatsBomb sigmoid function,\r\n                                        which you can read more about <a href=\"https://statsbomb.com/2014/06/introducing-possession-adjusted-player-stats/\"\r\n                                                                    target=\"_blank\" rel=\"noopener noreferrer\">here</a>.\r\n                                        Each player's stats for a particular competition are adjusted based on their team's\r\n                                        average possession during said competition.\r\n                                    </p>\r\n                                    <p>\r\n                                        Ideally, a player's stats should be adjusted based on the possession\r\n                                        stats from only the games they played in. However, I don't have access to that\r\n                                        data and so I used the next best thing; which is the team's average possession\r\n                                        across all games in the competition.\r\n                                    </p>\r\n                                </div>\r\n                                <div className=\"faq-item\">\r\n                                    <p><span className=\"accented-p\">How are the player positions decided?</span></p>\r\n                                    <p>\r\n                                        Position data is obtained using the 'detailed' tab of the <a href=\"https://whoscored.com/Statistics\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n                                        WhoScored.com player statistics table</a> to find all players who've made 10 or more\r\n                                        league starts in each of the template positions during a particular season.\r\n                                    </p>\r\n                                </div>\r\n                                <div className=\"faq-item\">\r\n                                    <p><span className=\"accented-p\">\r\n                                        Will the database be expanded to include seasons before 2018/19 and players outside the top 5 leagues?\r\n                                    </span></p>\r\n                                    <p>\r\n                                        Probably not. At present, <a href=\"https://www.fbref.com\" target=\"_blank\" rel=\"noopener noreferrer\">FBref.com</a>'s advanced stats\r\n                                        are only available for a few seasons and leagues.\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div id=\"contact\" style={{backgroundColor: '#f5f6f7'}} className=\"homepage-section-container\">\r\n                        <div id=\"contact-section-container\">\r\n                            <h2>Contact</h2>\r\n                            <p>\r\n                                For any bug reports, suggestions or questions, please feel free to reach out to me\r\n                                at either of the following:\r\n                            </p>\r\n                            <ul>\r\n                                <li>Twitter: <a href=\"https://twitter.com/FootballSlices\" target=\"_blank\" rel=\"noopener noreferrer\">@FootballSlices</a></li>\r\n                                <li>Email: <a href=\"mailto:footballslices@gmail.com\" target=\"_blank\" rel=\"noopener noreferrer\">FootballSlices@gmail.com</a></li>\r\n                            </ul>\r\n                            <p>\r\n                                Note: Football Slices is a hobby project created and maintained\r\n                                by Ham (<a href=\"https://twitter.com/DyslexicDdue\" target=\"_blank\" rel=\"noopener noreferrer\">@DyslexicDdue</a>).\r\n                                I try to implement as many suggested features as I can, but unfortunately, I can't\r\n                                guarantee that I'll get to everything.\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            );\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default Home;\r\n","import React, { Component } from 'react';\r\n\r\n//import components\r\nimport LoadingSpinner from \"../components/LoadingSpinner\";\r\nimport SearchBar from \"../components/SearchBar\";\r\nimport PlayerSearchResult from \"../components/PlayerSearchResult\";\r\nimport ClubSearchResult from \"../components/ClubSearchResult\";\r\n\r\n\r\n/**\r\n * Search page component\r\n */\r\nclass Search extends Component {\r\n\r\n    //class variable to track if the component is mounted\r\n    _isMounted = false;\r\n\r\n    /**\r\n     * Constructor\r\n     * @param props\r\n     */\r\n    constructor(props){\r\n\r\n        super(props);\r\n\r\n        this.isMobile = this.props.isMobile;\r\n\r\n        this.state = {\r\n            isLoading: true,\r\n            error: null,\r\n            query: props.match.params.query,\r\n            searchByClub: props.match.params.searchByClub,\r\n            playerSearchResults: [],\r\n            filteredPlayerSearchResults: [],\r\n            clubSearchResults: [],\r\n            filterValue: \"\"\r\n        };\r\n\r\n        this.getSearchResults();\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * Called after component has mounted\r\n     */\r\n    componentDidMount() {\r\n        this._isMounted = true;\r\n    }\r\n\r\n\r\n    /**\r\n     * Called just before the component receives new props. This is done to ensure that new props trigger a setState()\r\n     * @param nextProps\r\n     * @param nextContext\r\n     */\r\n    //TODO: re-factor because componentWillReceiveProps has been deprecated\r\n    UNSAFE_componentWillReceiveProps(nextProps, nextContext) {\r\n\r\n        let { query, searchByClub } = nextProps.match.params;\r\n\r\n        this.setState({\r\n            isLoading: true,\r\n            query: query,\r\n            searchByClub: searchByClub\r\n        }, () => {\r\n            this.getSearchResults();\r\n        });\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * Function to send a post request to the server to retrieve the search results matching the query\r\n     */\r\n    getSearchResults = () => {\r\n\r\n        let searchByClub = this.state.searchByClub;\r\n        let type = searchByClub === undefined ? \"playersAndClubs\" : \"playersByClub\";\r\n\r\n        //retrieve search results\r\n        fetch('/api/search', {\r\n            method: 'post',\r\n            headers: {\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            body: JSON.stringify({\r\n                \"query\": this.state.query,\r\n                \"type\": type\r\n            })\r\n        })\r\n        .then(res => {\r\n            if (res.ok) {\r\n                return res.json()\r\n            }\r\n            else {\r\n               throw new Error(\"Failed to fetch search results. Please refresh the page and try again.\")\r\n            }\r\n        })\r\n        .then(searchResults => this.processSearchResults(searchResults))\r\n        .catch(error => {\r\n            if (this._isMounted){\r\n                this.setState({error, isLoading: false})\r\n            }\r\n        });\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Function to process the search results and save to state\r\n     * @param {Object} searchResults - object containing search results\r\n     */\r\n    processSearchResults = (searchResults) => {\r\n\r\n        let playerSearchResults = searchResults['playerSearchResults'];\r\n        let clubSearchResults = searchResults['clubSearchResults'];\r\n\r\n        if (this._isMounted){\r\n\r\n            this.setState({\r\n                searchResults: []\r\n            }, () => {\r\n                this.setState({\r\n                    error: null,\r\n                    isLoading: false,\r\n                    playerSearchResults: playerSearchResults,\r\n                    filteredPlayerSearchResults: playerSearchResults,\r\n                    clubSearchResults: clubSearchResults,\r\n                });\r\n            });\r\n\r\n            document.title = \"Search Results | Football Slices\";\r\n\r\n            this.props.recordPageViewGA(window.location.pathname);\r\n        }\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Called just before the component un-mounts\r\n     */\r\n    componentWillUnmount() {\r\n        this._isMounted = false;\r\n    }\r\n\r\n\r\n    /**\r\n     * Function to filter player search results\r\n     * @param {Object} event - the input event from the search result filter\r\n     */\r\n    filterByName = (event) => {\r\n\r\n        //create a deep-copy of playerSearchResults to avoid modifying the original\r\n        let playerSearchResults = JSON.parse(JSON.stringify(this.state.playerSearchResults));\r\n        let filteredPlayerSearchResults = [];\r\n\r\n        let input = \"\";\r\n        if (event === null) {\r\n            filteredPlayerSearchResults = playerSearchResults;\r\n        }\r\n        else {\r\n            //retrieve the input text and remove diacritics\r\n            input = event.target.value\r\n                .normalize(\"NFD\")\r\n                .replace(/[\\u0300-\\u036f]/g, \"\")\r\n                .replace(\"\", \"O\")\r\n                .replace(\"\", \"o\");\r\n            for (let i=0; i<playerSearchResults.length; i++){\r\n                //remove diacritics from each search result\r\n                let name = playerSearchResults[i].name.normalize(\"NFD\")\r\n                    .replace(/[\\u0300-\\u036f]/g, \"\")\r\n                    .replace(\"\", \"O\")\r\n                    .replace(\"\", \"o\");\r\n                //push matches to filteredSearchResults\r\n                if (name.toUpperCase().includes(input.toUpperCase())){\r\n                    filteredPlayerSearchResults.push(playerSearchResults[i]);\r\n                }\r\n            }\r\n        }\r\n\r\n        //set state by clearing filteredSearchResults first, and the re-populating it on callback\r\n        this.setState({\r\n            filteredPlayerSearchResults: [],\r\n            filterValue: input\r\n        }, () => {\r\n            this.setState({\r\n                filteredPlayerSearchResults: filteredPlayerSearchResults,\r\n            })\r\n        });\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * render function\r\n     * @return {*} - JSX code for the search page\r\n     */\r\n    render() {\r\n\r\n        let {\r\n            isLoading,\r\n            error,\r\n            filteredPlayerSearchResults,\r\n            clubSearchResults,\r\n            searchByClub,\r\n            filterValue\r\n        } = this.state;\r\n\r\n        //display loading spinner while the server responds to POST request for the search results\r\n        if (isLoading) {\r\n            return (\r\n                <LoadingSpinner/>\r\n            )\r\n        }\r\n\r\n        //display the error message screen if an error is caught\r\n        else if (error !== null) {\r\n            return (\r\n                <div id=\"main\">\r\n                    <SearchBar\r\n                        isMobile={this.isMobile}\r\n                        page=\"search\"\r\n                        query={this.state.query}\r\n                    />\r\n                    <div className=\"screen\" id=\"error-screen\">\r\n                        <p>{error.message}</p>\r\n                    </div>\r\n                </div>\r\n            )\r\n        }\r\n\r\n        //build search page otherwise\r\n        else {\r\n\r\n            let season = searchByClub ? \"20-21\" : null;\r\n\r\n            //construct the player cards\r\n            let playerCards = [];\r\n            for (let i=0; i<filteredPlayerSearchResults.length; i++){\r\n                let current = filteredPlayerSearchResults[i];\r\n                playerCards.push(\r\n                    <PlayerSearchResult\r\n                        isMobile={this.isMobile}\r\n                        page=\"search\"\r\n                        code={current.code}\r\n                        name={current.name}\r\n                        age={current.age}\r\n                        season={season}\r\n                        clubs={current.clubs}\r\n                        nationalities={current.nationalities}\r\n                        countryCodes={current.countryCodes}\r\n                        positions={current.positions}\r\n                        key={i}\r\n                    />\r\n                );\r\n            }\r\n\r\n            //construct the club cards\r\n            let clubCards = [];\r\n            for (let i=0; i<clubSearchResults.length; i++){\r\n                let current = clubSearchResults[i];\r\n                clubCards.push(\r\n                    <ClubSearchResult\r\n                        isMobile={this.isMobile}\r\n                        page=\"search\"\r\n                        name={current.name}\r\n                        countryCode={current.countryCode}\r\n                        key={i}\r\n                    />\r\n                )\r\n            }\r\n\r\n            //build header for search results\r\n            let searchText;\r\n            if (searchByClub === undefined){\r\n                searchText = <h3>Search results for <br/>\"{this.state.query}\"</h3>;\r\n            }\r\n            else {\r\n                searchText = <h3>Search results for <br/>\"player.club[20-21] = {this.state.query}\"</h3>;\r\n            }\r\n\r\n            //return JSX code for the search page\r\n            return (\r\n                <div id=\"main\">\r\n                    <SearchBar\r\n                        isMobile={this.isMobile}\r\n                        page=\"search\"\r\n                        query={this.state.query}\r\n                    />\r\n                    <div className=\"screen\" id=\"search-screen\">\r\n                        <div className=\"filter\" id=\"search-filters\">\r\n                            <div className=\"filter-inputs search-filter-inputs\" id=\"search-filter-inputs\">\r\n                                {searchText}\r\n                                <br />\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={filterValue}\r\n                                    placeholder={\"Filter players by name\"}\r\n                                    onChange={this.filterByName}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"result scrollable\" id=\"search-results\">\r\n                            {searchByClub === undefined ? <h3>Players</h3> : null}\r\n                            {playerCards.length === 0 && searchByClub === undefined ? <p>No results found</p> : null}\r\n                            <div id=\"player-search-results\">\r\n                                {playerCards}\r\n                            </div>\r\n                            {searchByClub === undefined ? <h3 style={{marginTop: '20px'}}>Clubs</h3> : null}\r\n                            {clubCards.length === 0 && searchByClub === undefined ? <p>No results found</p> : null}\r\n                            <div id=\"club-search-results\">\r\n                                {clubCards}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            );\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default Search;\r\n","import $ from \"jquery\";\r\n\r\n//import dependencies\r\nimport Cookies from 'universal-cookie';\r\nimport Highcharts from \"highcharts\";\r\nimport domtoimage from \"dom-to-image\";\r\nimport saveAs from \"file-saver\";\r\n\r\n//initialize cookies\r\nconst cookies = new Cookies();\r\n\r\n//colors used in the Slices\r\nconst colorArrays = {\r\n    \"FW\": ['#f15c80', '#f15c80', '#f15c80', '#f15c80', '#f15c80', '#e4d354',\r\n        '#e4d354', '#e4d354', '#90ed7d', '#90ed7d', '#90ed7d', '#7cb5ec'],\r\n    \"AM\": ['#f15c80', '#f15c80', '#f15c80', '#e4d354', '#e4d354', '#e4d354',\r\n        '#e4d354', '#e4d354', '#90ed7d', '#90ed7d', '#90ed7d', '#7cb5ec'],\r\n    \"CM\": ['#e4d354', '#e4d354', '#e4d354', '#e4d354', '#e4d354', '#90ed7d',\r\n        '#90ed7d', '#90ed7d', '#7cb5ec', '#7cb5ec', '#7cb5ec', '#7cb5ec'],\r\n    \"FB\": ['#e4d354', '#e4d354', '#e4d354', '#e4d354', '#90ed7d', '#90ed7d',\r\n        '#90ed7d', '#7cb5ec', '#7cb5ec', '#7cb5ec', '#7cb5ec', '#7cb5ec'],\r\n    \"CB\": ['#e4d354', '#e4d354', '#e4d354', '#e4d354', '#7cb5ec', '#7cb5ec',\r\n        '#7cb5ec', '#7cb5ec', '#7cb5ec', '#7cb5ec', '#7cb5ec', '#7cb5ec'],\r\n    \"GK\": ['#9499ff', '#9499ff', '#e4d354'],\r\n    \"comparison\": ['#e75453', '#e75453', '#e75453', '#e75453', '#e75453', '#e75453',\r\n        '#e75453', '#e75453', '#e75453', '#e75453', '#e75453', '#e75453']\r\n};\r\n\r\n//data label alignments\r\nconst alignments = {\r\n    \"vertical\": {\r\n        \"GK\": [\"bottom\", \"top\", \"top\"],\r\n        \"other\": [\"bottom\", \"bottom\", \"middle\", \"middle\", \"middle\", \"top\",\r\n            \"top\", \"top\", \"middle\", \"middle\", \"middle\", \"bottom\"\r\n        ]\r\n    },\r\n    \"horizontal\": {\r\n        \"GK\": [\"center\", \"left\", \"right\"],\r\n        \"other\": [\"center\", \"center\", \"left\", \"left\", \"left\", \"center\",\r\n            \"center\", \"center\", \"right\", \"right\", \"right\", \"center\"\r\n        ]\r\n    }\r\n};\r\n\r\n/**\r\n * Function to filter the complete stats based on the selected competitions\r\n * @param {Object} stats - object containing the complete stats of the player\r\n * @param {String} playerCode - the code of the player whose stats are being filtered (used for comparisons)\r\n * @return {Object} filteredStats - object containing aggregated totals of the filtered stats\r\n */\r\nexport function filterStats(stats, playerCode = undefined){\r\n\r\n    let selectedCompetitions;\r\n    if (playerCode === undefined) {\r\n        selectedCompetitions = this.state.selectedCompetitions;\r\n    }\r\n    else {\r\n        selectedCompetitions = this.state.selectedCompetitions[playerCode];\r\n    }\r\n\r\n    //iterate through complete stats, check if a competition is selected\r\n    //add the stats for said competition to the aggregated stats if so\r\n    //for ages, create an array containing the age range for selected competitions\r\n    let filteredStats = {};\r\n\r\n    for (let season in stats){\r\n        for (let competition in stats[season]){\r\n\r\n            if (selectedCompetitions[season].includes(competition)) {\r\n\r\n                for (let stat in stats[season][competition]) {\r\n\r\n                    let value = stats[season][competition][stat];\r\n\r\n                    if (!(stat in filteredStats)){\r\n                        if (stat === 'age'){\r\n                            filteredStats[stat] = [value];\r\n                        }\r\n                        else {\r\n                            filteredStats[stat] = value;\r\n                        }\r\n                    }\r\n                    else{\r\n                        if (stat === 'age'){\r\n                            if (!filteredStats[stat].includes(value)){\r\n                                filteredStats[stat].push(value);\r\n                            }\r\n                        }\r\n                        else {\r\n                            filteredStats[stat] += value;\r\n                        }\r\n                    }\r\n\r\n                }\r\n\r\n            }\r\n\r\n        }\r\n    }\r\n\r\n    return filteredStats;\r\n\r\n}\r\n\r\n\r\n/**\r\n * Function to calculate the 'per90' stats and percentile ranks of the filtered stats\r\n * @param {Object} filteredStats - object containing the aggregated totals from the selected competitions\r\n * @param playerCode\r\n * @return {{statsPer90, percentiles}} - object containing the per90 stats and percentile ranks\r\n */\r\nexport function calculateStats(filteredStats, playerCode = undefined){\r\n\r\n    let percentileArrays = this.state.percentileArrays;\r\n    let template = this.state.template;\r\n    let selectedCompetitions = this.state.selectedCompetitions;\r\n    let padjTypes = this.state.pAdjTypes;\r\n\r\n    let percentileEntries;\r\n    let selectedSeasons = [];\r\n    if (playerCode === undefined){\r\n\r\n        percentileEntries = this.state.percentileEntries;\r\n\r\n        //iterate through selected competitions and list the seasons they span\r\n        for (let season in selectedCompetitions) {\r\n            if (selectedCompetitions[season].length !== 0) {\r\n                selectedSeasons.push(season);\r\n            }\r\n        }\r\n\r\n    }\r\n    else {\r\n\r\n        percentileEntries = this.state.percentileEntries[playerCode];\r\n        for (let code in selectedCompetitions){\r\n            //iterate through selected competitions and list the seasons they span\r\n            for (let season in selectedCompetitions[code]) {\r\n                if (selectedCompetitions[code][season].length !== 0) {\r\n                    if (!selectedSeasons.includes(season)){\r\n                        selectedSeasons.push(season);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    let percentileSeason;\r\n    //if only one season is selected, set the percentile season to that season\r\n    if (selectedSeasons.length === 1) {\r\n        percentileSeason = selectedSeasons[0];\r\n    }\r\n    //set the percentile season to the combined dataset otherwise\r\n    else {\r\n        percentileSeason = \"combined\";\r\n    }\r\n\r\n    let percentileArrayOccurrences = 0;\r\n    //count how many of the entries in the percentile array belong to the player\r\n    //this is done so that the percentile rank can be adjusted in order not to double count a player's entries\r\n    for (let season in percentileEntries) {\r\n        if (percentileSeason === season || percentileSeason === \"combined\") {\r\n            if (percentileEntries[season].includes(template)) {\r\n                percentileArrayOccurrences = 1;\r\n            }\r\n        }\r\n    }\r\n\r\n    let statsPer90 = {};\r\n    let percentiles = {};\r\n\r\n    //calculate per90 stats\r\n    let minutesOverNinety = filteredStats['minutes'] / 90;\r\n    let touchesOverHundred = filteredStats['touches'] / 100;\r\n\r\n    switch (template) {\r\n\r\n        case \"FW\":\r\n\r\n            statsPer90[\"npg\"] = filteredStats[\"npg\"] / minutesOverNinety;\r\n            statsPer90[\"npxg\"] = filteredStats[\"npxg\"] / minutesOverNinety;\r\n            statsPer90[\"npxgPerShot\"] = filteredStats[\"npxg\"] / filteredStats[\"shots\"];\r\n            statsPer90[\"succAerials\"] = filteredStats[\"succAerials\"] / minutesOverNinety;\r\n            statsPer90[\"aerialSuccRate\"] = (filteredStats[\"succAerials\"] / filteredStats[\"attAerials\"]) * 100;\r\n            statsPer90[\"dribbleSuccRate\"] = (filteredStats[\"succDribbles\"] / filteredStats[\"attDribbles\"]) * 100;\r\n            statsPer90[\"succPressures\"] = filteredStats[\"succPressures\"] / minutesOverNinety;\r\n\r\n            if (padjTypes['offensive']){\r\n                statsPer90[\"padjBoxTouches\"] = filteredStats[\"boxTouches\"] / touchesOverHundred;\r\n                statsPer90[\"padjXA\"] = filteredStats[\"xa\"] / touchesOverHundred;\r\n                statsPer90[\"padjPPA\"] = filteredStats[\"ppa\"] / touchesOverHundred;\r\n                statsPer90[\"padjSuccDribbles\"] = filteredStats[\"succDribbles\"] / touchesOverHundred;\r\n                statsPer90[\"padjTurnovers\"] = (filteredStats[\"timesDispossessed\"] + filteredStats[\"miscontrols\"]) / touchesOverHundred;\r\n            }\r\n            else {\r\n                statsPer90[\"boxTouches\"] = filteredStats[\"boxTouches\"] / minutesOverNinety;\r\n                statsPer90[\"xa\"] = filteredStats[\"xa\"] / minutesOverNinety;\r\n                statsPer90[\"ppa\"] = filteredStats[\"ppa\"] / minutesOverNinety;\r\n                statsPer90[\"succDribbles\"] = filteredStats[\"succDribbles\"] / minutesOverNinety;\r\n                statsPer90[\"turnovers\"] = (filteredStats[\"timesDispossessed\"] + filteredStats[\"miscontrols\"]) / minutesOverNinety;\r\n            }\r\n\r\n            break;\r\n\r\n        case \"AM\":\r\n\r\n            statsPer90[\"npg\"] = filteredStats[\"npg\"] / minutesOverNinety;\r\n            statsPer90[\"npxg\"] = filteredStats[\"npxg\"] / minutesOverNinety;\r\n            statsPer90[\"npxgPerShot\"] = filteredStats[\"npxg\"] / filteredStats[\"shots\"];\r\n            statsPer90[\"passSuccRate\"] = (filteredStats[\"succPasses\"] / filteredStats[\"attPasses\"]) * 100;\r\n            statsPer90[\"dribbleSuccRate\"] = (filteredStats[\"succDribbles\"] / filteredStats[\"attDribbles\"]) * 100;\r\n            statsPer90[\"succPressures\"] = filteredStats[\"succPressures\"] / minutesOverNinety;\r\n\r\n            if (padjTypes['offensive']){\r\n                statsPer90[\"padjXA\"] = filteredStats[\"xa\"] / touchesOverHundred;\r\n                statsPer90[\"padjSCA\"] = filteredStats[\"sca\"] / touchesOverHundred;\r\n                statsPer90[\"padjPPA\"] = filteredStats[\"ppa\"] / touchesOverHundred;\r\n                statsPer90[\"padjProgDistance\"] = filteredStats[\"progDistance\"] / touchesOverHundred;\r\n                statsPer90[\"padjSuccDribbles\"] = filteredStats[\"succDribbles\"] / touchesOverHundred;\r\n                statsPer90[\"padjTurnovers\"] = (filteredStats[\"timesDispossessed\"] + filteredStats[\"miscontrols\"]) / touchesOverHundred;\r\n            }\r\n            else {\r\n                statsPer90[\"xa\"] = filteredStats[\"xa\"] / minutesOverNinety;\r\n                statsPer90[\"sca\"] = filteredStats[\"sca\"] / minutesOverNinety;\r\n                statsPer90[\"ppa\"] = filteredStats[\"ppa\"] / minutesOverNinety;\r\n                statsPer90[\"progDistance\"] = filteredStats[\"progDistance\"] / minutesOverNinety;\r\n                statsPer90[\"succDribbles\"] = filteredStats[\"succDribbles\"] / minutesOverNinety;\r\n                statsPer90[\"turnovers\"] = (filteredStats[\"timesDispossessed\"] + filteredStats[\"miscontrols\"]) / minutesOverNinety;\r\n            }\r\n\r\n            break;\r\n\r\n        case \"CM\":\r\n\r\n            statsPer90[\"passSuccRate\"] = (filteredStats[\"succPasses\"] / filteredStats[\"attPasses\"]) * 100;\r\n            statsPer90[\"dribbleSuccRate\"] = (filteredStats[\"succDribbles\"] / filteredStats[\"attDribbles\"]) * 100;\r\n            statsPer90[\"dribbleTackleRate\"] = (filteredStats[\"succDribbleTackles\"] / filteredStats[\"attDribbleTackles\"]) * 100;\r\n            statsPer90[\"succPressures\"] = filteredStats[\"succPressures\"] / minutesOverNinety;\r\n\r\n            if (padjTypes['offensive']){\r\n                statsPer90[\"padjXA\"] = filteredStats[\"xa\"] / touchesOverHundred;\r\n                statsPer90[\"padjSCA\"] = filteredStats[\"sca\"] / touchesOverHundred;\r\n                statsPer90[\"padjPFT\"] = filteredStats[\"pft\"] / touchesOverHundred;\r\n                statsPer90[\"padjProgDistance\"] = filteredStats[\"progDistance\"] / touchesOverHundred;\r\n                statsPer90[\"padjSuccDribbles\"] = filteredStats[\"succDribbles\"] / touchesOverHundred;\r\n                statsPer90[\"padjTurnovers\"] = (filteredStats[\"timesDispossessed\"] + filteredStats[\"miscontrols\"]) / touchesOverHundred;\r\n            }\r\n            else {\r\n                statsPer90[\"xa\"] = filteredStats[\"xa\"] / minutesOverNinety;\r\n                statsPer90[\"sca\"] = filteredStats[\"sca\"] / minutesOverNinety;\r\n                statsPer90[\"pft\"] = filteredStats[\"pft\"] / minutesOverNinety;\r\n                statsPer90[\"progDistance\"] = filteredStats[\"progDistance\"] / minutesOverNinety;\r\n                statsPer90[\"succDribbles\"] = filteredStats[\"succDribbles\"] / minutesOverNinety;\r\n                statsPer90[\"turnovers\"] = (filteredStats[\"timesDispossessed\"] + filteredStats[\"miscontrols\"]) / minutesOverNinety;\r\n            }\r\n\r\n            if (padjTypes['defensive']){\r\n                statsPer90[\"padjInterceptions\"] = filteredStats[\"padjInterceptions\"] / minutesOverNinety;\r\n                statsPer90[\"padjSuccTackles\"] = filteredStats[\"padjSuccTackles\"] / minutesOverNinety;\r\n            }\r\n            else {\r\n                statsPer90[\"interceptions\"] = filteredStats[\"interceptions\"] / minutesOverNinety;\r\n                statsPer90[\"succTackles\"] = filteredStats[\"succTackles\"] / minutesOverNinety;\r\n            }\r\n\r\n            break;\r\n\r\n        case \"FB\":\r\n\r\n            statsPer90[\"passSuccRate\"] = (filteredStats[\"succPasses\"] / filteredStats[\"attPasses\"]) * 100;\r\n            statsPer90[\"dribbleSuccRate\"] = (filteredStats[\"succDribbles\"] / filteredStats[\"attDribbles\"]) * 100;\r\n            statsPer90[\"dribbleTackleRate\"] = (filteredStats[\"succDribbleTackles\"] / filteredStats[\"attDribbleTackles\"]) * 100;\r\n            statsPer90[\"succPressures\"] = filteredStats[\"succPressures\"] / minutesOverNinety;\r\n            statsPer90[\"aerialSuccRate\"] = (filteredStats[\"succAerials\"] / filteredStats[\"attAerials\"]) * 100;\r\n\r\n            if (padjTypes['offensive']){\r\n                statsPer90[\"padjXA\"] = filteredStats[\"xa\"] / touchesOverHundred;\r\n                statsPer90[\"padjPFT\"] = filteredStats[\"pft\"] / touchesOverHundred;\r\n                statsPer90[\"padjProgDistance\"] = filteredStats[\"progDistance\"] / touchesOverHundred;\r\n                statsPer90[\"padjSuccDribbles\"] = filteredStats[\"succDribbles\"] / touchesOverHundred;\r\n                statsPer90[\"padjTurnovers\"] = (filteredStats[\"timesDispossessed\"] + filteredStats[\"miscontrols\"]) / touchesOverHundred;\r\n            }\r\n            else {\r\n                statsPer90[\"xa\"] = filteredStats[\"xa\"] / minutesOverNinety;\r\n                statsPer90[\"pft\"] = filteredStats[\"pft\"] / minutesOverNinety;\r\n                statsPer90[\"progDistance\"] = filteredStats[\"progDistance\"] / minutesOverNinety;\r\n                statsPer90[\"succDribbles\"] = filteredStats[\"succDribbles\"] / minutesOverNinety;\r\n                statsPer90[\"turnovers\"] = (filteredStats[\"timesDispossessed\"] + filteredStats[\"miscontrols\"]) / minutesOverNinety;\r\n            }\r\n\r\n            if (padjTypes['defensive']){\r\n                statsPer90[\"padjInterceptions\"] = filteredStats[\"padjInterceptions\"] / minutesOverNinety;\r\n                statsPer90[\"padjSuccTackles\"] = filteredStats[\"padjSuccTackles\"] / minutesOverNinety;\r\n            }\r\n            else {\r\n                statsPer90[\"interceptions\"] = filteredStats[\"interceptions\"] / minutesOverNinety;\r\n                statsPer90[\"succTackles\"] = filteredStats[\"succTackles\"] / minutesOverNinety;\r\n            }\r\n\r\n            break;\r\n\r\n        case \"CB\":\r\n\r\n            statsPer90[\"passSuccRate\"] = (filteredStats[\"succPasses\"] / filteredStats[\"attPasses\"]) * 100;\r\n            statsPer90[\"longPassSuccRate\"] = (filteredStats[\"succLongPasses\"] / filteredStats[\"attLongPasses\"]) * 100;\r\n            statsPer90[\"dribbleTackleRate\"] = (filteredStats[\"succDribbleTackles\"] / filteredStats[\"attDribbleTackles\"]) * 100;\r\n            statsPer90[\"succAerials\"] = filteredStats[\"succAerials\"] / minutesOverNinety;\r\n            statsPer90[\"aerialSuccRate\"] = (filteredStats[\"succAerials\"] / filteredStats[\"attAerials\"]) * 100;\r\n            statsPer90[\"succPressures\"] = filteredStats[\"succPressures\"] / minutesOverNinety;\r\n\r\n            if (padjTypes['offensive']){\r\n                statsPer90[\"padjPFT\"] = filteredStats[\"pft\"] / touchesOverHundred;\r\n                statsPer90[\"padjProgDistance\"] = filteredStats[\"progDistance\"] / touchesOverHundred;\r\n            }\r\n            else {\r\n                statsPer90[\"pft\"] = filteredStats[\"pft\"] / minutesOverNinety;\r\n                statsPer90[\"progDistance\"] = filteredStats[\"progDistance\"] / minutesOverNinety;\r\n            }\r\n\r\n            if (padjTypes['defensive']){\r\n                statsPer90[\"padjInterceptions\"] = filteredStats[\"padjInterceptions\"] / minutesOverNinety;\r\n                statsPer90[\"padjSuccTackles\"] = filteredStats[\"padjSuccTackles\"] / minutesOverNinety;\r\n                statsPer90[\"padjFouls\"] = filteredStats[\"padjFouls\"] / minutesOverNinety;\r\n                statsPer90[\"padjClearances\"] = filteredStats[\"padjClearances\"] / minutesOverNinety;\r\n            }\r\n            else {\r\n                statsPer90[\"interceptions\"] = filteredStats[\"interceptions\"] / minutesOverNinety;\r\n                statsPer90[\"succTackles\"] = filteredStats[\"succTackles\"] / minutesOverNinety;\r\n                statsPer90[\"fouls\"] = filteredStats[\"fouls\"] / minutesOverNinety;\r\n                statsPer90[\"clearances\"] = filteredStats[\"clearances\"] / minutesOverNinety;\r\n            }\r\n\r\n            break;\r\n\r\n        case \"GK\":\r\n\r\n            statsPer90[\"gsaa\"] = ((filteredStats[\"psxg\"] - filteredStats[\"goalsAgainst\"]) / filteredStats[\"sota\"]) * 100;\r\n            statsPer90[\"crossStopRate\"] = (filteredStats[\"stoppedCrosses\"] / filteredStats[\"attCrosses\"]) * 100;\r\n            statsPer90[\"launchedPassSuccRate\"] = (filteredStats[\"succLaunchedPasses\"] / filteredStats[\"attLaunchedPasses\"]) * 100;\r\n\r\n            break;\r\n\r\n        default:\r\n\r\n            statsPer90[\"npg\"] = 0;\r\n            statsPer90[\"npxg\"] = 0;\r\n            statsPer90[\"npxgPerShot\"] = 0;\r\n            statsPer90[\"conversionRate\"] = 0;\r\n            statsPer90[\"aerialSuccRate\"] = 0;\r\n            statsPer90[\"boxTouches\"] = 0;\r\n            statsPer90[\"xa\"] = 0;\r\n            statsPer90[\"ppa\"] = 0;\r\n            statsPer90[\"succDribbles\"] = 0;\r\n            statsPer90[\"dribbleSuccRate\"] = 0;\r\n            statsPer90[\"turnovers\"] = 0;\r\n            statsPer90[\"succPressures\"] = 0;\r\n\r\n    }\r\n\r\n    //calculate percentile ranks\r\n    if (template !== \"N/A\") {\r\n        for (let stat in statsPer90) {\r\n            if (isFinite(statsPer90[stat])) {\r\n                percentiles[stat] = calculatePercentileRank(percentileArrays[percentileSeason][template][stat], statsPer90[stat], percentileArrayOccurrences) * 100;\r\n            }\r\n            //handle cases where the per 90 value is NaN (e.g.: as a result of divide by 0 error)\r\n            else {\r\n                statsPer90[stat] = 0;\r\n                percentiles[stat] = 0;\r\n            }\r\n            //reverse percentile ranks for \"less is better\" stats\r\n            if (stat === \"padjFouls\" ||\r\n                stat === \"fouls\" ||\r\n                stat === \"turnovers\" ||\r\n                stat === \"padjTurnovers\"\r\n            ) {\r\n                percentiles[stat] = 100 - percentiles[stat];\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        for (let stat in statsPer90) {\r\n            percentiles[stat] = 0;\r\n        }\r\n    }\r\n\r\n    return {\r\n        statsPer90: statsPer90,\r\n        percentiles: percentiles\r\n    };\r\n\r\n}\r\n\r\n\r\n/**\r\n * Function to calculate the percentile rank of a given value within a given array\r\n * @param {Array} array - the array of values\r\n * @param {number} value - the value for which the percentile rank is being calculated\r\n * @param {number} occurrences - the number of occurrences of the player's numbers within the percentile array\r\n * @return {number} the percentile rank of the value in the array (adjusted for the double-counting problem)\r\n */\r\nfunction calculatePercentileRank(array, value, occurrences){\r\n\r\n    //taken from: https://gist.github.com/IceCreamYou/6ffa1b18c4c8f6aeaad2\r\n    if (!isFinite(value)){\r\n        value = 0;\r\n    }\r\n    for (let i = 0, length = array.length; i < length; i++) {\r\n        if (value < array[i]) {\r\n            while (i < length && value === array[i]) i++;\r\n            if (i === 0) return 0;\r\n            if (value !== array[i-1]) {\r\n                i += (value - array[i-1]) / (array[i] - array[i-1]);\r\n            }\r\n            //adjust the returned percentile by disregarding the entries that belong to the player\r\n            //return (i / length) - (occurrences/array.length);\r\n            return (i/length);\r\n        }\r\n    }\r\n    return 1;\r\n\r\n}\r\n\r\n\r\n/**\r\n * Function to construct the input given to the Highcharts component\r\n * @param statsByPosition\r\n * @param {Object} statsPer90 - object containing the per90 stats\r\n * @param {Object} percentiles - object containing the percentile ranks\r\n * @param playerCode\r\n * @param playerName\r\n * @param minutes\r\n * @param isForComparison\r\n * @param index\r\n * @return {Array} chartInput - array containing information for each data point in the Highcharts plot\r\n */\r\nexport function constructChartInput(statsByPosition, statsPer90, percentiles, playerCode, playerName, minutes, isForComparison, index){\r\n\r\n    let template = this.state.template;\r\n\r\n    let colors;\r\n    if (isForComparison) {\r\n        colors = colorArrays['comparison'];\r\n    }\r\n    else {\r\n        colors = colorArrays[template];\r\n    }\r\n\r\n    let verticalAlignments = alignments['vertical'][template === \"GK\" ? \"GK\" : \"other\"];\r\n    let horizontalAlignments = alignments['horizontal'][template === \"GK\" ? \"GK\" : \"other\"];\r\n\r\n    let isSecondPlayer = index === 1;\r\n\r\n    //remove unnecessary precision from the per90 labels and the percentile ranks\r\n    let p90_labels = truncate(statsPer90);\r\n    let percentile_labels = roundNumbers(percentiles, 0);\r\n\r\n    //iterate through per90 stats and percentile ranks and construct objects for each point on the Highcharts plot\r\n    let chartInput = [];\r\n\r\n    let i = 0;\r\n    for (let stat in statsByPosition[template]){\r\n\r\n        let key = statsByPosition[template][stat];\r\n\r\n        if (statsPer90[key] === undefined){\r\n            continue;\r\n        }\r\n\r\n        chartInput[i] = {\r\n            playerName: playerCode !== undefined ? playerName : null,\r\n            y: percentiles[key],\r\n            p90_label: p90_labels[key],\r\n            percentile_label: ordinalSuffix(percentile_labels[key]),\r\n            dataLabels: {\r\n                align: horizontalAlignments[i],\r\n                verticalAlign: verticalAlignments[i]\r\n            },\r\n            color: Highcharts.Color(colors[i]).setOpacity(index !== 1 ? (isForComparison ? 0.55 : 0.85) : 0).get(),\r\n            tooltipColor: index === 0 ? colors[i] : 'black',\r\n            borderColor: isSecondPlayer ? 'black' : null,\r\n            borderWidth: isSecondPlayer ? 6 : 0\r\n        };\r\n\r\n        i++;\r\n\r\n    }\r\n\r\n    return chartInput;\r\n\r\n}\r\n\r\n\r\n/**\r\n * Function to truncate all values in an object to 3 digits\r\n * @param {Object} someStats - object containing the values that need to be reduced to 3 digits\r\n * @return {Object} threeDigitStats - object containing value of someStats reduced to 3 digits\r\n */\r\nfunction truncate(someStats){\r\n\r\n    let threeDigitStats = {};\r\n\r\n    for (let stat in someStats){\r\n        let precision;\r\n        if (\r\n            stat === \"progDistance\" ||\r\n            stat === \"padjProgDistance\" ||\r\n            someStats[stat] === 0\r\n        ) {\r\n            precision = 0;\r\n        }\r\n        else if (\r\n            stat === \"conversionRate\" ||\r\n            stat === \"aerialSuccRate\" ||\r\n            stat === \"dribbleSuccRate\" ||\r\n            stat === \"passSuccRate\" ||\r\n            stat === \"dribbleTackleRate\" ||\r\n            stat === \"longPassSuccRate\" ||\r\n            stat === \"launchedPassSuccRate\"\r\n        ) {\r\n            precision = 1;\r\n        }\r\n        else if (\r\n            stat === \"npxgPerShot\"\r\n        ){\r\n            precision = 3;\r\n        }\r\n        else {\r\n            precision = 2;\r\n        }\r\n        threeDigitStats[stat] = parseFloat(Math.round(someStats[stat] * (10**precision)) / (10**precision)).toFixed(precision);\r\n    }\r\n    return threeDigitStats;\r\n\r\n}\r\n\r\n\r\n/**\r\n * Function to round all values in an object to a specified precision\r\n * @param {Object} someStats - object containing the values that need to be rounded\r\n * @param {number} precision - the number of decimal places each number should be rounded to\r\n * @return {Object}\r\n */\r\nfunction roundNumbers(someStats, precision){\r\n\r\n    let roundedStats = {};\r\n\r\n    for (let stat in someStats){\r\n        roundedStats[stat] = Math.round(someStats[stat] * (10**precision)) / (10**precision);\r\n    }\r\n\r\n    return roundedStats;\r\n\r\n}\r\n\r\n\r\n/**\r\n * Function to append an ordinal suffix (-st, -nd, -rd, -th) to numbers\r\n * @param {number} aNumber - the number to which the ordinal suffix is being appended\r\n * @return {string} - the number with the ordinal suffix appended to it\r\n */\r\nexport function ordinalSuffix(aNumber){\r\n\r\n    //taken from: https://stackoverflow.com/questions/13627308/add-st-nd-rd-and-th-ordinal-suffix-to-a-number\r\n    let j = aNumber % 10,\r\n        k = aNumber % 100;\r\n    if (j === 1 && k !== 11) {\r\n        return aNumber + \"st\";\r\n    }\r\n    if (j === 2 && k !== 12) {\r\n        return aNumber + \"nd\";\r\n    }\r\n    if (j === 3 && k !== 13) {\r\n        return aNumber + \"rd\";\r\n    }\r\n    return aNumber + \"th\";\r\n\r\n}\r\n\r\n\r\n/**\r\n * Function to reduce array of ages into string collapsing consecutive numbers\r\n * E.g.: [23, 24, 25, 27] => [\"23-25\", \"27\"]\r\n * @param ageArray -\r\n * @return {string}\r\n */\r\nexport function ageRangesString(ageArray){\r\n\r\n    //adapted from: https://stackoverflow.com/questions/2270910/how-to-reduce-consecutive-integers-in-an-array-to-hyphenated-range-expressions\r\n\r\n    if (ageArray === undefined){\r\n        return \"\";\r\n    }\r\n\r\n    let ranges = [], rstart, rend;\r\n    for (let i = 0; i < ageArray.length; i++) {\r\n        rstart = ageArray[i];\r\n        rend = rstart;\r\n        while (ageArray[i + 1] - ageArray[i] === 1) {\r\n            rend = ageArray[i + 1];\r\n            i++;\r\n        }\r\n        ranges.push(rstart === rend ? rstart+'' : rstart + '-' + rend);\r\n    }\r\n    return ranges.join(\", \");\r\n\r\n}\r\n\r\n\r\n/**\r\n * Function to change the selected template\r\n * @param {Object} event - the input event from the template form\r\n */\r\nexport function changeTemplate(event){\r\n\r\n    let { codes, stats, template, competitions, selectedCompetitions } = this.state;\r\n    let newTemplate = event.target.value;\r\n\r\n    //check if the function was called from a comparison page\r\n    if (codes !== undefined) {\r\n\r\n        for (let i=0; i<codes.length; i++){\r\n\r\n            let code = codes[i];\r\n\r\n            if (this.state.isOutfieldGK[code]){\r\n\r\n                if (template !== \"GK\" && newTemplate === \"GK\"){\r\n                    let outfieldGKStats = this.state.outfieldGKStats[code];\r\n                    stats[code] = outfieldGKStats;\r\n                }\r\n                else if (template === \"GK\" && newTemplate !== \"GK\"){\r\n                    let standardStats = this.state.standardStats[code];\r\n                    stats[code] = standardStats;\r\n                }\r\n\r\n                competitions[code] = {};\r\n                for (let season in stats[code]){\r\n                    competitions[code][season] = [];\r\n                    for (let competition in stats[code][season]){\r\n                        competitions[code][season].push(competition);\r\n                    }\r\n                }\r\n\r\n                selectedCompetitions = JSON.parse(JSON.stringify(competitions));\r\n\r\n            }\r\n\r\n        }\r\n\r\n    }\r\n    //handle case where function is called from stats page\r\n    else {\r\n\r\n        if (this.state.isOutfieldGK) {\r\n\r\n            if (template !== \"GK\" && newTemplate === \"GK\"){\r\n                let outfieldGKStats = this.state.outfieldGKStats;\r\n                stats = outfieldGKStats;\r\n            }\r\n            else if (template === \"GK\" && newTemplate !== \"GK\"){\r\n                let standardStats = this.state.standardStats;\r\n                stats = standardStats;\r\n            }\r\n\r\n            competitions = {};\r\n            for (let season in stats){\r\n                competitions[season] = [];\r\n                for (let competition in stats[season]){\r\n                    competitions[season].push(competition);\r\n                }\r\n            }\r\n\r\n            selectedCompetitions = JSON.parse(JSON.stringify(competitions));\r\n\r\n        }\r\n\r\n    }\r\n\r\n    this.setState({\r\n        stats: stats,\r\n        template: newTemplate,\r\n        competitions: competitions,\r\n        selectedCompetitions: selectedCompetitions,\r\n        isAnimated: true\r\n    });\r\n\r\n}\r\n\r\n\r\n/**\r\n * Function to change the list of selected competitions\r\n * @param {Object} event - the input event from the competitions form\r\n */\r\nexport function changeSelectedCompetitions(event){\r\n\r\n    let clickedValues = event.target.value.split(\"_\");\r\n    let selectedCompetitions = this.state.selectedCompetitions;\r\n\r\n    //retrieve the information of the clicked checkbox\r\n    let code;\r\n    let entry;\r\n    let clickedSeason;\r\n    let clickedCompetition;\r\n    let isLastCompetition = false;\r\n\r\n    //retrieve the season and competition from the clicked checkbox\r\n    clickedSeason = clickedValues[0];\r\n    clickedCompetition = clickedValues[1];\r\n\r\n    //check if the function was called from a 'compare' page, where the checkbox values include an extra value\r\n    let forComparison = clickedValues.length > 2;\r\n\r\n    //if so, retrieve the player code from the clicked checkbox\r\n    if (forComparison) {\r\n        code = clickedValues[2];\r\n        entry = selectedCompetitions[code][clickedSeason];\r\n        //determine if the click competition is the last checked competition\r\n        let counter = 0;\r\n        for (let season in selectedCompetitions[code]) {\r\n            counter += selectedCompetitions[code][season].length;\r\n        }\r\n        isLastCompetition = counter === 1;\r\n    }\r\n    else {\r\n        entry = selectedCompetitions[clickedSeason];\r\n    }\r\n\r\n    //remove the clicked competition from selected competitions if it is already included\r\n    //don't remove a clicked competition if it is the last checked competition of a player on a compare page\r\n    if (entry.includes(clickedCompetition) && !isLastCompetition){\r\n        entry.splice(entry.indexOf(clickedCompetition), 1);\r\n    }\r\n    //add it otherwise\r\n    else {\r\n        if (!entry.includes(clickedCompetition)){\r\n            entry.push(clickedCompetition);\r\n        }\r\n    }\r\n\r\n    this.setState({\r\n        selectedCompetitions: selectedCompetitions,\r\n        isAnimated: true\r\n    });\r\n\r\n}\r\n\r\n\r\n/**\r\n * Function to change the selected values for possession adjustment\r\n * @param {Object} event - the input event from the possession adjustment form\r\n */\r\nexport function changePAdjTypes(event){\r\n\r\n    let clickedType = event.target.value;\r\n\r\n    let pAdjTypes = this.state.pAdjTypes;\r\n    pAdjTypes[clickedType] = !pAdjTypes[clickedType];\r\n\r\n    this.setState({\r\n        pAdjTypes: pAdjTypes,\r\n        isAnimated: true\r\n    });\r\n\r\n    cookies.set('padjTypes', pAdjTypes, {path: '/'});\r\n\r\n}\r\n\r\n\r\n/**\r\n * Function to change the type of data labels\r\n * @param {Object} event - the input event from the data labels form\r\n */\r\nexport function changeLabelType(event){\r\n\r\n    let labelType = event.target.value;\r\n\r\n    this.setState({\r\n        labelType: labelType,\r\n        isAnimated: false\r\n    });\r\n\r\n    cookies.set('labelType', labelType, {path: '/'});\r\n\r\n}\r\n\r\n\r\n/**\r\n * Function to change the position of the credits at the bottom of the Slice container\r\n */\r\nexport function toggleCreditsPosition(){\r\n\r\n    let oldPosition = this.state.creditsPosition;\r\n    let newPosition = oldPosition === \"right\" ? \"center\" : \"right\";\r\n\r\n    this.setState({\r\n        isAnimated: false,\r\n        creditsPosition: newPosition\r\n    });\r\n\r\n    cookies.set('creditsPosition', newPosition, {path: '/'});\r\n\r\n}\r\n\r\n\r\n/**\r\n * Function to export the chart in a standardized 2400 * 2200 downloadable PNG format\r\n * Triggers the page to temporarily load a second slice to the \"#export\" div, which has fixed height and width\r\n * Passes the second slice to the \"dom-to-image\" package, which converts it to an image (with 4x scaling)\r\n * Adds the FootballSlices watermark to the exported image\r\n * @return {Promise<void>}\r\n */\r\nexport async function exportChart(){\r\n\r\n    //render the second slice and then export it.\r\n    //callback executes after the page has re-rendered with the second slice\r\n    this.setState({\r\n        showExportLoaderOverlay: true,\r\n        renderForExport: true\r\n    }, () => {\r\n\r\n        let name = this.state.name;\r\n        if (name === undefined) {\r\n            name = Object.values(this.state.names).join(\"-vs-\");\r\n        }\r\n\r\n        $('<img/>').attr('src', '../exportBackground.png').on('load', () => {\r\n\r\n            setTimeout(() => {\r\n\r\n                const node = document.getElementById('export');\r\n\r\n                if (this.firstExport){\r\n\r\n                    this.firstExport = false;\r\n\r\n                    domtoimage.toPng(node, {\r\n                        bgcolor: '#fafbfc',\r\n                        width: 1200,\r\n                        height: 1100,\r\n                        style: {\r\n                            //make the export div visible\r\n                            'opacity': '1',\r\n                            'transform': 'scale(1)',\r\n                        }\r\n                    })\r\n                        .then(async (blob) => {\r\n                        })\r\n                        .catch(function (error) {\r\n                            console.log(error);\r\n                            alert(\"An error occurred while exporting. Please refresh the page and try again.\")\r\n                        });\r\n\r\n                }\r\n\r\n                domtoimage.toPng(node, {\r\n                    bgcolor: '#fafbfc',\r\n                    width: 1200,\r\n                    height: 1100,\r\n                    style: {\r\n                        //make the export div visible\r\n                        'opacity': '1',\r\n                        'transform': 'scale(1)',\r\n                    }\r\n                })\r\n                    .then(async (blob) => {\r\n                        //download the image and revert 'renderForExport' to false so the second slice doesn't continue being updated\r\n                        saveAs(blob, `${name.replace(\" \", \"-\")}.png`);\r\n                        setTimeout(() => {\r\n                            this.setState({\r\n                                showExportLoaderOverlay: false,\r\n                                renderForExport: false\r\n                            })\r\n                        }, 500);\r\n                    })\r\n                    .catch(function (error) {\r\n                        console.log(error);\r\n                        alert(\"An error occurred while exporting. Please refresh the page and try again.\")\r\n                    });\r\n\r\n            }, 1000);\r\n\r\n            $(this).remove();\r\n\r\n        });\r\n\r\n    });\r\n\r\n}\r\n\r\n\r\n/**\r\n * Function to the show an overlay containing a glossary/explanation\r\n */\r\nexport function toggleGlossaryOverlay(){\r\n\r\n    let currentState = this.state.showGlossaryOverlay;\r\n\r\n    this.setState({\r\n        showGlossaryOverlay: !currentState\r\n    });\r\n\r\n}\r\n\r\n\r\n/**\r\n * Function to the show the search dialog for the comparison functionality\r\n */\r\nexport function toggleCompareSearchOverlay(){\r\n\r\n    let currentState = this.state.showCompareSearchOverlay;\r\n\r\n    this.setState({\r\n        showCompareSearchOverlay: !currentState\r\n    });\r\n\r\n    if (!this.isMobile){\r\n        $(\"#compare-search-overlay #searchbar-input\").focus()\r\n    }\r\n\r\n}\r\n\r\n","import React, {Component} from 'react';\r\nimport Collapsible from 'react-collapsible';\r\n\r\n/**\r\n * Component to render the options for the displayed slice\r\n */\r\nclass SliceOptions extends Component {\r\n\r\n    constructor(props) {\r\n\r\n        super(props);\r\n\r\n        this.isMobile = this.props.isMobile;\r\n        this.isForComparison = this.props.isForComparison;\r\n        this.templateOpen = this.props.template === \"N/A\";\r\n        this.codes = this.props.codes;\r\n        this.names = this.props.names;\r\n        this.clubs = this.props.clubs;\r\n\r\n        this.positions = {};\r\n        if (this.isMobile){\r\n            this.positions = {\r\n                \"FW\": \"FW\",\r\n                \"AM\": \"AM\",\r\n                \"CM\": \"CM / DM\",\r\n                \"FB\": \"FB\",\r\n                \"CB\": \"CB\",\r\n                \"GK\": \"GK\"\r\n            };\r\n        }\r\n        else {\r\n            this.positions = {\r\n                \"FW\": \"Forward\",\r\n                \"AM\": \"Attacking Midfielder / Winger\",\r\n                \"CM\": \"Central / Defensive Midfielder\",\r\n                \"FB\": \"Full-back\",\r\n                \"CB\": \"Center-back\",\r\n                \"GK\": \"Goalkeeper\"\r\n            };\r\n        }\r\n\r\n        this.labelTypes = {\r\n            \"raw\": \"Raw Values\",\r\n            \"percentiles\": \"Percentile Ranks\"\r\n        };\r\n\r\n        this.pAdjTypes = {\r\n            offensive: \"Offensive\",\r\n            defensive: \"Defensive\"\r\n        };\r\n\r\n        this.state = {\r\n        };\r\n\r\n    }\r\n\r\n    constructCompetitionLabels = (forComparison, code) => {\r\n\r\n        let competitions = forComparison ? this.props.competitions[code] : this.props.competitions;\r\n        let clubs = forComparison ? this.clubs[code] : this.clubs;\r\n        let selectedCompetitions = forComparison ? this.props.selectedCompetitions[code] : this.props.selectedCompetitions;\r\n\r\n        let competitionsForms = [];\r\n        let counter = 0;\r\n        for (let season in competitions){\r\n            let competitionLabels = [];\r\n            let multipleClubs = clubs[season].length !== 1;\r\n            competitionsForms.push(\r\n                <h4\r\n                    key={`${season}_header`}\r\n                    style={{\r\n                        marginBottom: this.isMobile ? '20px' : '10px',\r\n                        marginTop: (counter === 0) ? (this.isMobile ? '15px' : '10px') : (this.isMobile ? '20px' : '12px')\r\n                    }}\r\n                >\r\n                    {season.replace(\"-\", \"/\")} {multipleClubs === false ? ' | ' + clubs[season][0] : null}\r\n                </h4>\r\n            );\r\n            for (let i=0; i<competitions[season].length; i++){\r\n                let currentCompetition = competitions[season][i];\r\n                let isIncluded = selectedCompetitions[season].includes(currentCompetition);\r\n                let label = currentCompetition;\r\n                if (clubs[season].length === 1){\r\n                    label = label.substring(0, label.indexOf(\"|\")-1)\r\n                }\r\n                competitionLabels.push(\r\n                    <label\r\n                        className={`${isIncluded ? \"selected-label\" : null} selectable-label`}\r\n                        key={forComparison ? `${season}_${currentCompetition}_${code}` : `${season}_${currentCompetition}`}\r\n                    >\r\n                        <input className=\"competition\"\r\n                               type=\"checkbox\"\r\n                               value={forComparison ? `${season}_${currentCompetition}_${code}` : `${season}_${currentCompetition}`}\r\n                               onChange={this.props.changeSelectedCompetitions}\r\n                               checked={isIncluded}\r\n                        /> {label}\r\n                    </label>\r\n                )\r\n            }\r\n            competitionsForms.push(<form key={forComparison ? `${code}_${season}_form` : `${season}_form`} className=\"competitions\">{competitionLabels}</form>);\r\n            counter++;\r\n        }\r\n\r\n        return competitionsForms;\r\n\r\n    };\r\n\r\n    /**\r\n     * render function\r\n     * @return {*} - JSX code for the slice options\r\n     */\r\n    render() {\r\n\r\n        let template = this.props.template;\r\n        let labelType = this.props.labelType;\r\n        let pAdjTypes = this.props.pAdjTypes;\r\n\r\n        let isGK = this.props.isGK;\r\n        let isOutfieldGK = this.props.isOutfieldGK;\r\n\r\n        //construct templates form\r\n        let templateLabels = [];\r\n        let mobileTemplateLabels = [];\r\n\r\n        for (let position in this.positions){\r\n            let className;\r\n            let mobileClassName;\r\n            let disabled = false;\r\n            if (position === \"GK\"){\r\n                disabled = !isGK && !isOutfieldGK;\r\n            }\r\n            else {\r\n                disabled = isGK;\r\n            }\r\n            className = disabled ? \"blocked-label\" : \"selectable-label\";\r\n            mobileClassName = `${template === position ? \"selected-label\" : null} ${disabled ? null : \"selectable-label\"}`;\r\n            templateLabels.push(\r\n                <label\r\n                    className={className}\r\n                    key={`${position}_label`}\r\n                >\r\n                    <input type=\"radio\"\r\n                        name=\"template\"\r\n                        value={position}\r\n                        checked={template === position}\r\n                        disabled={disabled}\r\n                        onChange={this.props.changeTemplate}\r\n                    /> {this.positions[position]}\r\n                </label>\r\n            );\r\n            mobileTemplateLabels.push(\r\n                <label\r\n                    className={mobileClassName}\r\n                    key={`${position}_label_mobile`}\r\n                >\r\n                    <input type=\"radio\"\r\n                        name=\"template\"\r\n                        value={position}\r\n                        checked={template === position}\r\n                        disabled={disabled}\r\n                        onChange={this.props.changeTemplate}\r\n                    /> {this.positions[position]}\r\n                </label>\r\n            );\r\n        }\r\n\r\n        let templatesForm =\r\n            <Collapsible\r\n                open={this.templateOpen}\r\n                trigger=\"Template\"\r\n                className=\"filter-headers\"\r\n                transitionTime={200}\r\n                transitionCloseTime={200}\r\n            >\r\n                <form id=\"templates\">{templateLabels}</form>\r\n            </Collapsible>;\r\n\r\n        let mobileTemplatesForm =\r\n            <Collapsible\r\n                open={false}\r\n                trigger=\"Template\"\r\n                className=\"filter-headers\"\r\n                transitionTime={200}\r\n                transitionCloseTime={200}\r\n            >\r\n                <form id=\"templates\">{mobileTemplateLabels}</form>\r\n            </Collapsible>;\r\n\r\n        //construct competitions form(s)\r\n        let competitionsForms = [];\r\n\r\n        if (this.isForComparison){\r\n\r\n            let playerCompetitions = {};\r\n\r\n            for (let i=0; i<this.codes.length; i++){\r\n\r\n                let code = this.codes[i];\r\n                playerCompetitions[code] = this.constructCompetitionLabels(true, code);\r\n\r\n                competitionsForms.push(\r\n                    <Collapsible\r\n                        key={`Competitions ${code})`}\r\n                        open={!this.templateOpen && !this.isMobile}\r\n                        trigger={`Competitions | ${this.names[this.codes[i]]}`}\r\n                        className=\"filter-headers\"\r\n                        transitionTime={200}\r\n                        transitionCloseTime={200}\r\n                    >\r\n                        {playerCompetitions[code]}\r\n                    </Collapsible>\r\n                )\r\n\r\n            }\r\n\r\n        }\r\n        else {\r\n            let playerCompetitions = this.constructCompetitionLabels(false);\r\n            competitionsForms.push(\r\n                <Collapsible\r\n                    key={\"_\"}\r\n                    open={!this.templateOpen && !this.isMobile}\r\n                    trigger={`Competitions`}\r\n                    className=\"filter-headers\"\r\n                    transitionTime={200}\r\n                    transitionCloseTime={200}\r\n                >\r\n                    {playerCompetitions}\r\n                </Collapsible>\r\n            )\r\n        }\r\n\r\n        //construct label type form\r\n        let labelTypeForm = null;\r\n\r\n        if (!this.isForComparison){\r\n            let labelTypeLabels = [];\r\n\r\n            for (let type in this.labelTypes){\r\n                labelTypeLabels.push(\r\n                    <label\r\n                        className={`selectable-label ${labelType === type ? \"selected-label\" : null}`}\r\n                        key={type}\r\n                    >\r\n                        <input\r\n                            type=\"radio\"\r\n                            name=\"labelType\"\r\n                            value={type}\r\n                            checked={labelType === type}\r\n                            onChange={this.props.changeLabelType}\r\n                        /> {this.labelTypes[type]}\r\n                    </label>\r\n                )\r\n            }\r\n\r\n            labelTypeForm =\r\n                <Collapsible\r\n                    open={false}\r\n                    trigger=\"Data Labels\"\r\n                    className=\"filter-headers\"\r\n                    transitionTime={200}\r\n                    transitionCloseTime={200}\r\n                >\r\n                    <form id=\"data-labels\">{labelTypeLabels}</form>\r\n                </Collapsible>;\r\n        }\r\n\r\n\r\n        //construct possession adjustment form\r\n        let pAdjTypeLabels = [];\r\n\r\n        for (let type in this.pAdjTypes){\r\n            pAdjTypeLabels.push(\r\n                <label\r\n                    className={`selectable-label ${pAdjTypes[type] === true ? \"selected-label\" : null}`}\r\n                    key={type}\r\n                >\r\n                    <input\r\n                        type=\"checkbox\"\r\n                        name=\"pAdjLabelType\"\r\n                        value={type}\r\n                        checked={pAdjTypes[type] === true}\r\n                        onChange={this.props.changePAdjTypes}\r\n                    /> {this.pAdjTypes[type]}\r\n                </label>\r\n            )\r\n        }\r\n\r\n        let pAdjTypeForm =\r\n            <Collapsible\r\n                open={false}\r\n                trigger=\"Possession Adjustment\"\r\n                className=\"filter-headers\"\r\n                transitionTime={200}\r\n                transitionCloseTime={200}\r\n            >\r\n                <form id=\"templates\">{pAdjTypeLabels}</form>\r\n            </Collapsible>;\r\n\r\n\r\n        return (\r\n            <div className=\"filter\" id=\"chart-filters\">\r\n                <div className=\"filter-inputs chart-filter-inputs\" id=\"chart-filter-inputs-laptop\">\r\n                    {templatesForm}\r\n                    {competitionsForms}\r\n                    {pAdjTypeForm}\r\n                    {labelTypeForm}\r\n                </div>\r\n                <div className=\"filter-inputs chart-filter-inputs\" id=\"chart-filter-inputs-mobile\">\r\n                    {mobileTemplatesForm}\r\n                    {competitionsForms}\r\n                    {pAdjTypeForm}\r\n                    {labelTypeForm}\r\n                </div>\r\n                <div className=\"filter-buttons\" id=\"chart-filter-buttons\">\r\n                    <div className=\"filter-button\">\r\n                        <button id=\"toggleCreditsButton\" type=\"button\" onClick={this.props.toggleCreditsPosition}>Toggle Credits Position</button>\r\n                    </div>\r\n                    <div className=\"filter-button\">\r\n                        <button id=\"compareButton\" type=\"button\" onClick={this.props.toggleCompareSearchOverlay}>Compare</button>\r\n                    </div>\r\n                    <div className=\"filter-button\">\r\n                        <button id=\"exportButton\" type=\"button\" onClick={this.props.exportChart}>Export Chart</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        )\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default (SliceOptions);\r\n","import React, {Component} from 'react';\r\n\r\n//import dependencies\r\nimport Highcharts from 'highcharts/highstock'\r\nimport HighchartsReact from 'highcharts-react-official'\r\nimport HighchartsMore from 'highcharts/highcharts-more'\r\nimport NoDataToDisplay from 'highcharts/modules/no-data-to-display';\r\n\r\nHighchartsMore(Highcharts);\r\nNoDataToDisplay(Highcharts);\r\n\r\n/**\r\n * Component to render Slices (charts)\r\n */\r\nclass Slice extends Component {\r\n\r\n    constructor(props) {\r\n\r\n        super(props);\r\n\r\n        this.isMobile = this.props.isMobile;\r\n        this.isForExport = this.props.isForExport;\r\n        this.isForComparison = this.props.isForComparison;\r\n\r\n        //set font size constants\r\n        this.fontSizes = undefined;\r\n        if (this.isForExport){\r\n            this.fontSizes =  {\r\n                title: this.isMobile ? '4.6vw' : '2.3em',\r\n                subtitle: '2em',\r\n                noData: '1.76em',\r\n                xAxisLabels: '1.8em',\r\n                dataLabels: '1.95em',\r\n                dataLabelsOutline: '0.13em',\r\n                tooltipHeader: '0em',\r\n                tooltip: '0em',\r\n                legend: '2.3em',\r\n                credits: '1.5em',\r\n                yAxisLabels: '0.65em'\r\n            };\r\n        }\r\n        else {\r\n            if (this.isMobile) {\r\n                this.fontSizes =  {\r\n                    title: '4vw',\r\n                    subtitle: '2.6vw',\r\n                    noData: '2.7vw',\r\n                    xAxisLabels: '2.15vw',\r\n                    dataLabels: '2.3vw',\r\n                    dataLabelsOutline: '0.3vw',\r\n                    tooltipHeader: '2.3vw',\r\n                    tooltip: '2.3vw',\r\n                    legend: '2.8vw',\r\n                    legendTitle: '2vw',\r\n                    credits: '2.3vw',\r\n                    yAxisLabels: '1vw'\r\n                };\r\n            }\r\n            else {\r\n                this.fontSizes =  {\r\n                    title: '1.7em',\r\n                    subtitle: '1.4em',\r\n                    noData: '1.35em',\r\n                    xAxisLabels: '1.15em',\r\n                    dataLabels: '1.15em',\r\n                    dataLabelsOutline: '0.21em',\r\n                    tooltipHeader: '1.05em',\r\n                    tooltip: '0.95em',\r\n                    legend: '1.4em',\r\n                    legendTitle: '1em',\r\n                    credits: '1.2em',\r\n                    yAxisLabels: '0.5em'\r\n                };\r\n            }\r\n        }\r\n\r\n        //set categories (x-axis labels) constants\r\n        if (this.isMobile && !this.isForExport){\r\n            this.categories = {\r\n                \"FW\": [\r\n                    'Non-Penalty Goals',\r\n                    'Non-Penalty xG',\r\n                    'Non-Penalty xG/Shot',\r\n                    'Aerials Won',\r\n                    'Aerial Win %',\r\n                    'Touches in Box',\r\n                    'xA',\r\n                    'Passes into Box',\r\n                    'Successful Dribbles',\r\n                    'Dribble Success %',\r\n                    'Turnovers',\r\n                    'Successful Pressures',\r\n                ],\r\n                \"AM\": [\r\n                    'Non-Penalty Goals',\r\n                    'Non-Penalty xG',\r\n                    'Non-Penalty xG/Shot',\r\n                    'xA',\r\n                    'OP Shot-Creating Actions',\r\n                    'Passes into Box',\r\n                    'Yards Progressed',\r\n                    'Pass Comp. %',\r\n                    'Successful Dribbles',\r\n                    'Dribble Success %',\r\n                    'Turnovers',\r\n                    'Successful Pressures',\r\n                ],\r\n                \"CM\": [\r\n                    'xA',\r\n                    'OP Shot-Creating Actions',\r\n                    'Passes into Final 1/3',\r\n                    'Yards Prog-ressed',\r\n                    'Pass Comp. %',\r\n                    'Successful Dribbles',\r\n                    'Dribble Success %',\r\n                    'Turnovers',\r\n                    'Successful Pressures',\r\n                    'Inter-ceptions',\r\n                    'Successful Tackles',\r\n                    'Tackle/ Dribbled Past %'\r\n                ],\r\n                \"FB\": [\r\n                    'xA',\r\n                    'Passes into Final 1/3',\r\n                    'Yards Progressed',\r\n                    'Pass Comp. %',\r\n                    'Successful Dribbles',\r\n                    'Dribble Success %',\r\n                    'Turnovers',\r\n                    'Successful Pressures',\r\n                    'Interceptions',\r\n                    'Succ. Tackles',\r\n                    'Tackle/ Dribbled Past %',\r\n                    'Aerial Win %'\r\n                ],\r\n                \"CB\": [\r\n                    'Passes into Final 1/3',\r\n                    'Yards Progressed',\r\n                    'Pass Comp. %',\r\n                    'Long Pass Comp. %',\r\n                    'Succ. Pressures',\r\n                    'Interceptions',\r\n                    'Successful Tackles',\r\n                    'Tackle/ Dribbled Past %',\r\n                    'Fouls Committed',\r\n                    'Aerials Won',\r\n                    'Aerial Win %',\r\n                    'Clearances'\r\n                ],\r\n                \"GK\": [\r\n                    \"GSAA %\",\r\n                    \"Cross Stopping %\",\r\n                    \"Launched Pass Comp. %\"\r\n                ],\r\n                \"N/A\": [\r\n                    \"-\",\r\n                    \"-\",\r\n                    \"-\",\r\n                    \"-\",\r\n                    \"-\",\r\n                    \"-\",\r\n                    \"-\",\r\n                    \"-\",\r\n                    \"-\",\r\n                    \"-\",\r\n                    \"-\",\r\n                    \"-\"\r\n                ]\r\n            };\r\n        }\r\n        else {\r\n            this.categories = {\r\n                \"FW\": [\r\n                    'Non-Penalty Goals',\r\n                    'Non-Penalty xG',\r\n                    'Non-Penalty xG/Shot',\r\n                    'Aerials Won',\r\n                    'Aerial Win %',\r\n                    'Touches in Box',\r\n                    'xA',\r\n                    'Passes into Box',\r\n                    'Successful Dribbles',\r\n                    'Dribble Success %',\r\n                    'Turnovers',\r\n                    'Successful Pressures',\r\n                ],\r\n                \"AM\": [\r\n                    'Non-Penalty Goals',\r\n                    'Non-Penalty xG',\r\n                    'Non-Penalty xG/Shot',\r\n                    'xA',\r\n                    'OP Shot-Creating Actions',\r\n                    'Passes into Box',\r\n                    'Yards Progressed',\r\n                    'Pass Completion %',\r\n                    'Successful Dribbles',\r\n                    'Dribble Success %',\r\n                    'Turnovers',\r\n                    'Successful Pressures',\r\n                ],\r\n                \"CM\": [\r\n                    'xA',\r\n                    'OP Shot-Creating Actions',\r\n                    'Passes into Final 1/3',\r\n                    'Yards Progressed',\r\n                    'Pass Completion %',\r\n                    'Successful Dribbles',\r\n                    'Dribble Success %',\r\n                    'Turnovers',\r\n                    'Successful Pressures',\r\n                    'Interceptions',\r\n                    'Successful Tackles',\r\n                    'Tackle/Dribbled Past %'\r\n                ],\r\n                \"FB\": [\r\n                    'xA',\r\n                    'Passes into Final 1/3',\r\n                    'Yards Progressed',\r\n                    'Pass Completion %',\r\n                    'Successful Dribbles',\r\n                    'Dribble Success %',\r\n                    'Turnovers',\r\n                    'Successful Pressures',\r\n                    'Interceptions',\r\n                    'Successful Tackles',\r\n                    'Tackle/Dribbled Past %',\r\n                    'Aerial Win %'\r\n                ],\r\n                \"CB\": [\r\n                    'Passes into Final 1/3',\r\n                    'Yards Progressed',\r\n                    'Pass Completion %',\r\n                    'Long Pass Completion %',\r\n                    'Successful Pressures',\r\n                    'Interceptions',\r\n                    'Successful Tackles',\r\n                    'Tackle/Dribbled Past %',\r\n                    'Fouls Committed',\r\n                    'Aerials Won',\r\n                    'Aerial Win %',\r\n                    'Clearances'\r\n                ],\r\n                \"GK\": [\r\n                    \"GSAA %\",\r\n                    \"Cross Stopping %\",\r\n                    \"Launched Pass Completion %\"\r\n                ],\r\n                \"N/A\": [\r\n                    \"-\",\r\n                    \"-\",\r\n                    \"-\",\r\n                    \"-\",\r\n                    \"-\",\r\n                    \"-\",\r\n                    \"-\",\r\n                    \"-\",\r\n                    \"-\",\r\n                    \"-\",\r\n                    \"-\",\r\n                    \"-\"\r\n                ]\r\n            };\r\n        }\r\n\r\n        this.statTypes = {\r\n            offensiveVariable: [\r\n                'Touches in Box',\r\n                'xA',\r\n                'Passes into Box',\r\n                'Successful Dribbles',\r\n                'Turnovers',\r\n                'OP Shot-Creating Actions',\r\n                'Passes into Final 1/3',\r\n                'Yards Progressed',\r\n                'Yards Prog-ressed'\r\n            ],\r\n            defensiveVariable: [\r\n                'Interceptions',\r\n                'Inter-ceptions',\r\n                'Successful Tackles',\r\n                'Succ. Tackles',\r\n                'Fouls Committed',\r\n                'Clearances'\r\n            ],\r\n            constant: [\r\n                'Non-Penalty Goals',\r\n                'Non-Penalty xG',\r\n                'Successful Pressures',\r\n                'Aerials Won'\r\n            ]\r\n        };\r\n\r\n        this.competitionDict = {\r\n            \"Premier League\": \"ENG\",\r\n            \"La Liga\": \"ESP\",\r\n            \"Serie A\": \"ITA\",\r\n            \"Bundesliga\": \"GER\",\r\n            \"Ligue 1\": \"FRA\",\r\n            \"Champions League\": \"UCL\",\r\n            \"Europa League\": \"UEL\"\r\n        };\r\n\r\n        //set subtitle constants\r\n        this.subtitles = {\r\n            \"FW\": \"Percentile Ranks vs Top-5 League <b>Forwards</b>\",\r\n            \"AM\": \"Percentile Ranks vs Top-5 League <b>Attacking Midfielders / Wingers</b>\",\r\n            \"CM\": \"Percentile Ranks vs Top-5 League <b>Central / Defensive Midfielders</b>\",\r\n            \"FB\": \"Percentile Ranks vs Top-5 League <b>Full-backs</b>\",\r\n            \"CB\": \"Percentile Ranks vs Top-5 League <b>Center-backs</b>\",\r\n            \"GK\": \"Percentile Ranks vs Top-5 League <b>Goalkeepers</b>\"\r\n        };\r\n\r\n        //add a link to the credits if the chart is not for export\r\n        let chartEvents;\r\n        if (!this.isForExport){\r\n            chartEvents = {\r\n                load: function() {\r\n                    this.credits.element.onclick = function() {\r\n                        window.open('https://fbref.com', '_blank');\r\n                    };\r\n                },\r\n            };\r\n        }\r\n\r\n        //set x-axis label distance\r\n        let xAxisLabelDistance;\r\n        if (this.isForExport){\r\n            xAxisLabelDistance = 70;\r\n        }\r\n        else {\r\n            xAxisLabelDistance = this.isMobile ? 60 : 40;\r\n        }\r\n\r\n        //define the tooltip positioner for shared tooltips (used for comparisons)\r\n        let tooltipPositioner = undefined;\r\n\r\n        if (this.isForComparison) {\r\n\r\n            if (this.isMobile){\r\n                tooltipPositioner = (labelWidth, labelHeight, point) => {\r\n                    return {x: 6, y: document.body.scrollHeight - labelHeight - 23};\r\n                }\r\n            }\r\n            else {\r\n                tooltipPositioner = function (labelWidth, labelHeight, point) {\r\n                    let xPos = point.plotX;\r\n                    let yPos = point.plotY;\r\n                    return {x: xPos, y: yPos - 15};\r\n                }\r\n            }\r\n\r\n\r\n        }\r\n\r\n        //define the text for the credits\r\n        let creditsText = this.isForExport ? \"\" : \"Data Sources: FBref.com | StatsBomb<br/>\";\r\n        creditsText += `Last Updated: ${this.props.lastUpdated} UTC`;\r\n\r\n        //Highcharts chart options\r\n        //variable options are initialized to undefined, and then modified on render using props\r\n        //consult the Highcharts API reference for detailed explanations of each option\r\n        //https://api.highcharts.com/highcharts/\r\n        this.chartOptions = {\r\n            title: {\r\n                useHTML: true,\r\n                text: undefined,\r\n                style: {\r\n                    fontSize: this.fontSizes['title'],\r\n                    fontWeight: 'bold',\r\n                },\r\n                margin: 35\r\n            },\r\n            subtitle: {\r\n                text: undefined,\r\n                style: {\r\n                    color: 'black',\r\n                    fontSize: this.fontSizes['subtitle'],\r\n                }\r\n            },\r\n            pane: {\r\n                startAngle: undefined\r\n            },\r\n            chart: {\r\n                backgroundColor: 'rgba(0, 0, 0, 0)',\r\n                style: {\r\n                    fontFamily: 'sans-serif'\r\n                },\r\n                animation: undefined,\r\n                polar: true,\r\n                type: 'column',\r\n                marginLeft: 90,\r\n                marginRight: 90,\r\n                marginTop: undefined,\r\n                marginBottom: undefined,\r\n                events: chartEvents,\r\n                zoomType: 'x',\r\n                panning: true,\r\n                panKey: 'shift'\r\n            },\r\n            xAxis: {\r\n                categories: undefined,\r\n                labels: {\r\n                    zIndex: 0,\r\n                    distance: xAxisLabelDistance,\r\n                    style: {\r\n                        color: 'black',\r\n                        fontSize: this.fontSizes['xAxisLabels'],\r\n                    },\r\n                    padding: 31\r\n                },\r\n                gridLineWidth: 2,\r\n                gridLineColor: '#777777',\r\n                gridZIndex: 2\r\n            },\r\n            yAxis: {\r\n                visible: undefined,\r\n                labels: {\r\n                    enabled: false,\r\n                    // style: {\r\n                    //     color: '#444444',\r\n                    //     fontSize: this.fontSizes['yAxisLabels'],\r\n                    // }\r\n                },\r\n                gridZIndex: 4,\r\n                lineWidth: 0,\r\n                endOnTick: true,\r\n                showFirstLabel: false,\r\n                showLastLabel: true,\r\n                min: -15,\r\n                max: 100,\r\n                tickPositions: [-15, 0, 25, 50, 75, 100, 102]\r\n            },\r\n            series: undefined,\r\n            colors: undefined,\r\n            plotOptions: {\r\n                series: {\r\n                    animation: {\r\n                        duration: this.props.isAnimatedInitial ? 750 : 0\r\n                    },\r\n                    states: {\r\n                        hover: {\r\n                            enabled: this.props.isAnimatedInitial\r\n                        }\r\n                    },\r\n                    dataLabels: {\r\n                        enabled: undefined,\r\n                        style: {\r\n                            fontWeight: 'bold',\r\n                            fontSize: this.fontSizes['dataLabels'],\r\n                            textOutline: this.fontSizes['dataLabelsOutline'] + \" #fafbfc\",\r\n                        },\r\n                        format: undefined,\r\n                        padding: 0,\r\n                        allowOverlap: true,\r\n                        z: 7\r\n                    },\r\n                    point: {\r\n                        events: {\r\n                            mouseOut: () => {\r\n                                if (this.isForComparison){\r\n                                    this.slice.tooltip.hide();\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                column: {\r\n                    grouping: false,\r\n                    shadow: false,\r\n                }\r\n            },\r\n            tooltip: {\r\n                enabled: this.props.hasTooltip,\r\n                shared: this.isForComparison,\r\n                useHTML: true,\r\n                outside: this.isMobile,\r\n                positioner: tooltipPositioner,\r\n                followPointer: !this.isMobile,\r\n                headerFormat: `<span style=\"font-size: ${this.fontSizes['tooltipHeader']}; font-weight: bold\">{point.key}</span><br/>`,\r\n                pointFormat: `<br>${this.isForComparison ? '<span style=\"color: {point.tooltipColor}; font-weight: bold\">{point.playerName}</span><br>' : \"\"}\r\n                              Raw Value: <span style=\"color: {point.tooltipColor}; font-weight: bold\">{point.p90_label}</span>\r\n                              <br>Percentile Rank: <span style=\"color: {point.tooltipColor}; font-weight: bold\">{point.percentile_label}</span>`,\r\n                style: {\r\n                    fontSize: this.fontSizes['tooltip'],\r\n                    zIndex: 100\r\n                },\r\n                borderColor: this.isForComparison ? '#b9b9b9' : undefined,\r\n                backgroundColor: '#fafbfc',\r\n                borderWidth: 2\r\n            },\r\n            legend: {\r\n                enabled: this.isForComparison && !this.isForExport,\r\n                title: {\r\n                    style: {\r\n                        fontSize: this.fontSizes['legendTitle']\r\n                    }\r\n                },\r\n                symbolPadding: this.isForExport ? 15 : (this.isMobile ? 20 : 7),\r\n                align: 'left',\r\n                verticalAlign: 'bottom',\r\n                layout: 'vertical',\r\n                itemStyle: {\r\n                    color: 'black',\r\n                    fontSize: this.fontSizes['legend']\r\n                },\r\n                itemHoverStyle: {\r\n                    color: '#666666'\r\n                },\r\n                y: this.isForExport ? 5 : 10,\r\n                margin: 0,\r\n                padding: 0,\r\n                itemMarginTop: 3\r\n            },\r\n            credits: {\r\n                text: creditsText,\r\n                position: {\r\n                    align: undefined,\r\n                    x: undefined,\r\n                    // y: this.isMobile ? -30 : (this.isForExport ? -15 : -20)\r\n                    y: this.isForExport ? -10 : (this.isMobile ? -30 : -20)\r\n                },\r\n                style: {\r\n                    lineHeight: this.isMobile || this.isForExport ? (this.isForExport ? \"20px\" : \"25px\") : null,\r\n                    fontSize: this.fontSizes['credits']\r\n                },\r\n            },\r\n            lang: {\r\n                noData: \"Select a template and competitions to proceed\",\r\n            },\r\n            noData: {\r\n                attr: {\r\n                    zIndex: 7\r\n                },\r\n                style: {\r\n                    fontWeight: 'bold',\r\n                    fontSize: this.fontSizes['noData'],\r\n                    color: '#303030'\r\n                }\r\n            }\r\n        };\r\n\r\n        //wrap the default Highcharts axis render function to group axis grids with the data series\r\n        //this is done in order to be able to set z-indices on the series relative to the axis grids\r\n        //relevant github issue and further explanation: https://github.com/highcharts/highcharts/issues/3321\r\n        Highcharts.wrap(Highcharts.Axis.prototype, 'render', function (proceed) {\r\n\r\n            //console.log(this);\r\n            proceed.call(this);\r\n            let chart = this.chart;\r\n\r\n            if (!chart.seriesGroup) {\r\n                chart.seriesGroup = chart.renderer.g('series-group')\r\n                    .attr({\r\n                        zIndex: 3\r\n                    })\r\n                    .add();\r\n            }\r\n\r\n            if (this.coll === \"xAxis\" || this.coll === \"yAxis\"){\r\n                this.gridGroup\r\n                    .attr({\r\n                        zIndex: this.options.gridZIndex\r\n                    })\r\n                    .add(chart.seriesGroup);\r\n            }\r\n\r\n            return this;\r\n\r\n        });\r\n\r\n        // Highcharts.wrap(Highcharts.Tick.prototype, 'render', function (proceed) {\r\n        //\r\n        //     console.log(this);\r\n        //     proceed.call(this);\r\n        //     let chart = this.chart;\r\n        //     let axis = this.axis;\r\n        //\r\n        //     if (chart !== undefined){\r\n        //         // if (!chart.seriesGroup) {\r\n        //         //     chart.seriesGroup = chart.renderer.g('series-group')\r\n        //         //         .attr({\r\n        //         //             zIndex: 3\r\n        //         //         })\r\n        //         //         .add();\r\n        //         // }\r\n        //         axis.axisGroup\r\n        //             .attr({\r\n        //                 zIndex: this.pos === 0 ? 4 : 1,\r\n        //                 opacity: 0\r\n        //             })\r\n        //             .add(chart.seriesGroup);\r\n        //     }\r\n        //\r\n        // });\r\n\r\n        this.afterChartCreated = this.afterChartCreated.bind(this);\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * Called just after the Highcharts component is created\r\n     * Stores a reference to the chart in the class\r\n     * @param chart\r\n     */\r\n    afterChartCreated(chart) {\r\n        this.slice = chart;\r\n    }\r\n\r\n\r\n    /**\r\n     * Function to add borders to legend symbols\r\n     */\r\n    drawLegendBorders() {\r\n\r\n        let chart = this.slice;\r\n\r\n        for (let i=0; i<chart.legend.allItems.length; i++){\r\n            chart.legend.allItems[i].legendSymbol.element.setAttribute(\"stroke-width\", \"3\");\r\n            chart.legend.allItems[i].legendSymbol.element.setAttribute(\"stroke\", i === 0 ? \"rgba(231,84,83,0.55)\" : \"#000000\");\r\n        }\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * Called just after the component mount\r\n     */\r\n    componentDidMount() {\r\n        this.drawLegendBorders();\r\n    }\r\n\r\n\r\n    /**\r\n     * Called whenever the component updates. NOT called on the first render\r\n     * @param prevProps\r\n     * @param prevState\r\n     * @param snapshot\r\n     */\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n        this.drawLegendBorders();\r\n    }\r\n\r\n\r\n    // splitText(text, colors) {\r\n    //\r\n    //     let chunks = [];\r\n    //\r\n    //     let textLength = text.length;\r\n    //     let numColors = colors.length;\r\n    //\r\n    //     if (textLength % numColors === 0) {\r\n    //         let chunkSize = Math.floor(textLength / numColors);\r\n    //         for (let i=0; i<textLength; i+=chunkSize){\r\n    //             chunks.push(text.slice(i, i+chunkSize));\r\n    //         }\r\n    //     }\r\n    //\r\n    //     else {\r\n    //         let chunkSize = Math.ceil((textLength) / numColors--);\r\n    //         for (let i=0; i<textLength; i+=chunkSize) {\r\n    //             chunkSize = Math.ceil((textLength - i) / numColors--);\r\n    //             chunks.push(text.slice(i, i+chunkSize));\r\n    //         }\r\n    //     }\r\n    //\r\n    //     return chunks;\r\n    //\r\n    // }\r\n\r\n\r\n    /**\r\n     * Function to generate a string representing the list of selected competitions\r\n     * @param (Object) allCompetitions - object containing arrays of all competitions on per-season basis\r\n     * @param {Object} selectedCompetitions - object containing arrays of selected competitions on per-season basis\r\n     */\r\n    selectedCompetitionsString(allCompetitions, selectedCompetitions, template) {\r\n\r\n        let allSeasons = [];\r\n\r\n        if (template === null || template === \"N/A\"){\r\n            return this.isForComparison ? [\"\"] : [\"-\"];\r\n        }\r\n\r\n        for (let season in selectedCompetitions){\r\n\r\n            if (selectedCompetitions[season].length === 0){\r\n                continue;\r\n            }\r\n\r\n            let currentSeasonString = `${season.replace(\"-\", \"/\")} (`;\r\n            let currentSeason = [];\r\n\r\n            let competitions = Object.values(allCompetitions[season]);\r\n\r\n            let allCompetitionsClubDict = {};\r\n            let selectedCompetitionsClubDict = {};\r\n\r\n            for (let i=0; i<competitions.length; i++){\r\n\r\n                let competition = competitions[i];\r\n                let isSelected = false;\r\n\r\n                if (selectedCompetitions[season].includes(competition)){\r\n                    isSelected = true;\r\n                }\r\n\r\n                let split = competition.split(\" | \");\r\n\r\n                let competitionName = split[0];\r\n                let competitionClub = split[1];\r\n\r\n                if (allCompetitionsClubDict[competitionName] === undefined){\r\n                    allCompetitionsClubDict[competitionName] = [competitionClub];\r\n                }\r\n                else {\r\n                    allCompetitionsClubDict[competitionName].push(competitionClub);\r\n                }\r\n\r\n                if (isSelected){\r\n                    if (selectedCompetitionsClubDict[competitionName] === undefined) {\r\n                        selectedCompetitionsClubDict[competitionName] = [competitionClub];\r\n                    }\r\n                    else {\r\n                        selectedCompetitionsClubDict[competitionName].push(competitionClub);\r\n                    }\r\n                }\r\n\r\n            }\r\n\r\n            for (let competition in selectedCompetitionsClubDict){\r\n\r\n                if (allCompetitionsClubDict[competition].length > 1){\r\n                    currentSeason.push(`${this.competitionDict[competition]} (${selectedCompetitionsClubDict[competition].join(\", \")})`)\r\n                }\r\n                else {\r\n                    currentSeason.push(this.competitionDict[competition]);\r\n                }\r\n\r\n            }\r\n\r\n            currentSeasonString += `${currentSeason.join(\", \")}) `;\r\n\r\n            allSeasons.push(currentSeasonString);\r\n\r\n        }\r\n\r\n        return allSeasons;\r\n    }\r\n\r\n    // competitionStringsComparison(allCompetitions, selectedCompetitions) {\r\n    //\r\n    //     let strings = [];\r\n    //\r\n    //     let seasons = {\r\n    //         0: [],\r\n    //         1: []\r\n    //     };\r\n    //\r\n    //     for (let player in seasons){\r\n    //\r\n    //         for (let season in selectedCompetitions[player]){\r\n    //             if (selectedCompetitions[player][season].length > 0){\r\n    //                 seasons[player].push(season);\r\n    //             }\r\n    //         }\r\n    //\r\n    //     }\r\n    //\r\n    //     let numRows = 0;\r\n    //     for (let player in seasons){\r\n    //         if (seasons[player].length > numRows){\r\n    //             numRows = seasons[player].length;\r\n    //         }\r\n    //     }\r\n    //\r\n    //     for (let i=0; i<numRows; i++){\r\n    //\r\n    //         let currentLineStrings = [];\r\n    //\r\n    //         for (let player in seasons){\r\n    //\r\n    //             if (seasons[player][i] !== undefined){\r\n    //\r\n    //                 let season = seasons[player][i];\r\n    //                 let currentSeasonString = this.temp(season, selectedCompetitions[player], allCompetitions[player]);\r\n    //\r\n    //                 currentLineStrings.push(currentSeasonString);\r\n    //\r\n    //             }\r\n    //             else {\r\n    //                 currentLineStrings.push(\"\");\r\n    //             }\r\n    //\r\n    //         }\r\n    //\r\n    //         strings.push(currentLineStrings);\r\n    //\r\n    //     }\r\n    //\r\n    // }\r\n\r\n\r\n    /**\r\n     * render function\r\n     * configures chart options based on props and draws the slice charts\r\n     * @return {*} - JSX code for the slice charts\r\n     */\r\n    render() {\r\n\r\n        let chartOptions = this.chartOptions;\r\n\r\n        let template = this.props.template;\r\n\r\n        let title;\r\n\r\n        if (this.isForComparison) {\r\n            title = `<span class=\"chart-title player-1\"><a href=${this.props.url[0]} target=\"_blank\" rel=\"noopener noreferrer\">${this.props.names[0]}</a></span>`;\r\n            title += `<span class=\"player-2\"> vs <span class=\"chart-title\"><a href=${this.props.url[1]} target=\"_blank\" rel=\"noopener noreferrer\">${this.props.names[1]}</a></span></span>`;\r\n\r\n            if (this.isMobile && !this.isForExport){\r\n                let temp = {\r\n                    player1: this.selectedCompetitionsString(this.props.competitions[0], this.props.selectedCompetitions[0], template),\r\n                    player2: this.selectedCompetitionsString(this.props.competitions[1], this.props.selectedCompetitions[1], template)\r\n                };\r\n                title += \"<div id='competitions-container' class='centered-around-separator'>\";\r\n                for (let i=0; i<Math.max(temp.player1.length, temp.player2.length); i++){\r\n                    title += `<div><span class=\"player-1 competitions\">${temp.player1[i] === undefined ? \"\" : temp.player1[i]}</span>  <span class=\"player-2 competitions\">${temp.player2[i] === undefined ? \"\" : temp.player2[i]}</span></div>`;\r\n                }\r\n                title += \"</div>\"\r\n            }\r\n            else {\r\n                title += '<br>';\r\n                title += `<div id='competitions-container'><span class=\"player-1 competitions\">${this.selectedCompetitionsString(this.props.competitions[0], this.props.selectedCompetitions[0], template).join(\"&nbsp|&nbsp&nbsp\")}</span>`;\r\n                title += `<span class=\"player-2 competitions\"> - ${this.selectedCompetitionsString(this.props.competitions[1], this.props.selectedCompetitions[1], template).join(\"&nbsp|&nbsp&nbsp\")}</span></div>`;\r\n            }\r\n        }\r\n        else {\r\n            title = `<span class=\"chart-title player-1\"><a href=${this.props.url} target=\"_blank\" rel=\"noopener noreferrer\">${this.props.name}</a>`;\r\n            if (!this.isForExport){\r\n                title += `<a href=${this.props.url} target=\"_blank\" rel=\"noopener noreferrer\"><i id=\"link-icon\" class=\"fa fa-external-link\"></i></a></span>`;\r\n            }\r\n\r\n            let competitionStringParts = this.selectedCompetitionsString(this.props.competitions, this.props.selectedCompetitions, template);\r\n            if (this.isMobile && !this.isForExport){\r\n                title += \"<div id='competitions-container'>\";\r\n                for (let i=0; i<competitionStringParts.length; i++){\r\n                    title += `<span class=\"player-1 competitions\">${competitionStringParts[i]}</span><br>`;\r\n                }\r\n                title += \"</div>\"\r\n            }\r\n            else {\r\n                title += `<br><div id='competitions-container'><span class=\"player-1 competitions\">${competitionStringParts.join(\"&nbsp|&nbsp&nbsp\")}</span></div>`;\r\n            }\r\n        }\r\n        chartOptions.title.text = title;\r\n\r\n        //build the subtitle\r\n        let subtitle;\r\n        if (this.props.template === null || this.props.template === \"N/A\" || this.props.series.length === 0) {\r\n            chartOptions.xAxis.visible = false;\r\n            chartOptions.yAxis.visible = false;\r\n            subtitle = \"-<br>-<br>\";\r\n        }\r\n        else {\r\n            chartOptions.xAxis.visible = true;\r\n            chartOptions.yAxis.visible = true;\r\n            if (this.isForComparison) {\r\n                subtitle = `<span class=\"player-1\">Age: <span class=\"player-1 age-minutes\">${this.props.ages[0]}</span>  </span>`;\r\n                subtitle += `<span class=\"player-1\">Minutes: <span class=\"player-1 age-minutes\">${this.props.minutes[0].toLocaleString()}</span></span>`;\r\n                subtitle += \"<b> - </b>\";\r\n                subtitle += `<span class=\"player-2\">Age: <span class=\"age-minutes\">${this.props.ages[1]}</span>  </span>`;\r\n                subtitle += `<span class=\"player-2\">Minutes: <span class=\"age-minutes\">${this.props.minutes[1].toLocaleString()}</span></span>`;\r\n                subtitle += \"<br>\"\r\n            }\r\n            else {\r\n                subtitle = `Age: <span class=\"player-1 age-minutes\">${this.props.age}</span> `;\r\n                subtitle += `Minutes: <span class=\"player-1 age-minutes\">${this.props.minutes.toLocaleString()}</span><br>`;\r\n            }\r\n            subtitle += `${this.subtitles[this.props.template]}`;\r\n        }\r\n        //set the subtitle\r\n        chartOptions.subtitle.text = subtitle;\r\n\r\n        //calculate the start angle based on the number of wedges\r\n        //the goal is to have the first wedge pointing to 0 degrees\r\n        chartOptions.pane.startAngle = -((360/this.categories[this.props.template].length)/2);\r\n\r\n        let chart = chartOptions.chart;\r\n        //set animation (on update) to true or false\r\n        chart.animation = this.props.isAnimated;\r\n        //set chart margins\r\n        if (this.isForExport){\r\n            chart.marginTop = 230;\r\n            chart.marginBottom = 130;\r\n        }\r\n        else {\r\n            chart.marginBottom = (this.props.creditsPosition === \"right\" && !this.props.isMobile) ? 30 : 60;\r\n        }\r\n\r\n        let padjOffensive = this.props.padjTypes['offensive'];\r\n        let padjDefensive = this.props.padjTypes['defensive'];\r\n\r\n        let offensiveSuffix = padjOffensive ? \" per 100 touches\" : \" per 90\";\r\n        let defensiveSuffix = padjDefensive ? \" per 90 (pAdj)\" : \" per 90\";\r\n\r\n        let categories = JSON.parse(JSON.stringify(this.categories[this.props.template]));\r\n\r\n        for (let i=0; i<categories.length; i++){\r\n\r\n            let stat = categories[i];\r\n\r\n            if (this.statTypes['offensiveVariable'].includes(stat)){\r\n                categories[i] += `<span style=\"font-size: 0.8em\">${offensiveSuffix}</span>`;\r\n            }\r\n            else if (this.statTypes['defensiveVariable'].includes(stat)){\r\n                categories[i] += `<span style=\"font-size: 0.8em\">${defensiveSuffix}</span>`;\r\n            }\r\n            else if (this.statTypes['constant'].includes(stat)){\r\n                categories[i] += `<span style=\"font-size: 0.8em\"> per 90</span>`;\r\n            }\r\n\r\n        }\r\n\r\n        let xAxis = chartOptions.xAxis;\r\n\r\n\r\n        //set x-axis labels\r\n        xAxis.categories = categories;\r\n\r\n        //set data points\r\n        chartOptions.series = this.props.series.map((data, index) => {\r\n            return {\r\n                name: data[0].playerName,\r\n                data: data,\r\n                zIndex: index === 0 ? 0 : 3,\r\n                pointPadding: 0,\r\n                groupPadding: 0,\r\n                stickyTracking: false,\r\n            };\r\n        });\r\n\r\n        //set series colors\r\n        chartOptions.colors = [\r\n            'rgba(231,84,83,0.55)',\r\n            '#fafbfc'\r\n        ];\r\n\r\n        //set data labels\r\n        let dataLabels = chartOptions.plotOptions.series.dataLabels;\r\n        dataLabels.enabled = this.props.template !== \"N/A\" && !this.isForComparison;\r\n        dataLabels.format = this.props.labelType === \"raw\" ? '{point.p90_label}' : '{point.percentile_label}';\r\n\r\n        //set credits position\r\n        let credits = chartOptions.credits;\r\n        let creditsPosition = this.props.creditsPosition;\r\n        credits.position.align = this.isForExport ? \"center\" : creditsPosition;\r\n        credits.position.x = this.isForExport || creditsPosition === \"center\" ? 0 : -10;\r\n\r\n        let className = this.isForExport ? undefined : \"result\";\r\n        let id = this.isForExport ? \"export\" : \"chart\";\r\n\r\n        let helpButton = null;\r\n        if (!this.isForExport)\r\n            helpButton = <button className=\"fas fa-question-circle explanation-button\" onClick={this.props.toggleGlossaryOverlay}/>;\r\n\r\n        //pass chart options to the Highcharts component and render\r\n        return (\r\n            <div className={className} id={id}>\r\n                {helpButton}\r\n                <HighchartsReact\r\n                    constructorType={\"chart\"}\r\n                    highcharts={Highcharts}\r\n                    containerProps={{style: {width: '100%', height: '100%'}}}\r\n                    options={chartOptions}\r\n                    callback={this.afterChartCreated}\r\n                />\r\n            </div>\r\n        );\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default (Slice);\r\n","import React, { Component } from 'react';\r\n\r\n\r\n/**\r\n * Component to render the glossary overlay\r\n */\r\nclass GlossaryOverlay extends Component {\r\n\r\n    constructor(props) {\r\n\r\n        super(props);\r\n        this.toggleGlossaryOverlay = this.props.toggleGlossaryOverlay;\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * render function\r\n     * displays the player comparison search screen\r\n     * @return {*} - JSX code for the searchbar and its container\r\n     */\r\n    render() {\r\n\r\n        //return JSX code for the glossary overlay\r\n        return (\r\n            <div className={`overlay ${this.props.display ? \"open\" : \"closed\"}`} id=\"glossary-overlay\">\r\n                <div className={'overlay-inner-container'} id={'glossary-container'}>\r\n                    <button className=\"close-overlay far fa-times-circle\" onClick={this.toggleGlossaryOverlay}/>\r\n                    <div className=\"help-section-container\">\r\n                        <h2>Interpreting the Slices</h2>\r\n                        <p>\r\n                            A Football Slice is made up of a number of wedges (12 for outfield players, 3 for goalkeepers),\r\n                            each representing a relevant stat. The length of each wedge corresponds to the\r\n                            selected player's percentile rank for the stat when they are compared to top-5 league\r\n                            players who play in a similar position.\r\n                        </p>\r\n                        <p>\r\n                            The percentile rank of a score is the percentage of scores within a dataset\r\n                            that are equal to or lower than the score. This is reversed for stats where\r\n                            a lower value is better, such as 'turnovers'. <b>In short, a bigger bar is always better.</b>\r\n                        </p>\r\n                        <p>\r\n                            The colours help to group similar-ish stats together (as well as improve the charts'\r\n                            visual impact).\r\n                        </p>\r\n                        <ul>\r\n                            <li><span style={{color: '#f15c80', fontWeight: 'bold'}}>Red</span> is for goal-scoring & shooting stats,</li>\r\n                            <li><span style={{color: '#e4c000', fontWeight: 'bold'}}>Yellow</span> is for passing, chance creation & ball progression</li>\r\n                            <li><span style={{color: '#87e179', fontWeight: 'bold'}}>Green</span> is for dribbling & ball retention</li>\r\n                            <li><span style={{color: '#7db9f0', fontWeight: 'bold'}}>Blue</span> is for defending</li>\r\n                            <li>and <span style={{color: '#787ccd', fontWeight: 'bold'}}>Purple</span> is for goalkeeping stats</li>\r\n                        </ul>\r\n                    </div>\r\n                    <div className=\"help-section-container\" id=\"glossary-section-container\">\r\n                        <h2>Glossary</h2>\r\n                        <ul>\r\n                            <li>\r\n                                <span style={{color: '#f15c80', fontWeight: 'bold'}}>Non-Penalty Goal</span>&nbsp;\r\n                                A goal that did not stem directly from a penalty kick.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#f15c80', fontWeight: 'bold'}}>Non-Penalty xG (Expected Goals)</span>&nbsp;\r\n                                Expected goals that did not stem directly from penalty kicks.*\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#f15c80', fontWeight: 'bold'}}>Non-Penalty xG/Shot</span>&nbsp;\r\n                                The average expected goal value of shots taken, excluding penalty kicks.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#f15c80', fontWeight: 'bold'}}>Aerial Win</span>&nbsp;\r\n                                Winning the ball in a duel that was challenged in the air.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#f15c80', fontWeight: 'bold'}}>Aerial Win %</span>&nbsp;\r\n                                The percentage of aerials duels contested that were won.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#e4c000', fontWeight: 'bold'}}>Touch in Box</span>&nbsp;\r\n                                Having possession of the ball in the opposition's penalty area.\r\n                                (Note: Receiving a pass, then dribbling, then sending a pass counts as one touch)\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#e4c000', fontWeight: 'bold'}}>xA (Expected Assists)</span>&nbsp;\r\n                                Expected goals that resulted from a player's shot assists, including set pieces.*\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#e4c000', fontWeight: 'bold'}}>OP (Open Play) Shot-Creating Action</span>&nbsp;\r\n                                Excluding set pieces, one of the last two offensive actions that directly\r\n                                led to a shot; such as a pass, dribble or a drawn foul.\r\n                                (Note: A single player can receive credit for multiple actions and the shot-taker can also receive credit)\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#e4c000', fontWeight: 'bold'}}>Pass into Box</span>&nbsp;\r\n                                A completed pass that entered the opposition's penalty area, excluding set pieces.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#e4c000', fontWeight: 'bold'}}>Pass into Final 1/3</span>&nbsp;\r\n                                A completed pass that entered the third of the pitch that is closest to the opposition's goal, excluding set pieces.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#e4c000', fontWeight: 'bold'}}>Yards Progressed</span>&nbsp;\r\n                                Distance, in yards, that the ball was moved towards the oppositions's goal\r\n                                with passes and carries.\r\n                                (Note: Passes and carries away from the oppositions's goal are counted as zero progressive yards)\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#e4c000', fontWeight: 'bold'}}>Pass Completion %</span>&nbsp;\r\n                                The percentage of attempted passes that successfully found a teammate.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#e4c000', fontWeight: 'bold'}}>Long Pass Completion %</span>&nbsp;\r\n                                The percentage of attempted passes of 25 yards or more that successfully found a teammate.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#e4c000', fontWeight: 'bold'}}>Launched Pass Completion %</span>&nbsp;\r\n                                The percentage of attempted passes of 40 yards or more that successfully found a teammate, including goal kicks.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#87e179', fontWeight: 'bold'}}>Successful Dribble</span>&nbsp;\r\n                                A successful attempt at taking on a player and making it past them whilst retaining possession.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#87e179', fontWeight: 'bold'}}>Dribble Success %</span>&nbsp;\r\n                                The percentage of attempted dribbles that were successful.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#87e179', fontWeight: 'bold'}}>Turnover</span>&nbsp;\r\n                                A miscontrol, or being tackled by an opponent and losing possession of the ball without attempting a dribble.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#7db9f0', fontWeight: 'bold'}}>pAdj</span>&nbsp;\r\n                                Possession Adjusted (using the StatsBomb sigmoid function).**\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#7db9f0', fontWeight: 'bold'}}>Successful Pressure</span>&nbsp;\r\n                                A pressing action that led to the team regaining possession within the next 5 seconds.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#7db9f0', fontWeight: 'bold'}}>Interception</span>&nbsp;\r\n                                A prevention of an opponent's pass from reaching another opponent by moving into the line of the pass.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#7db9f0', fontWeight: 'bold'}}>Successful Tackle</span>&nbsp;\r\n                                A successful dispossession of an opponent (whether the tackler's team won possession of the ball or not).\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#7db9f0', fontWeight: 'bold'}}>Tackle/Dribbled Past %</span>&nbsp;\r\n                                The percentage of dribblers faced that were tackled.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#7db9f0', fontWeight: 'bold'}}>Aerial Win</span>&nbsp;\r\n                                Winning the ball in a duel that was challenged in the air.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#7db9f0', fontWeight: 'bold'}}>Aerial Win %</span>&nbsp;\r\n                                The percentage of aerials duels contested that were won.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#7db9f0', fontWeight: 'bold'}}>Clearance</span>&nbsp;\r\n                                An action where a player kicked/headed the ball away from their own goal.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#787ccd', fontWeight: 'bold'}}>GSAA (Goals Saved Above Average) %</span>&nbsp;\r\n                                (Post-Shot xG  Goals Conceded (excluding own goals))  Shots on Target Faced.***\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#787ccd', fontWeight: 'bold'}}>Cross Stopping %</span>&nbsp;\r\n                                The percentage of attempted crosses into the penalty area that were stopped by the goalkeeper.\r\n                            </li>\r\n                        </ul>\r\n                        <div id=\"glossary-links\">\r\n                                <span>\r\n                                    * <a href=\"https://fbref.com/en/expected-goals-model-explained/\" target=\"_blank\" rel=\"noopener noreferrer\">Expected goals/assists model explanation</a>\r\n                                </span>\r\n                                <span>\r\n                                    ** <a href=\"https://statsbomb.com/2014/06/introducing-possession-adjusted-player-stats/\" target=\"_blank\" rel=\"noopener noreferrer\">Possession adjustment explanation</a>\r\n                                </span>\r\n                                <span>\r\n                                    *** <a href=\"https://statsbomb.com/2018/12/introducing-goalkeeper-radars/\" target=\"_blank\" rel=\"noopener noreferrer\">GSAA % explanation</a>\r\n                                </span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n        );\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default (GlossaryOverlay);\r\n","import React, { Component } from 'react';\r\nimport SearchBar from \"./SearchBar\";\r\n\r\n\r\n/**\r\n * Component to render the player comparison search screen\r\n * Also handles the live search requests and aborts\r\n */\r\nclass CompareSearchOverlay extends Component {\r\n\r\n    constructor(props) {\r\n\r\n        super(props);\r\n\r\n        this.isMobile = this.props.isMobile;\r\n\r\n        this.toggleCompareSearchOverlay = this.props.toggleCompareSearchOverlay;\r\n        this.currentPlayerName = this.props.currentPlayerName;\r\n        this.currentPlayerCode = this.props.currentPlayerCode;\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * render function\r\n     * displays the player comparison search screen\r\n     * @return {*} - JSX code for the searchbar and its container\r\n     */\r\n    render() {\r\n\r\n        //return JSX code for the searchbar\r\n        return (\r\n            <div className={`overlay ${this.props.display ? \"open\" : \"closed\"}`} id=\"compare-search-overlay\">\r\n                <button className=\"close-overlay far fa-times-circle\" onClick={this.toggleCompareSearchOverlay}/>\r\n                <span><h3>Compare {this.currentPlayerName} to...</h3></span>\r\n                <SearchBar\r\n                    isMobile={this.isMobile}\r\n                    page=\"compare\"\r\n                    currentPlayerCode={this.currentPlayerCode}\r\n                />\r\n            </div>\r\n\r\n        );\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default (CompareSearchOverlay);\r\n","import React, { Component } from 'react';\r\n\r\n\r\n/**\r\n * Component to render the player comparison search screen\r\n * Also handles the live search requests and aborts\r\n */\r\nclass LoaderOverlay extends Component {\r\n\r\n    /**\r\n     * render function\r\n     * displays the export loader overlay\r\n     * @return {*} - JSX code for the searchbar and its container\r\n     */\r\n    render() {\r\n\r\n        //return JSX code for the searchbar\r\n        return (\r\n            <div className={`overlay ${this.props.display ? \"open\" : \"closed\"}`} id=\"export-loader-overlay\">\r\n                <div className=\"loader\">Loading...</div>\r\n            </div>\r\n\r\n        );\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default (LoaderOverlay);\r\n","import React, { Component } from 'react';\r\nimport { Redirect } from 'react-router-dom'\r\n\r\n//import dependencies\r\nimport Cookies from 'universal-cookie';\r\nimport dateFormat from 'dateformat';\r\n\r\n//import utility functions, constants\r\nimport {\r\n    filterStats,\r\n    calculateStats,\r\n    constructChartInput,\r\n    ageRangesString,\r\n    changeTemplate,\r\n    changeSelectedCompetitions,\r\n    changePAdjTypes,\r\n    changeLabelType,\r\n    toggleCreditsPosition,\r\n    exportChart,\r\n    toggleGlossaryOverlay,\r\n    toggleCompareSearchOverlay\r\n} from \"../utilities/SliceUtilities\"\r\n\r\n//import components\r\nimport LoadingSpinner from \"../components/LoadingSpinner\";\r\nimport SearchBar from \"../components/SearchBar\";\r\nimport SliceOptions from \"../components/SliceOptions\";\r\nimport Slice from \"../components/Slice\";\r\nimport GlossaryOverlay from \"../components/GlossaryOverlay\";\r\nimport CompareSearchOverlay from \"../components/CompareSearchOverlay\";\r\nimport LoaderOverlay from \"../components/LoaderOverlay\";\r\n\r\n//initialize cookies\r\nconst cookies = new Cookies();\r\n\r\n\r\n/**\r\n * Stats page component\r\n */\r\nclass Stats extends Component {\r\n\r\n    //class variable to track if the component is mounted\r\n    _isMounted = false;\r\n\r\n    /**\r\n     * Constructor\r\n     * @param props\r\n     */\r\n    constructor(props){\r\n\r\n        super(props);\r\n\r\n        //bind utility functions to this context\r\n        this.filterStats = filterStats.bind(this);\r\n        this.calculateStats = calculateStats.bind(this);\r\n        this.constructChartInput = constructChartInput.bind(this);\r\n        this.ageRangesString = ageRangesString.bind(this);\r\n        this.changeTemplate = changeTemplate.bind(this);\r\n        this.changePAdjTypes = changePAdjTypes.bind(this);\r\n        this.changeSelectedCompetitions = changeSelectedCompetitions.bind(this);\r\n        this.changeLabelType = changeLabelType.bind(this);\r\n        this.toggleCreditsPosition = toggleCreditsPosition.bind(this);\r\n        this.exportChart = exportChart.bind(this);\r\n        this.toggleGlossaryOverlay = toggleGlossaryOverlay.bind(this);\r\n        this.toggleCompareSearchOverlay = toggleCompareSearchOverlay.bind(this);\r\n\r\n        //device and browser info\r\n        this.isMobile = this.props.isMobile;\r\n        this.isSafari = this.props.isSafari;\r\n\r\n        //cookies\r\n        let pAdjTypesCookie = cookies.get('pAdjTypes');\r\n        let labelTypeCookie = cookies.get('labelType');\r\n        let creditsPositionCookie = cookies.get('creditsPosition');\r\n\r\n        this.state = {\r\n            isLoading: true,\r\n            error: null,\r\n            redirect: false,\r\n            showGlossaryOverlay: false,\r\n            showCompareSearchOverlay: false,\r\n            showExportLoaderOverlay: false,\r\n            renderForExport: false,\r\n            percentileArrays: this.props.percentileArrays,\r\n            statsByPosition: {},\r\n            code: this.props.match.params.code,\r\n            name: '',\r\n            url: '',\r\n            age: 0,\r\n            clubs: {},\r\n            percentileEntries: {},\r\n            stats: {},\r\n            isGK: false,\r\n            isOutfieldGK: false,\r\n            outfieldGKStats: null,\r\n            standardStats: null,\r\n            lastUpdated: null,\r\n            template: null,\r\n            competitions: {},\r\n            selectedCompetitions: {},\r\n            pAdjTypes: pAdjTypesCookie === undefined ? { offensive: false, defensive: false } : pAdjTypesCookie,\r\n            labelType: labelTypeCookie === undefined ? \"raw\" : labelTypeCookie,\r\n            creditsPosition: creditsPositionCookie === undefined ? \"right\" : creditsPositionCookie,\r\n            isAnimated: true\r\n        };\r\n\r\n        this.getStats();\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * Called after component has mounted\r\n     */\r\n    componentDidMount() {\r\n        this._isMounted = true;\r\n    }\r\n\r\n\r\n    /**\r\n     * Called just before the component receives new props. This is done to ensure that new props trigger a re-render\r\n     * @param nextProps\r\n     * @param nextContext\r\n     */\r\n    //TODO: re-factor because componentWillReceiveProps has been deprecated\r\n    UNSAFE_componentWillReceiveProps(nextProps, nextContext) {\r\n\r\n        let { code } = nextProps.match.params;\r\n\r\n        this.setState({\r\n            redirect: false,\r\n            isLoading: true,\r\n            code: code\r\n        }, () => {\r\n            this.getStats();\r\n        });\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * Function to send a post request to the server to retrieve the stats of the player\r\n     */\r\n    getStats = () => {\r\n\r\n        const code = this.state.code;\r\n\r\n        //fetch stats\r\n        fetch('/api/stats', {\r\n            method: 'post',\r\n            headers: {\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            body: JSON.stringify({\r\n                \"code\": code,\r\n                \"percentilesTimestamp\": this.state.percentileArrays['lastUpdated']\r\n            })\r\n        })\r\n        .then(res => {\r\n            if (res.ok) {\r\n                return res.json()\r\n            }\r\n            else {\r\n                throw new Error(\"Failed to fetch. This is likely due to a malformed URL. Please try searching for the player again.\")\r\n            }\r\n        })\r\n        .then(response => this.processStats(response))\r\n        .catch(error => {\r\n            if (this._isMounted){\r\n                //redirect if a v1 URL is detected\r\n                if (code.match(\"^Players_[0-9]+_Show_\")){\r\n                    this.setState({\r\n                        redirect: true,\r\n                        isLoading: false,\r\n                        code: code.split(\"_\")[1]\r\n                    })\r\n                }\r\n                else {\r\n                    this.setState({\r\n                        error: error,\r\n                        isLoading: false\r\n                    })\r\n                }\r\n            }\r\n        });\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Function to process retrieved player stats and save to state\r\n     * @param {Object} response - object containing the player metadata and stats, as well as new percentile arrays\r\n     * in the event that the server needs to update a client's percentile arrays.\r\n     */\r\n    processStats = (response) => {\r\n\r\n        //check if the stats object contains new percentile arrays\r\n        if (response.newPercentileArrays !== undefined){\r\n            //update percentile arrays in parent component as required\r\n            this.props.updatePercentileArrays(response.newPercentileArrays);\r\n        }\r\n\r\n        let playerData = response.data;\r\n\r\n        //process player position entry and set template. template is set to the most recent non-\"N/A\" position\r\n        //in the player's position entries\r\n        let template = \"N/A\";\r\n        for (let season in playerData.positions){\r\n            let position = playerData.positions[season][0];\r\n            if (position !== \"N/A\"){\r\n                template = position;\r\n            }\r\n        }\r\n\r\n        let seasons = Object.keys(playerData.stats);\r\n\r\n        let competitions = {};\r\n        let selectedCompetitions = {};\r\n\r\n        //retrieve player competitions. stored in an object where the keys are seasons and the values are arrays\r\n        //of the competitions for the season\r\n        for (let season in playerData.stats){\r\n\r\n            competitions[season] = [];\r\n            selectedCompetitions[season] = [];\r\n\r\n            for (let competition in playerData.stats[season]){\r\n                competitions[season].push(competition);\r\n                //only 2 most recent season in selected competitions\r\n                if (season === seasons[seasons.length - 1] || season === seasons[seasons.length - 2]){\r\n                    selectedCompetitions[season].push(competition);\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n        if (this._isMounted){\r\n\r\n            this.setState({\r\n                isLoading: false,\r\n                statsByPosition: response.statsByPosition,\r\n                name: playerData.name,\r\n                url: \"https://www.fbref.com\" + playerData.fbrefURL,\r\n                age: playerData.age,\r\n                clubs: playerData.clubs,\r\n                percentileEntries: playerData.percentileEntries,\r\n                stats: playerData.stats,\r\n                isGK: template === \"GK\",\r\n                isOutfieldGK: playerData.outfieldGKStats != null,\r\n                outfieldGKStats: playerData.outfieldGKStats,\r\n                standardStats: playerData.stats,\r\n                lastUpdated: dateFormat(playerData.lastUpdated, \"dd/mm/yyyy, h:MM TT\", true),\r\n                template: template,\r\n                competitions: JSON.parse(JSON.stringify(competitions)),\r\n                selectedCompetitions: JSON.parse(JSON.stringify(selectedCompetitions))\r\n            });\r\n\r\n            document.title = `${playerData.name} | Football Slices`;\r\n\r\n            this.props.recordPageViewGA(window.location.pathname);\r\n        }\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Called just before the component un-mounts\r\n     */\r\n    componentWillUnmount() {\r\n        this._isMounted = false;\r\n    }\r\n\r\n\r\n    /**\r\n     * render function\r\n     * @return {*} - JSX code for the stats page\r\n     */\r\n    render() {\r\n\r\n        let {\r\n            isLoading,\r\n            error,\r\n            redirect,\r\n            showGlossaryOverlay,\r\n            showCompareSearchOverlay,\r\n            showExportLoaderOverlay,\r\n            renderForExport,\r\n            statsByPosition,\r\n            code,\r\n            url,\r\n            name,\r\n            age,\r\n            clubs,\r\n            stats,\r\n            isGK,\r\n            isOutfieldGK,\r\n            lastUpdated,\r\n            competitions,\r\n            selectedCompetitions,\r\n            template,\r\n            pAdjTypes,\r\n            labelType,\r\n            creditsPosition,\r\n            isAnimated\r\n        } = this.state;\r\n\r\n        //display loading spinner while the server responds to POST request for the stats\r\n        if (isLoading) {\r\n            return (\r\n                <LoadingSpinner/>\r\n            )\r\n        }\r\n\r\n        else if (redirect){\r\n            return <Redirect to={`/stats/${code}`}/>\r\n        }\r\n\r\n        //display the error message screen if an error is caught\r\n        else if (error !== null) {\r\n            return (\r\n                <div id=\"main2\">\r\n                    <SearchBar\r\n                        isMobile={this.isMobile}\r\n                        page=\"stats\"\r\n                        query={this.state.query}\r\n                    />\r\n                    <div className=\"screen\" id=\"error-screen\">\r\n                        <p>{error.message}</p>\r\n                    </div>\r\n                </div>\r\n            )\r\n        }\r\n\r\n        //build stats page otherwise\r\n        else {\r\n\r\n            //calculate stats and construct chart input\r\n            let filteredStats = {};\r\n            let series = [];\r\n\r\n            if (template !== null && template !== \"N/A\") {\r\n                filteredStats = this.filterStats(stats);\r\n                if (Object.keys(filteredStats).length !== 0){\r\n                    let calculatedStats = this.calculateStats(filteredStats);\r\n                    let chartInput = this.constructChartInput(statsByPosition, calculatedStats.statsPer90, calculatedStats.percentiles);\r\n                    series.push(chartInput);\r\n                }\r\n            }\r\n\r\n            let exportSlice = null;\r\n\r\n            if (renderForExport) {\r\n                exportSlice =\r\n                <Slice\r\n                    isMobile={this.isMobile}\r\n                    isForComparison={false}\r\n                    isForExport={true}\r\n                    isAnimated={false}\r\n                    isAnimatedInitial={false}\r\n                    hasTooltip={false}\r\n                    creditsPosition={creditsPosition}\r\n                    url={null}\r\n                    lastUpdated={lastUpdated}\r\n                    template={template}\r\n                    labelType={labelType}\r\n                    name={name}\r\n                    competitions={competitions}\r\n                    selectedCompetitions={selectedCompetitions}\r\n                    age={age}\r\n                    minutes={filteredStats['minutes']}\r\n                    padjTypes={pAdjTypes}\r\n                    series={series}\r\n                />\r\n            }\r\n\r\n            //return JSX code for the stats page\r\n            return (\r\n                <div id=\"main2\">\r\n                    <GlossaryOverlay\r\n                        display={showGlossaryOverlay}\r\n                        toggleGlossaryOverlay={this.toggleGlossaryOverlay}\r\n                    />\r\n                    <CompareSearchOverlay\r\n                        isMobile={this.isMobile}\r\n                        display={showCompareSearchOverlay}\r\n                        currentPlayerCode={code}\r\n                        currentPlayerName={name}\r\n                        toggleCompareSearchOverlay={this.toggleCompareSearchOverlay}\r\n                    />\r\n                    <LoaderOverlay\r\n                        display={showExportLoaderOverlay}\r\n                    />\r\n                    <SearchBar\r\n                        isMobile={this.isMobile}\r\n                        page=\"stats\"\r\n                    />\r\n                    <div className=\"screen2\" id=\"stats-screen\">\r\n                        <SliceOptions\r\n                            isMobile={this.isMobile}\r\n                            isForComparison={false}\r\n                            isGK={isGK}\r\n                            isOutfieldGK={isOutfieldGK}\r\n                            template={template}\r\n                            competitions={competitions}\r\n                            clubs={clubs}\r\n                            selectedCompetitions={selectedCompetitions}\r\n                            pAdjTypes={pAdjTypes}\r\n                            labelType={labelType}\r\n                            changeTemplate={this.changeTemplate}\r\n                            changeSelectedCompetitions={this.changeSelectedCompetitions}\r\n                            changePAdjTypes={this.changePAdjTypes}\r\n                            changeLabelType={this.changeLabelType}\r\n                            toggleCreditsPosition={this.toggleCreditsPosition}\r\n                            exportChart={this.exportChart}\r\n                            toggleCompareSearchOverlay={this.toggleCompareSearchOverlay}\r\n                        />\r\n                        <Slice\r\n                            isMobile={this.isMobile}\r\n                            isForExport={false}\r\n                            isAnimated={isAnimated}\r\n                            isAnimatedInitial={true}\r\n                            hasTooltip={true}\r\n                            creditsPosition={creditsPosition}\r\n                            url={url}\r\n                            lastUpdated={lastUpdated}\r\n                            template={template}\r\n                            labelType={labelType}\r\n                            name={name}\r\n                            competitions={competitions}\r\n                            selectedCompetitions={selectedCompetitions}\r\n                            age={age}\r\n                            minutes={filteredStats['minutes']}\r\n                            padjTypes={pAdjTypes}\r\n                            series={series}\r\n                            toggleGlossaryOverlay={this.toggleGlossaryOverlay}\r\n                        />\r\n                    </div>\r\n                    {/*Second slice used for exports. Not displayed*/}\r\n                    {exportSlice}\r\n                </div>\r\n            );\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default Stats;\r\n","import React, { Component } from 'react';\r\n// import $ from \"jquery\";\r\n\r\n//import dependencies\r\nimport Cookies from 'universal-cookie';\r\n\r\n//import components\r\nimport LoadingSpinner from \"../components/LoadingSpinner\";\r\nimport SearchBar from \"../components/SearchBar\";\r\nimport SliceOptions from \"../components/SliceOptions\";\r\nimport Slice from \"../components/Slice\";\r\nimport GlossaryOverlay from \"../components/GlossaryOverlay\";\r\nimport CompareSearchScreen from \"../components/CompareSearchOverlay\";\r\nimport LoaderOverlay from \"../components/LoaderOverlay\";\r\n\r\n//import utility functions\r\nimport {\r\n    filterStats,\r\n    calculateStats,\r\n    constructChartInput,\r\n    ageRangesString,\r\n    changeTemplate,\r\n    changeSelectedCompetitions,\r\n    changePAdjTypes,\r\n    changeLabelType,\r\n    toggleCreditsPosition,\r\n    exportChart,\r\n    toggleGlossaryOverlay,\r\n    toggleCompareSearchOverlay\r\n} from \"../utilities/SliceUtilities\"\r\n\r\n//initialize helpers\r\nconst dateFormat = require('dateformat');\r\nconst cookies = new Cookies();\r\n\r\n\r\n/**\r\n * Compare page component\r\n */\r\nclass Compare extends Component {\r\n\r\n    //class variable to track if the component is mounted\r\n    _isMounted = false;\r\n\r\n    /**\r\n     * Constructor\r\n     * @param props\r\n     */\r\n    constructor(props){\r\n\r\n        super(props);\r\n\r\n        //bind utility function to this context\r\n        this.filterStats = filterStats.bind(this);\r\n        this.calculateStats = calculateStats.bind(this);\r\n        this.constructChartInput = constructChartInput.bind(this);\r\n        this.ageRangesString = ageRangesString.bind(this);\r\n        this.changeTemplate = changeTemplate.bind(this);\r\n        this.changeSelectedCompetitions = changeSelectedCompetitions.bind(this);\r\n        this.changePAdjTypes = changePAdjTypes.bind(this);\r\n        this.changeLabelType = changeLabelType.bind(this);\r\n        this.toggleCreditsPosition = toggleCreditsPosition.bind(this);\r\n        this.exportChart = exportChart.bind(this);\r\n        this.toggleGlossaryOverlay = toggleGlossaryOverlay.bind(this);\r\n        this.toggleCompareSearchOverlay = toggleCompareSearchOverlay.bind(this);\r\n\r\n        //device and browser info\r\n        this.isMobile = this.props.isMobile;\r\n        this.isSafari = this.props.isSafari;\r\n\r\n        //cookies\r\n        let pAdjTypesCookie = cookies.get('pAdjTypes');\r\n        let labelTypeCookie = cookies.get('labelType');\r\n        let creditsPositionCookie = cookies.get('creditsPosition');\r\n\r\n        //retrieve player codes from the URL\r\n        let codes = this.props.match.params.codes.split(\"_\");\r\n\r\n        //modify them if they are identical (comparing a player to themselves). This is done so the objects holding\r\n        //the data for the 2 instances of the player can have unique keys\r\n        if (codes[0] === codes[1]) {\r\n            codes[0] = codes[0] + \"|1\";\r\n            codes[1] = codes[1] + \"|2\";\r\n        }\r\n\r\n        this.state = {\r\n            isLoading: true,\r\n            error: null,\r\n            showGlossaryOverlay: false,\r\n            showCompareSearchOverlay: false,\r\n            showExportLoaderOverlay: false,\r\n            renderForExport: false,\r\n            percentileArrays: this.props.percentileArrays,\r\n            statsByPosition: {},\r\n            codes: codes,\r\n            names: {},\r\n            urls: {},\r\n            ages: {},\r\n            clubs: {},\r\n            percentileEntries: {},\r\n            stats: {},\r\n            isGK: null,\r\n            isOutfieldGK: {},\r\n            outfieldGKStats: {},\r\n            standardStats: {},\r\n            lastUpdated: null,\r\n            template: null,\r\n            competitions: {},\r\n            selectedCompetitions: {},\r\n            pAdjTypes: pAdjTypesCookie === undefined ? { offensive: false, defensive: false } : pAdjTypesCookie,\r\n            labelType: labelTypeCookie === undefined ? \"raw\" : labelTypeCookie,\r\n            creditsPosition: creditsPositionCookie === undefined ? \"right\" : creditsPositionCookie,\r\n            isAnimated: true\r\n        };\r\n\r\n        this.getStats();\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * Called after component has mounted\r\n     */\r\n    componentDidMount() {\r\n        this._isMounted = true;\r\n    }\r\n\r\n\r\n    /**\r\n     * Called just before the component receives new props. This is done to ensure that new props trigger a re-render\r\n     * @param nextProps\r\n     * @param nextContext\r\n     */\r\n    //TODO: re-factor because componentWillReceiveProps has been deprecated\r\n    UNSAFE_componentWillReceiveProps(nextProps, nextContext) {\r\n\r\n        //retrieve player codes from the URL\r\n        let codes = nextProps.match.params.codes.split(\"_\");\r\n        //modify them if they are identical (comparing a player to themselves). This is done so the objects holding\r\n        //the data for the 2 iterations of the player can have unique keys\r\n        if (codes[0] === codes[1]) {\r\n            codes[0] = codes[0] + \"|1\";\r\n            codes[1] = codes[1] + \"|2\";\r\n        }\r\n\r\n        this.setState({\r\n            isLoading: true,\r\n            showCompareSearchOverlay: false,\r\n            codes: codes\r\n        }, () => {\r\n            this.getStats();\r\n        });\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * Function to send a post request to the server to retrieve the stats of the player\r\n     */\r\n    getStats = () => {\r\n\r\n        const codes = this.state.codes;\r\n\r\n        //fetch stats\r\n        fetch('/api/comparisonStats', {\r\n            method: 'post',\r\n            headers: {\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            body: JSON.stringify({\r\n                \"codes\": codes,\r\n                \"percentilesTimestamp\": this.state.percentileArrays['lastUpdated']\r\n            })\r\n        })\r\n        .then(res => {\r\n            if (res.ok) {\r\n                return res.json()\r\n            }\r\n            else {\r\n                throw new Error(\"Failed to fetch. This is likely due to a malformed URL. Please try searching for the player again.\")\r\n            }\r\n        })\r\n        .then(response => this.processStats(response))\r\n        .catch(error => {\r\n            console.log(error);\r\n            if (this._isMounted){\r\n                this.setState({\r\n                    error: error,\r\n                    isLoading: false\r\n                })\r\n            }\r\n        });\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Function to process retrieved player stats and save to state\r\n     * @param {Object} response - object containing the players' metadata and stats, as well as new percentile arrays\r\n     * in the event that the server needs to update a client's percentile arrays.\r\n     */\r\n    processStats = (response) => {\r\n\r\n        let codes = this.state.codes;\r\n\r\n        //check if the stats object contains new percentile arrays\r\n        if (response.newPercentileArrays !== undefined){\r\n            //update percentile arrays in parent component as required\r\n            this.props.updatePercentileArrays(response.newPercentileArrays);\r\n        }\r\n\r\n        let playerData = response.data;\r\n\r\n        //process player position entry and set template. template is set to the most recent non-\"N/A\" position\r\n        //in the player's position entries\r\n        let template = \"N/A\";\r\n        for (let season in playerData[codes[0]].positions){\r\n            let position = playerData[codes[0]].positions[season][0];\r\n            if (position !== \"N/A\"){\r\n                template = position;\r\n            }\r\n        }\r\n\r\n        let names = {};\r\n        let urls = {};\r\n        let ages = {};\r\n        let clubs = {};\r\n        let percentileEntries = {};\r\n        let stats = {};\r\n        let isOutfieldGK = {};\r\n        let outfieldGKStats = {};\r\n        let standardStats = {};\r\n        let competitions = {};\r\n        let selectedCompetitions = {};\r\n\r\n        //retrieve the information for the 2 players and store in objects\r\n        for (let code in playerData){\r\n\r\n            names[code] = playerData[code].name;\r\n            urls[code] = \"https://www.fbref.com\" + playerData[code].fbrefURL;\r\n            ages[code] = playerData[code].age;\r\n            clubs[code] = playerData[code].clubs;\r\n            percentileEntries[code] = playerData[code].percentileEntries;\r\n\r\n            let hasOutfieldGKStats = playerData[code].outfieldGKStats !== null;\r\n\r\n            //set the initial stats set to GK stats if player 1 is a GK and player 2 is an outfield GK\r\n            stats[code] = (template === \"GK\" && hasOutfieldGKStats) ? playerData[code].outfieldGKStats : playerData[code].stats;\r\n            isOutfieldGK[code] = hasOutfieldGKStats;\r\n\r\n            outfieldGKStats[code] = playerData[code].outfieldGKStats;\r\n            standardStats[code] = playerData[code].stats;\r\n\r\n            let seasons = Object.keys(stats[code]);\r\n\r\n            competitions[code] = {};\r\n            selectedCompetitions[code] = {};\r\n\r\n            //retrieve player competitions. stored in an object where the keys are seasons and the values are arrays\r\n            //of the competitions for the season\r\n            for (let season in stats[code]){\r\n\r\n                competitions[code][season] = [];\r\n                selectedCompetitions[code][season] = [];\r\n\r\n                for (let competition in stats[code][season]){\r\n                    competitions[code][season].push(competition);\r\n                    //only 2 most recent season in selected competitions\r\n                    if (season === seasons[seasons.length - 1] || season === seasons[seasons.length - 2]){\r\n                        selectedCompetitions[code][season].push(competition);\r\n                    }\r\n                }\r\n\r\n            }\r\n\r\n        }\r\n\r\n        if (this._isMounted){\r\n\r\n            this.setState({\r\n                isLoading: false,\r\n                names: JSON.parse(JSON.stringify(names)),\r\n                urls: JSON.parse(JSON.stringify(urls)),\r\n                ages: JSON.parse(JSON.stringify(ages)),\r\n                clubs: JSON.parse(JSON.stringify(clubs)),\r\n                percentileEntries: JSON.parse(JSON.stringify(percentileEntries)),\r\n                statsByPosition: JSON.parse(JSON.stringify(response.statsByPosition)),\r\n                stats: JSON.parse(JSON.stringify(stats)),\r\n                isGK: template === \"GK\",\r\n                isOutfieldGK: JSON.parse(JSON.stringify(isOutfieldGK)),\r\n                outfieldGKStats: JSON.parse(JSON.stringify(outfieldGKStats)),\r\n                standardStats: JSON.parse(JSON.stringify(standardStats)),\r\n                lastUpdated: dateFormat(playerData[codes[0]].lastUpdated, \"dd/mm/yyyy, h:MM TT\", true),\r\n                template: template,\r\n                competitions: JSON.parse(JSON.stringify(competitions)),\r\n                selectedCompetitions: JSON.parse(JSON.stringify(selectedCompetitions))\r\n            });\r\n\r\n            document.title = `${names[codes[0]]} vs ${names[codes[1]]} | Football Slices`;\r\n\r\n            this.props.recordPageViewGA(window.location.pathname);\r\n        }\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Called just before the component un-mounts\r\n     */\r\n    componentWillUnmount() {\r\n        this._isMounted = false;\r\n    }\r\n\r\n\r\n    /**\r\n     * render function\r\n     * @return {*} - JSX code for the compare page\r\n     */\r\n    render() {\r\n\r\n        let {\r\n            isLoading,\r\n            error,\r\n            showGlossaryOverlay,\r\n            showCompareSearchOverlay,\r\n            showExportLoaderOverlay,\r\n            renderForExport,\r\n            statsByPosition,\r\n            codes,\r\n            urls,\r\n            names,\r\n            ages,\r\n            clubs,\r\n            stats,\r\n            isGK,\r\n            isOutfieldGK,\r\n            lastUpdated,\r\n            competitions,\r\n            selectedCompetitions,\r\n            template,\r\n            pAdjTypes,\r\n            labelType,\r\n            creditsPosition,\r\n            isAnimated\r\n        } = this.state;\r\n\r\n        //display loading spinner while the server responds to POST request for the stats\r\n        if (isLoading) {\r\n            return (\r\n                <LoadingSpinner/>\r\n            )\r\n        }\r\n\r\n        //display the error message screen if an error is caught\r\n        else if (error !== null) {\r\n            return (\r\n                <div id=\"main2\">\r\n                    <SearchBar\r\n                        isMobile={this.isMobile}\r\n                        page=\"stats\"\r\n                        query={this.state.query}\r\n                    />\r\n                    <div className=\"screen\" id=\"error-screen\">\r\n                        <p>{error.message}</p>\r\n                    </div>\r\n                </div>\r\n            )\r\n        }\r\n\r\n        //build stats page otherwise\r\n        else {\r\n\r\n            //calculate stats and construct chart input\r\n            let filteredStats = {};\r\n            let series = [];\r\n\r\n            for (let i=0; i<codes.length; i++){\r\n\r\n                let code = codes[i];\r\n                filteredStats[code] = this.filterStats(stats[code], code);\r\n\r\n                if (template !== null && template !== \"N/A\"){\r\n                    let calculatedStats = this.calculateStats(filteredStats[code], code);\r\n                    let chartInput = this.constructChartInput(\r\n                        statsByPosition,\r\n                        calculatedStats.statsPer90,\r\n                        calculatedStats.percentiles,\r\n                        code,\r\n                        names[codes[i]],\r\n                        filteredStats[code]['minutes'],\r\n                        true,\r\n                        i\r\n                    );\r\n                    series.push(chartInput);\r\n                }\r\n\r\n            }\r\n\r\n            let code1 = codes[0];\r\n            let code2 = codes[1];\r\n\r\n            let exportSlice = null;\r\n            if (renderForExport) {\r\n                exportSlice =\r\n                <Slice\r\n                    isMobile={this.isMobile}\r\n                    isForExport={true}\r\n                    isForComparison={true}\r\n                    isAnimated={false}\r\n                    isAnimatedInitial={false}\r\n                    hasTooltip={false}\r\n                    creditsPosition={creditsPosition}\r\n                    url={\r\n                        [null, null]\r\n                    }\r\n                    lastUpdated={lastUpdated}\r\n                    template={template}\r\n                    labelType={labelType}\r\n                    names={\r\n                        [names[code1], names[code2]]\r\n                    }\r\n                    competitions={\r\n                        [competitions[code1], competitions[code2]]\r\n                    }\r\n                    selectedCompetitions={\r\n                        [selectedCompetitions[code1], selectedCompetitions[code2]]\r\n                    }\r\n                    ages={\r\n                        [ages[code1], ages[code2]]\r\n                    }\r\n                    minutes={\r\n                        [filteredStats[code1]['minutes'], filteredStats[code2]['minutes']]\r\n                    }\r\n                    padjTypes={pAdjTypes}\r\n                    series={series}\r\n                />\r\n            }\r\n\r\n            //return JSX code for the stats page\r\n            return (\r\n                <div id=\"main2\">\r\n                    <GlossaryOverlay\r\n                        display={showGlossaryOverlay}\r\n                        toggleGlossaryOverlay={this.toggleGlossaryOverlay}\r\n                    />\r\n                    <CompareSearchScreen\r\n                        isMobile={this.isMobile}\r\n                        display={showCompareSearchOverlay}\r\n                        currentPlayerCode={codes[0]}\r\n                        currentPlayerName={names[codes[0]]}\r\n                        toggleCompareSearchOverlay={this.toggleCompareSearchOverlay}\r\n                    />\r\n                    <LoaderOverlay\r\n                        display={showExportLoaderOverlay}\r\n                    />\r\n                    <SearchBar\r\n                        isMobile={this.isMobile}\r\n                        page=\"stats\"\r\n                    />\r\n                    <div className=\"screen2\" id=\"compare-screen\">\r\n                        <SliceOptions\r\n                            isMobile={this.isMobile}\r\n                            isForComparison={true}\r\n                            isGK={isGK}\r\n                            isOutfieldGK={isOutfieldGK[codes[0]]}\r\n                            codes={codes}\r\n                            names={names}\r\n                            template={template}\r\n                            competitions={competitions}\r\n                            clubs={clubs}\r\n                            selectedCompetitions={selectedCompetitions}\r\n                            pAdjTypes={pAdjTypes}\r\n                            labelType={labelType}\r\n                            changeTemplate={this.changeTemplate}\r\n                            changeSelectedCompetitions={this.changeSelectedCompetitions}\r\n                            changePAdjTypes={this.changePAdjTypes}\r\n                            changeLabelType={this.changeLabelType}\r\n                            toggleCreditsPosition={this.toggleCreditsPosition}\r\n                            exportChart={this.exportChart}\r\n                            toggleCompareSearchOverlay={this.toggleCompareSearchOverlay}\r\n                        />\r\n                        <Slice\r\n                            isMobile={this.isMobile}\r\n                            isForExport={false}\r\n                            isForComparison={true}\r\n                            isAnimated={isAnimated}\r\n                            isAnimatedInitial={true}\r\n                            hasTooltip={true}\r\n                            creditsPosition={creditsPosition}\r\n                            url={\r\n                                [urls[code1], urls[code2]]\r\n                            }\r\n                            lastUpdated={lastUpdated}\r\n                            template={template}\r\n                            labelType={labelType}\r\n                            names={\r\n                                [names[code1], names[code2]]\r\n                            }\r\n                            competitions={\r\n                                [competitions[code1], competitions[code2]]\r\n                            }\r\n                            selectedCompetitions={\r\n                                [selectedCompetitions[code1], selectedCompetitions[code2]]\r\n                            }\r\n                            ages={\r\n                                [ages[code1], ages[code2]]\r\n                            }\r\n                            minutes={\r\n                                [filteredStats[code1]['minutes'], filteredStats[code2]['minutes']]\r\n                            }\r\n                            padjTypes={pAdjTypes}\r\n                            series={series}\r\n                            toggleGlossaryOverlay={this.toggleGlossaryOverlay}\r\n                        />\r\n                    </div>\r\n                    {/*Second slice used for exports. Not displayed*/}\r\n                    {exportSlice}\r\n                </div>\r\n            );\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default Compare;\r\n","import React, { Component } from 'react';\r\n\r\n/**\r\n * 404 component\r\n */\r\nclass Error extends Component {\r\n\r\n    /**\r\n     * render function\r\n     * @return {*} - JSX code for the homepage\r\n     */\r\n    render() {\r\n\r\n        return (\r\n            <h1>404 - Page not found</h1>\r\n        )\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default Error;\r\n","import React, { Component } from 'react';\r\n\r\n\r\n/**\r\n * Component to render the explanation overlay\r\n */\r\nclass ExplanationOverlay extends Component {\r\n\r\n    constructor(props) {\r\n\r\n        super(props);\r\n        this.toggleExplanationOverlay = this.props.toggleExplanationOverlay;\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * render function\r\n     * displays the player comparison search screen\r\n     * @return {*} - JSX code for the searchbar and its container\r\n     */\r\n    render() {\r\n\r\n        //return JSX code for the explanation overlay\r\n        return (\r\n            <div className={`overlay ${this.props.display ? \"open\" : \"closed\"}`} id=\"explanation-overlay\">\r\n                <div className={'overlay-inner-container'} id={'explanation-container'}>\r\n                    <button className=\"close-overlay far fa-times-circle\" onClick={this.toggleExplanationOverlay}/>\r\n                    <div className=\"help-section-container\">\r\n                        <h2>Advanced Search</h2>\r\n                        <p>\r\n                            The advanced search page allows you to explore the entire Football Slices database using as\r\n                            many filters as you'd like. These include everything from player metadata such as ages\r\n                            and nationalities, to performance metrics like non-penalty expected goals and successful\r\n                            dribbles.\r\n                        </p>\r\n                        <p>\r\n                            <b>Please note that percentile ranks are always calculated against the complete top 5 league\r\n                            dataset for a position, regardless of which other filters are selected.</b> For example, if you\r\n                            select full-backs and set the age range to 16 - 24, the percentile ranks are still being calculated\r\n                            against full-backs of all ages, but the results will only show players who fall within the\r\n                            specified age range.\r\n                        </p>\r\n                    </div>\r\n                    <div className=\"help-section-container\" id=\"glossary-section-container\">\r\n                        <h2>Glossary</h2>\r\n                        <ul>\r\n                            <li>\r\n                                <span style={{color: '#f15c80', fontWeight: 'bold'}}>Non-Penalty Goal</span>&nbsp;\r\n                                A goal that did not stem directly from a penalty kick.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#f15c80', fontWeight: 'bold'}}>Non-Penalty xG (Expected Goals)</span>&nbsp;\r\n                                Expected goals that did not stem directly from penalty kicks.*\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#f15c80', fontWeight: 'bold'}}>Non-Penalty xG/Shot</span>&nbsp;\r\n                                The average expected goal value of shots taken, excluding penalty kicks.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#f15c80', fontWeight: 'bold'}}>Aerial Win</span>&nbsp;\r\n                                Winning the ball in a duel that was challenged in the air.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#f15c80', fontWeight: 'bold'}}>Aerial Win %</span>&nbsp;\r\n                                The percentage of aerials duels contested that were won.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#e4c000', fontWeight: 'bold'}}>Touch in Box</span>&nbsp;\r\n                                Having possession of the ball in the opposition's penalty area.\r\n                                (Note: Receiving a pass, then dribbling, then sending a pass counts as one touch)\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#e4c000', fontWeight: 'bold'}}>xA (Expected Assists)</span>&nbsp;\r\n                                Expected goals that resulted from a player's shot assists, including set pieces.*\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#e4c000', fontWeight: 'bold'}}>OP (Open Play) Shot-Creating Action</span>&nbsp;\r\n                                Excluding set pieces, one of the last two offensive actions that directly\r\n                                led to a shot; such as a pass, dribble or a drawn foul.\r\n                                (Note: A single player can receive credit for multiple actions and the shot-taker can also receive credit)\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#e4c000', fontWeight: 'bold'}}>Pass into Box</span>&nbsp;\r\n                                A completed pass that entered the opposition's penalty area, excluding set pieces.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#e4c000', fontWeight: 'bold'}}>Pass into Final 1/3</span>&nbsp;\r\n                                A completed pass that entered the third of the pitch that is closest to the opposition's goal, excluding set pieces.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#e4c000', fontWeight: 'bold'}}>Yards Progressed</span>&nbsp;\r\n                                Distance, in yards, that the ball was moved towards the oppositions's goal\r\n                                with passes and carries.\r\n                                (Note: Passes and carries away from the oppositions's goal are counted as zero progressive yards)\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#e4c000', fontWeight: 'bold'}}>Pass Completion %</span>&nbsp;\r\n                                The percentage of attempted passes that successfully found a teammate.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#e4c000', fontWeight: 'bold'}}>Long Pass Completion %</span>&nbsp;\r\n                                The percentage of attempted passes of 25 yards or more that successfully found a teammate.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#e4c000', fontWeight: 'bold'}}>Launched Pass Completion %</span>&nbsp;\r\n                                The percentage of attempted passes of 40 yards or more that successfully found a teammate, including goal kicks.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#87e179', fontWeight: 'bold'}}>Successful Dribble</span>&nbsp;\r\n                                A successful attempt at taking on a player and making it past them whilst retaining possession.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#87e179', fontWeight: 'bold'}}>Dribble Success %</span>&nbsp;\r\n                                The percentage of attempted dribbles that were successful.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#87e179', fontWeight: 'bold'}}>Turnover</span>&nbsp;\r\n                                A miscontrol, or being tackled by an opponent and losing possession of the ball without attempting a dribble.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#7db9f0', fontWeight: 'bold'}}>pAdj</span>&nbsp;\r\n                                Possession Adjusted (using the StatsBomb sigmoid function).**\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#7db9f0', fontWeight: 'bold'}}>Successful Pressure</span>&nbsp;\r\n                                A pressing action that led to the team regaining possession within the next 5 seconds.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#7db9f0', fontWeight: 'bold'}}>Interception</span>&nbsp;\r\n                                A prevention of an opponent's pass from reaching another opponent by moving into the line of the pass.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#7db9f0', fontWeight: 'bold'}}>Successful Tackle</span>&nbsp;\r\n                                A successful dispossession of an opponent (whether the tackler's team won possession of the ball or not).\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#7db9f0', fontWeight: 'bold'}}>Tackle/Dribbled Past %</span>&nbsp;\r\n                                The percentage of dribblers faced that were tackled.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#7db9f0', fontWeight: 'bold'}}>Aerial Win</span>&nbsp;\r\n                                Winning the ball in a duel that was challenged in the air.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#7db9f0', fontWeight: 'bold'}}>Aerial Win %</span>&nbsp;\r\n                                The percentage of aerials duels contested that were won.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#7db9f0', fontWeight: 'bold'}}>Clearance</span>&nbsp;\r\n                                An action where a player kicked/headed the ball away from their own goal.\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#787ccd', fontWeight: 'bold'}}>GSAA (Goals Saved Above Average) %</span>&nbsp;\r\n                                (Post-Shot xG  Goals Conceded (excluding own goals))  Shots on Target Faced.***\r\n                            </li>\r\n                            <li>\r\n                                <span style={{color: '#787ccd', fontWeight: 'bold'}}>Cross Stopping %</span>&nbsp;\r\n                                The percentage of attempted crosses into the penalty area that were stopped by the goalkeeper.\r\n                            </li>\r\n                        </ul>\r\n                        <div id=\"glossary-links\">\r\n                                <span>\r\n                                    * <a href=\"https://fbref.com/en/expected-goals-model-explained/\" target=\"_blank\" rel=\"noopener noreferrer\">Expected goals/assists model explanation</a>\r\n                                </span>\r\n                            <span>\r\n                                    ** <a href=\"https://statsbomb.com/2014/06/introducing-possession-adjusted-player-stats/\" target=\"_blank\" rel=\"noopener noreferrer\">Possession adjustment explanation</a>\r\n                                </span>\r\n                            <span>\r\n                                    *** <a href=\"https://statsbomb.com/2018/12/introducing-goalkeeper-radars/\" target=\"_blank\" rel=\"noopener noreferrer\">GSAA % explanation</a>\r\n                                </span>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n        );\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default (ExplanationOverlay);\r\n","import React, {Component} from 'react';\r\nimport withRouter from \"react-router-dom/es/withRouter\";\r\nimport {\r\n    withQueryParams,\r\n    JsonParam,\r\n} from 'use-query-params';\r\n\r\nimport Cookies from 'universal-cookie';\r\n\r\n//import lodash functions\r\nimport set from 'lodash.set';\r\nimport isEqual from 'lodash.isequal';\r\n\r\n//import custom components\r\nimport SearchBar from \"../components/SearchBar\";\r\nimport LoadingSpinner from \"../components/LoadingSpinner\";\r\nimport LoaderOverlay from \"../components/LoaderOverlay\";\r\nimport ExplanationOverlay from \"../components/ExplanationOverlay\";\r\nimport PlayerSearchResult from \"../components/PlayerSearchResult\";\r\n\r\n//import pre-made components\r\nimport Collapsible from 'react-collapsible';\r\nimport {Select, Slider, Tooltip} from 'antd';\r\nimport DataTable, { createTheme } from 'react-data-table-component';\r\n\r\n//import utility functions, constants\r\nimport {\r\n    getLeaguesDisplay,\r\n    getAllEntriesFromObject\r\n} from \"../utilities/SearchResultUtilities\"\r\nimport { ordinalSuffix } from \"../utilities/SliceUtilities\"\r\nimport dateFormat from \"dateformat\";\r\n\r\n//initialize constants\r\nconst Option = Select.Option;\r\nconst cookies = new Cookies();\r\n\r\nconst _ = require('lodash');\r\n\r\n\r\n/**\r\n * Advanced Search page component\r\n */\r\nclass AdvancedSearch extends Component {\r\n\r\n    //class variable to track if the component is mounted\r\n    _isMounted = false;\r\n\r\n    _firstSearchMade = false;\r\n    _referenceData = {};\r\n    _statsReferenceDataArraySorted = [];\r\n    _parametersOriginalState = {};\r\n\r\n    _baseColumns = [\r\n        {\r\n            name: 'Name',\r\n            selector: 'name',\r\n            style: {\r\n                fontSize: this.props.isMobile ? '3em' : '1.15em',\r\n                fontWeight: 'bold',\r\n                color: '#e75453'\r\n            },\r\n            minWidth: '250px',\r\n            sortable: true,\r\n            sortFunction: (rowA, rowB) =>\r\n                (rowA.name.normalize(\"NFD\")\r\n                    .replace(/[\\u0300-\\u036f]/g, \"\")\r\n                    .replace(\"\", \"O\")\r\n                    .replace(\"\", \"o\"))\r\n                    .localeCompare((rowB.name.normalize(\"NFD\")\r\n                        .replace(/[\\u0300-\\u036f]/g, \"\")\r\n                        .replace(\"\", \"O\")\r\n                        .replace(\"\", \"o\")))\r\n            ,\r\n            ignoreRowClick: true,\r\n            cell: row => {\r\n                return (\r\n                    <a\r\n                        className=\"table-link\"\r\n                        href={'/stats/' + row.code}\r\n                    >\r\n                        {row.name}\r\n                    </a>\r\n                );\r\n            }\r\n        },\r\n        {\r\n            name: 'Current Age',\r\n            selector: 'age',\r\n            sortable: true,\r\n            ignoreRowClick: true\r\n        },\r\n        {\r\n            name: 'Nationality',\r\n            selector: 'nationalities',\r\n            sortable: true,\r\n            ignoreRowClick: true\r\n        },\r\n        {\r\n            name: 'League(s)',\r\n            selector: 'leagues',\r\n            sortable: true,\r\n            ignoreRowClick: true\r\n        },\r\n        {\r\n            name: 'Club(s)',\r\n            selector: 'clubs',\r\n            sortable: true,\r\n            ignoreRowClick: true\r\n        },\r\n        {\r\n            name: 'Position(s)',\r\n            selector: 'positions',\r\n            sortable: true,\r\n            ignoreRowClick: true\r\n        }\r\n    ];\r\n\r\n    _customStyles = {\r\n        headCells: {\r\n            style: {\r\n                fontSize: '1em',\r\n                fontWeight: 'bold',\r\n                color: '#000000'\r\n            },\r\n        },\r\n    };\r\n\r\n    /**\r\n     * Constructor\r\n     * @param props\r\n     */\r\n    constructor(props){\r\n\r\n        super(props);\r\n\r\n        this.ordinalSuffix = ordinalSuffix.bind(this);\r\n\r\n        this.isMobile = this.props.isMobile;\r\n\r\n        let seasons = {\r\n            \"18-19\": \"18/19\",\r\n            \"19-20\": \"19/20\",\r\n            \"20-21\": \"20/21\"\r\n        };\r\n        let seasonOptions = [];\r\n\r\n        for (let season in seasons){\r\n            seasonOptions.push(\r\n                <Option\r\n                    key={season}\r\n                    value={season}\r\n                >\r\n                    {seasons[season]}\r\n                </Option>\r\n            )\r\n        }\r\n\r\n        let positions = {\r\n            \"FW\": \"Forward\",\r\n            \"AM\": \"Attacking Midfielder / Winger\",\r\n            \"CM\": \"Central / Defensive Midfielder\",\r\n            \"FB\": \"Full-back\",\r\n            \"CB\": \"Center-back\",\r\n            \"GK\": \"Goalkeeper\"\r\n        };\r\n        let positionsOptions = [];\r\n\r\n        for (let position in positions){\r\n            positionsOptions.push(\r\n                <Option\r\n                    key={position}\r\n                    value={position}\r\n                >\r\n                    {positions[position]}\r\n                </Option>\r\n            )\r\n        }\r\n\r\n        let leagues = {\r\n            \"_england\": \"Premier League\",\r\n            \"es\": \"La Liga\",\r\n            \"it\": \"Serie A\",\r\n            \"de\": \"Bundesliga\",\r\n            \"fr\": \"Ligue 1\"\r\n        };\r\n        let leaguesOptions = [];\r\n\r\n        for (let league in leagues){\r\n            leaguesOptions.push(\r\n                <Option\r\n                    key={league}\r\n                    value={league}\r\n                >\r\n                    {leagues[league]}\r\n                </Option>\r\n            )\r\n        }\r\n\r\n        let displayTypeCookie = cookies.get('displayType');\r\n\r\n        this.state = {\r\n\r\n            isLoading: true,\r\n            error: null,\r\n            showSearchLoaderOverlay: false,\r\n            showExplanationOverlay: false,\r\n\r\n            displayType: this.isMobile ? \"cards\" : displayTypeCookie || \"cards\",\r\n\r\n            filterOptions: {\r\n                seasons: seasonOptions,\r\n                ages: {},\r\n                nationalities: [],\r\n                leagues: leaguesOptions,\r\n                clubs: [],\r\n                positions: positionsOptions,\r\n                aggregateStats: [],\r\n                averageStats: [],\r\n                percentileRanks: []\r\n            },\r\n\r\n            parameters: {\r\n                season: \"20-21\",\r\n                includeEuropeanCompetitions: true,\r\n                ages: {},\r\n                nationalities: [],\r\n                leagues: [],\r\n                clubs: [],\r\n                positions: [],\r\n                aggregateStats: {},\r\n                averageStats: {},\r\n                percentileRanks: {}\r\n            },\r\n\r\n            tableColumns: _.cloneDeep(this._baseColumns),\r\n\r\n            searchResults: [],\r\n\r\n            searchResultsDisplay: null\r\n\r\n        };\r\n\r\n        createTheme('basic', {\r\n            background: {\r\n                default: '#fafbfc',\r\n            },\r\n            striped: {\r\n                default: '#f3f4f5',\r\n            }\r\n        });\r\n\r\n        this.getReferenceData();\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * Called after component has mounted\r\n     */\r\n    componentDidMount() {\r\n        this._isMounted = true;\r\n    }\r\n\r\n\r\n    /**\r\n     * Function to send a get request to the server to retrieve the reference data used to populate the select lists\r\n     */\r\n    getReferenceData = () => {\r\n\r\n        //retrieve search results\r\n        fetch('/api/referenceData', {\r\n            method: 'post',\r\n            headers: {\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n        })\r\n        .then(res => {\r\n            if (res.ok) {\r\n                return res.json()\r\n            }\r\n            else {\r\n                throw new Error(\"Failed to fetch reference data. Please refresh the page and try again.\")\r\n            }\r\n        })\r\n        .then(referenceData => this.processReferenceData(referenceData))\r\n        .catch(error => {\r\n            if (this._isMounted){\r\n                this.setState({error, isLoading: false})\r\n            }\r\n        });\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Function to process the reference data and save to state\r\n     * @param {Object} referenceData - object containing reference data\r\n     */\r\n    processReferenceData = (referenceData) => {\r\n\r\n        this._referenceData = referenceData;\r\n\r\n        let statsReferenceDataArray = [];\r\n        for (let stat in referenceData.statsReferenceData){\r\n            let temp = referenceData.statsReferenceData[stat];\r\n            temp.stat = stat;\r\n            statsReferenceDataArray.push(temp);\r\n        }\r\n\r\n        statsReferenceDataArray.sort((a, b) => a.displayOrder - b.displayOrder);\r\n\r\n        this._statsReferenceDataArraySorted = statsReferenceDataArray;\r\n\r\n        let filterOptions = this.state.filterOptions;\r\n        let parameters = this.state.parameters;\r\n        let queryParameters = this.props.query.parameters;\r\n\r\n        let ageReferenceData = referenceData.statsReferenceData[\"age\"];\r\n\r\n        filterOptions.ages = {\r\n            min: ageReferenceData.ranges.min,\r\n            max: ageReferenceData.ranges.max\r\n        };\r\n\r\n        parameters.ages = JSON.parse(JSON.stringify(filterOptions.ages));\r\n\r\n        let season = parameters.season;\r\n        let minutesReferenceData = referenceData.statsReferenceData[\"minutes\"];\r\n\r\n        parameters.aggregateStats.minutes = {\r\n            min: minutesReferenceData.ranges_agg[season].min,\r\n            max: minutesReferenceData.ranges_agg[season].max,\r\n        };\r\n\r\n        this._parametersOriginalState = JSON.parse(JSON.stringify(this.state.parameters));\r\n\r\n        if (queryParameters !== undefined){\r\n            parameters = JSON.parse(JSON.stringify(queryParameters));\r\n        }\r\n\r\n        let nationalitiesOptions = [];\r\n        for (let i=0; i<referenceData.countries.length; i++){\r\n\r\n            let country = referenceData.countries[i];\r\n\r\n            nationalitiesOptions.push(\r\n                <Option\r\n                    key={country.code.toLowerCase()}\r\n                    value={country.code.toLowerCase()}\r\n                >\r\n                    {country.name}\r\n                </Option>\r\n            )\r\n\r\n        }\r\n        filterOptions.nationalities = nationalitiesOptions;\r\n\r\n        let clubsOptions = [];\r\n        for (let i=0; i<referenceData.clubs.length; i++){\r\n\r\n            let club = referenceData.clubs[i];\r\n\r\n            clubsOptions.push(\r\n                <Option\r\n                    key={club.name}\r\n                    value={club.name}\r\n                >\r\n                    {club.name}\r\n                </Option>\r\n            )\r\n\r\n        }\r\n        filterOptions.clubs = clubsOptions;\r\n\r\n        let aggregateStatsOptions = [];\r\n        for (let i=0; i<statsReferenceDataArray.length; i++){\r\n\r\n            let statData = statsReferenceDataArray[i];\r\n            let stat = statData.stat;\r\n\r\n            if (!statData.types.includes(\"aggregate\") || stat === \"minutes\"){\r\n                continue;\r\n            }\r\n\r\n            aggregateStatsOptions.push(\r\n                <Option\r\n                    key={stat}\r\n                    value={stat}\r\n                >\r\n                    {`${statData.label}`}\r\n                </Option>\r\n            )\r\n\r\n        }\r\n        filterOptions.aggregateStats = aggregateStatsOptions;\r\n\r\n        let averageStatsOptions = [];\r\n        for (let i=0; i<statsReferenceDataArray.length; i++){\r\n\r\n            let statData = statsReferenceDataArray[i];\r\n            let stat = statData.stat;\r\n\r\n            if (!statData.types.includes(\"average\")){\r\n                continue;\r\n            }\r\n\r\n            averageStatsOptions.push(\r\n                <Option\r\n                    key={stat}\r\n                    value={stat}\r\n                >\r\n                    {`${statData.label} ${statData.suffix}`}\r\n                </Option>\r\n            )\r\n\r\n        }\r\n        filterOptions.averageStats = averageStatsOptions;\r\n\r\n        if (this._isMounted){\r\n\r\n            this.setState({\r\n                parameters: parameters,\r\n                filterOptions: filterOptions\r\n            });\r\n\r\n            if (parameters.positions.length === 1){\r\n                this.buildPercentileRankSelectList();\r\n            }\r\n\r\n            if (parameters.leagues.length > 0){\r\n                this.buildClubsSelectList();\r\n            }\r\n\r\n            let handleQueryParameters = queryParameters !== undefined && !isEqual(queryParameters, this._parametersOriginalState);\r\n\r\n            this.setState({\r\n                error: null,\r\n                isLoading: handleQueryParameters,\r\n            });\r\n\r\n            document.title = 'Advanced Search | Football Slices';\r\n\r\n            this.props.recordPageViewGA(window.location.pathname);\r\n\r\n            if (handleQueryParameters){\r\n                this.getSearchResults(true);\r\n            }\r\n\r\n        }\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Function to send a post request to the server to retrieve the search results matching the query\r\n     */\r\n    getSearchResults = (fromQueryString = false) => {\r\n\r\n        this.setState({\r\n            showSearchLoaderOverlay: fromQueryString !== true,\r\n        });\r\n\r\n        //clear deep clone of parameters and clean it\r\n        let parameters = JSON.parse(JSON.stringify(this.state.parameters));\r\n\r\n        //delete percentile ranks parameters if not exactly 1 position is selected\r\n        if (parameters.positions.length !== 1){\r\n\r\n            for (let stat in parameters.percentileRanks){\r\n                delete parameters.percentileRanks[stat];\r\n            }\r\n\r\n        }\r\n\r\n        let season = parameters.season;\r\n\r\n        //because range slider min/max values are not true min/maxes, we set the min/max to -infinity/infinity\r\n        //if the slider is at the max allowed value\r\n        for (let stat in parameters.averageStats){\r\n\r\n            let statRanges = this._referenceData.statsReferenceData[stat].ranges[season];\r\n\r\n            if (parameters.averageStats[stat].min === statRanges.min){\r\n                parameters.averageStats[stat].min = null\r\n            }\r\n\r\n            if (parameters.averageStats[stat].max === statRanges.max){\r\n                parameters.averageStats[stat].max = null\r\n            }\r\n\r\n        }\r\n\r\n        //retrieve search results\r\n        fetch('/api/advancedSearch', {\r\n            method: 'post',\r\n            headers: {\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            body: JSON.stringify({\r\n                \"parameters\": parameters\r\n            })\r\n        })\r\n        .then(res => {\r\n            if (res.ok) {\r\n                return res.json()\r\n            }\r\n            else {\r\n               throw new Error(\"Failed to fetch search results. Please refresh the page and try again.\")\r\n            }\r\n        })\r\n        .then(searchResults => {\r\n            this._firstSearchMade = true;\r\n            this.processSearchResults(searchResults)\r\n        })\r\n        .catch(error => {\r\n            if (this._isMounted){\r\n                this.setState({error})\r\n            }\r\n        });\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Function to process the search results and save to state\r\n     * @param {Object} searchResults - object containing search results\r\n     * parameters\r\n     */\r\n    processSearchResults = (searchResults) => {\r\n\r\n        let parameters = this.state.parameters;\r\n        let displayType = this.state.displayType;\r\n\r\n        let tableColumns;\r\n\r\n        if (displayType === \"table\"){\r\n\r\n            tableColumns = _.cloneDeep(this._baseColumns);\r\n\r\n            for (let stat in parameters.aggregateStats){\r\n\r\n                let statData = this._referenceData.statsReferenceData[stat];\r\n\r\n                tableColumns.push({\r\n                    name: `${statData.label}`,\r\n                    selector: `aggregate_${stat}`,\r\n                    sortable: true,\r\n                    ignoreRowClick: true,\r\n                    format: row => parseFloat(row[`aggregate_${stat}`])\r\n                })\r\n            }\r\n\r\n            for (let stat in parameters.averageStats){\r\n\r\n                let statData = this._referenceData.statsReferenceData[stat];\r\n\r\n                tableColumns.push({\r\n                    name: `${statData.label} ${statData.suffix}`,\r\n                    selector: `raw_${stat}`,\r\n                    sortable: true,\r\n                    ignoreRowClick: true,\r\n                    format: row => parseFloat(row[`raw_${stat}`])\r\n                })\r\n            }\r\n\r\n            if (parameters.positions.length === 1){\r\n                for (let stat in parameters.percentileRanks){\r\n\r\n                    let statData = this._referenceData.statsReferenceData[stat];\r\n\r\n                    tableColumns.push({\r\n                        name: `${statData.label} ${statData.suffix} (Percentile Rank)`,\r\n                        selector: `percentile_${stat}`,\r\n                        sortable: true,\r\n                        ignoreRowClick: true,\r\n                        sortFunction: (rowA, rowB) => { return parseFloat(rowA[`percentile_${stat}`]) - parseFloat(rowB[`percentile_${stat}`]) },\r\n                        format: row => this.ordinalSuffix(row[`percentile_${stat}`]) + \" percentile\"\r\n                    })\r\n                }\r\n            }\r\n\r\n        }\r\n\r\n        if (this._isMounted){\r\n\r\n            this.setState({\r\n                searchResults: [],\r\n                searchResultsDisplay: null\r\n            }, () => {\r\n                this.setState({\r\n                    error: null,\r\n                    isLoading: false,\r\n                    showSearchLoaderOverlay: false,\r\n                    tableColumns: tableColumns,\r\n                    searchResults: searchResults\r\n                }, () => {\r\n                    this.buildSearchResultsDisplay();\r\n                });\r\n            });\r\n\r\n        }\r\n\r\n    };\r\n\r\n\r\n    toggleExplanationOverlay = () => {\r\n\r\n        let currentState = this.state.showExplanationOverlay;\r\n\r\n        this.setState({\r\n            showExplanationOverlay: !currentState\r\n        });\r\n\r\n    };\r\n\r\n\r\n    handleTableButtonClick = () => {\r\n\r\n        this.setState({\r\n            displayType: \"table\"\r\n        }, () => {\r\n            this.processSearchResults(this.state.searchResults);\r\n        });\r\n\r\n        cookies.set('displayType', \"table\", {path: '/'});\r\n\r\n    };\r\n\r\n\r\n    handleCardsButtonClick = () => {\r\n\r\n        this.setState({\r\n            displayType: \"cards\"\r\n        }, () => {\r\n            this.processSearchResults(this.state.searchResults);\r\n        });\r\n\r\n        cookies.set('displayType', \"cards\", {path: '/'});\r\n\r\n    };\r\n\r\n\r\n    buildSearchResultsDisplay = () => {\r\n\r\n        let season = this.state.parameters.season;\r\n        let searchResults = this.state.searchResults;\r\n\r\n        let displayType = this.state.displayType;\r\n        let tableColumns = this.state.tableColumns;\r\n\r\n        let searchResultsDisplay;\r\n\r\n        if (displayType === \"cards\"){\r\n\r\n            let playerCards = [];\r\n\r\n            for (let i=0; i<searchResults.length; i++){\r\n\r\n                let current = searchResults[i];\r\n\r\n                playerCards.push(\r\n                    <PlayerSearchResult\r\n                        isMobile={this.isMobile}\r\n                        page=\"search\"\r\n                        code={current.code}\r\n                        name={current.name}\r\n                        age={current.age}\r\n                        season={season}\r\n                        clubs={current.clubs}\r\n                        nationalities={current.nationalities}\r\n                        countryCodes={current.countryCodes}\r\n                        positions={current.positions}\r\n                        key={i}\r\n                    />\r\n                );\r\n\r\n            }\r\n\r\n            searchResultsDisplay =\r\n                <div id=\"player-search-results\">\r\n                    {playerCards}\r\n                </div>;\r\n\r\n        }\r\n        else if (displayType === \"table\"){\r\n\r\n            let tableRows = [];\r\n\r\n            for (let i=0; i<searchResults.length; i++){\r\n\r\n                let current = searchResults[i];\r\n                let row = {};\r\n\r\n                for (let key in current){\r\n\r\n                    if (Array.isArray(current[key])){\r\n                        row[key] = current[key].join(\", \");\r\n                    }\r\n                    else if (typeof current[key] === 'object'){\r\n\r\n                        if (season !== null){\r\n\r\n                            if (key === \"leagues\"){\r\n                                row[key] = getLeaguesDisplay(current[key][season])\r\n                            }\r\n                            else {\r\n                                row[key] = current[key][season].join(\", \");\r\n                                if (row[key] === \"N/A\"){\r\n                                    row[key] = \"-\";\r\n                                }\r\n                            }\r\n\r\n                        }\r\n\r\n                        else {\r\n                            row[key] = getAllEntriesFromObject(current[key]).join(\", \");\r\n                        }\r\n\r\n                    }\r\n                    else {\r\n                        row[key] = current[key];\r\n                    }\r\n\r\n                }\r\n\r\n                tableRows.push(row);\r\n\r\n            }\r\n\r\n            if (tableRows.length > 0){\r\n\r\n                searchResultsDisplay =\r\n                    <div id=\"player-search-results-table\">\r\n                        <DataTable\r\n                            title={\"\"}\r\n                            columns={tableColumns}\r\n                            data={tableRows}\r\n                            theme={\"basic\"}\r\n                            customStyles={this._customStyles}\r\n                            striped={false}\r\n                            //highlightOnHover={true}\r\n                            //pointerOnHover={true}\r\n                            pagination={true}\r\n                            paginationPerPage={30}\r\n                            fixedHeader={true} //causes mis-aligned header bug by adding permanent scrollbar\r\n                            allowOverflow={true}\r\n                            overflowY={true}\r\n                            overflowX={true}\r\n                            defaultSortAsc={false}\r\n                        />\r\n                    </div>;\r\n\r\n            }\r\n\r\n        }\r\n\r\n        this.setState({\r\n            searchResultsDisplay: searchResultsDisplay\r\n        })\r\n\r\n    };\r\n\r\n\r\n    handleSingleSelectChange = (key, value) => {\r\n\r\n        let parameters = this.state.parameters;\r\n\r\n        let oldValue = parameters[key];\r\n\r\n        parameters[key] = value;\r\n\r\n        //changing the season changes the min/max values on the sliders so we update accordingly\r\n        if (key === \"season\"){\r\n\r\n            let season = parameters.season;\r\n\r\n            //if current max/min is greater/less than new max/min\r\n            //or if current max/min is equal to slider max/min\r\n            //update raw stat slider\r\n            for (let stat in parameters.averageStats){\r\n\r\n                let statData = this._referenceData.statsReferenceData[stat];\r\n\r\n                if (\r\n                    parameters.averageStats[stat].max > statData.ranges[season].max ||\r\n                    parameters.averageStats[stat].max === statData.ranges[oldValue].max\r\n                ){\r\n                    parameters.averageStats[stat].max = statData.ranges[season].max;\r\n                }\r\n\r\n                if (parameters.averageStats[stat].min < statData.ranges[season].min ||\r\n                    parameters.averageStats[stat].min === statData.ranges[oldValue].min\r\n                ){\r\n                    parameters.averageStats[stat].min = statData.ranges[season].min;\r\n                }\r\n\r\n            }\r\n\r\n            //same as above but for aggregate stats\r\n            for (let stat in parameters.aggregateStats){\r\n\r\n                let statData = this._referenceData.statsReferenceData[stat];\r\n\r\n                if (\r\n                    parameters.aggregateStats[stat].max > statData.ranges_agg[season].max ||\r\n                    parameters.aggregateStats[stat].max === statData.ranges_agg[oldValue].max\r\n                ){\r\n                    parameters.aggregateStats[stat].max = statData.ranges_agg[season].max;\r\n                }\r\n\r\n                if (parameters.aggregateStats[stat].min < statData.ranges_agg[season].min ||\r\n                    parameters.aggregateStats[stat].min === statData.ranges_agg[oldValue].min\r\n                ){\r\n                    parameters.aggregateStats[stat].min = statData.ranges_agg[season].min;\r\n                }\r\n\r\n            }\r\n\r\n        }\r\n\r\n        this.setState({\r\n            parameters: parameters\r\n        });\r\n\r\n        this.props.setQuery({\r\n            parameters: parameters\r\n        }, 'replaceIn');\r\n\r\n        if (key === \"season\" && this._firstSearchMade && this.state.searchResults.length > 0){\r\n            this.getSearchResults();\r\n        }\r\n\r\n    };\r\n\r\n\r\n    handleIncludeEuropeanCompetitionsClick = () => {\r\n\r\n        let parameters = this.state.parameters;\r\n\r\n        parameters.includeEuropeanCompetitions = !parameters.includeEuropeanCompetitions;\r\n\r\n        this.setState({\r\n            parameters: parameters\r\n        });\r\n\r\n        this.props.setQuery({\r\n            parameters: parameters\r\n        }, 'replaceIn');\r\n\r\n        if (this._firstSearchMade && this.state.searchResults.length > 0){\r\n            this.getSearchResults();\r\n        }\r\n\r\n    };\r\n\r\n\r\n    handleRangeSliderChange = (key, values) => {\r\n\r\n        let parameters = this.state.parameters;\r\n\r\n        set(parameters, `${key}.min`, values[0]);\r\n        set(parameters, `${key}.max`, values[1]);\r\n\r\n        this.setState({\r\n            parameters: parameters\r\n        });\r\n\r\n        this.props.setQuery({\r\n            parameters: parameters\r\n        }, 'replaceIn');\r\n\r\n    };\r\n\r\n\r\n    handleSelectListAdd = (key, value) => {\r\n\r\n        let parameters = this.state.parameters;\r\n\r\n        parameters[`${key}`].push(value);\r\n\r\n        this.setState({\r\n            parameters: parameters\r\n        });\r\n\r\n        this.props.setQuery({\r\n            parameters: parameters\r\n        }, 'replaceIn');\r\n\r\n        if (key === \"positions\"){\r\n            this.buildPercentileRankSelectList();\r\n        }\r\n        else if (key === \"leagues\"){\r\n            this.buildClubsSelectList();\r\n        }\r\n\r\n    };\r\n\r\n\r\n    handleSelectListRemove = (key, value) => {\r\n\r\n        let parameters = this.state.parameters;\r\n\r\n        let index = parameters[`${key}`].indexOf(value);\r\n        if (index > -1) {\r\n            parameters[`${key}`].splice(index, 1);\r\n        }\r\n\r\n        this.setState({\r\n            parameters: parameters\r\n        });\r\n\r\n        this.props.setQuery({\r\n            parameters: parameters\r\n        }, 'replaceIn');\r\n\r\n        if (key === \"positions\"){\r\n            this.buildPercentileRankSelectList()\r\n        }\r\n        else if (key === \"leagues\"){\r\n            this.buildClubsSelectList();\r\n        }\r\n\r\n    };\r\n\r\n\r\n    handleSelectListClear = (key) => {\r\n\r\n        let parameters = this.state.parameters;\r\n\r\n        parameters[key] = [];\r\n\r\n        this.setState({\r\n            parameters: parameters\r\n        });\r\n\r\n        this.props.setQuery({\r\n            parameters: parameters\r\n        }, 'replaceIn');\r\n\r\n        if (key === \"positions\"){\r\n            this.buildPercentileRankSelectList()\r\n        }\r\n        else if (key === \"leagues\"){\r\n            this.buildClubsSelectList();\r\n        }\r\n\r\n    };\r\n\r\n\r\n    buildPercentileRankSelectList = () => {\r\n\r\n        let filterOptions = this.state.filterOptions;\r\n        let parameters = this.state.parameters;\r\n\r\n        if (parameters.positions.length !== 1){\r\n\r\n            filterOptions.percentileRanks = [];\r\n\r\n            this.setState({\r\n                filterOptions: filterOptions\r\n            });\r\n\r\n        }\r\n        else {\r\n\r\n            let percentileRankOptions = [];\r\n\r\n            let position = parameters.positions[0];\r\n\r\n            for (let i=0; i<this._statsReferenceDataArraySorted.length; i++){\r\n\r\n                let stat = this._statsReferenceDataArraySorted[i].stat;\r\n\r\n                let statData = this._referenceData.statsReferenceData[stat];\r\n\r\n                if (!this._referenceData.statsByPosition[position].includes(stat)){\r\n\r\n                    if (parameters.percentileRanks.hasOwnProperty(stat)){\r\n                        delete parameters.percentileRanks[stat];\r\n                    }\r\n\r\n                    continue;\r\n                }\r\n\r\n                percentileRankOptions.push(\r\n                    <Option\r\n                        key={stat}\r\n                        value={stat}\r\n                    >\r\n                        {`${statData.label} ${statData.suffix}`}\r\n                    </Option>\r\n                )\r\n\r\n            }\r\n\r\n            filterOptions.percentileRanks = percentileRankOptions;\r\n\r\n            this.setState({\r\n                filterOptions: filterOptions,\r\n                parameters: parameters\r\n            });\r\n\r\n            this.props.setQuery({\r\n                parameters: parameters\r\n            }, 'replaceIn');\r\n\r\n        }\r\n\r\n    };\r\n\r\n\r\n    buildClubsSelectList = () => {\r\n\r\n        let parameters = this.state.parameters;\r\n        let filterOptions = this.state.filterOptions;\r\n\r\n        let selectedLeagues = parameters.leagues;\r\n\r\n        let clubsReferenceData = this._referenceData.clubs;\r\n\r\n        let eligibleClubs;\r\n\r\n        if (selectedLeagues.length === 0){\r\n            eligibleClubs = clubsReferenceData\r\n                .map(x => x.name);\r\n        }\r\n        else {\r\n            eligibleClubs = clubsReferenceData\r\n                .filter(x => selectedLeagues.includes(x.countryCode))\r\n                .map(x => x.name);\r\n        }\r\n\r\n        let clubsOptions = [];\r\n        for (let i=0; i<clubsReferenceData.length; i++){\r\n\r\n            let club = clubsReferenceData[i];\r\n\r\n            if (!eligibleClubs.includes(club.name)){\r\n                continue;\r\n            }\r\n\r\n            clubsOptions.push(\r\n                <Option\r\n                    key={club.name}\r\n                    value={club.name}\r\n                >\r\n                    {club.name}\r\n                </Option>\r\n            )\r\n\r\n        }\r\n        filterOptions.clubs = clubsOptions;\r\n\r\n        parameters.clubs = parameters.clubs.filter(x => eligibleClubs.includes(x));\r\n\r\n        this.setState({\r\n            filterOptions: filterOptions,\r\n            parameters: parameters\r\n        });\r\n\r\n        this.props.setQuery({\r\n            parameters: parameters\r\n        }, 'replaceIn');\r\n\r\n    };\r\n\r\n\r\n    handleLookupStatSelectListAdd = (parametersKey, stat) => {\r\n\r\n        let parameters = this.state.parameters;\r\n\r\n        let season = parameters.season;\r\n        let referenceData = this._referenceData.statsReferenceData[stat];\r\n\r\n        let rangesKey = parametersKey === \"averageStats\" ? \"ranges\" : \"ranges_agg\";\r\n\r\n        let min = parametersKey === \"percentileRanks\" ? 0 : referenceData[rangesKey][season].min;\r\n        let max = parametersKey === \"percentileRanks\" ? 100 : referenceData[rangesKey][season].max;\r\n\r\n        parameters[`${parametersKey}`][stat] = {\r\n            min: min,\r\n            max: max,\r\n        };\r\n\r\n        this.setState({\r\n            parameters: parameters\r\n        });\r\n\r\n        this.props.setQuery({\r\n            parameters: parameters\r\n        }, 'replaceIn');\r\n\r\n    };\r\n\r\n\r\n    handleLookupStatSelectListRemove = (parametersKey, stat) => {\r\n\r\n        let parameters = this.state.parameters;\r\n\r\n        delete parameters[parametersKey][stat];\r\n\r\n        this.setState({\r\n            parameters: parameters\r\n        });\r\n\r\n        this.props.setQuery({\r\n            parameters: parameters\r\n        }, 'replaceIn');\r\n\r\n    };\r\n\r\n\r\n    handleLookupStatsSelectListClear = (key) => {\r\n\r\n        let parameters = this.state.parameters;\r\n\r\n        for (let stat in parameters[key]){\r\n            if (stat !== \"minutes\"){\r\n                delete parameters[key][stat];\r\n            }\r\n        }\r\n\r\n        this.setState({\r\n            parameters: parameters\r\n        });\r\n\r\n        this.props.setQuery({\r\n            parameters: parameters\r\n        }, 'replaceIn');\r\n\r\n    };\r\n\r\n\r\n    resetParameters = () => {\r\n\r\n        let parametersOriginalState = JSON.parse(JSON.stringify(this._parametersOriginalState));\r\n\r\n        this.setState({\r\n            parameters: parametersOriginalState,\r\n            searchResults: [],\r\n            searchResultsDisplay: null\r\n        }, () => {\r\n\r\n            this._firstSearchMade = false;\r\n\r\n            this.props.setQuery({\r\n                parameters: parametersOriginalState\r\n            }, 'replaceIn');\r\n\r\n            this.buildClubsSelectList();\r\n\r\n        });\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Called just before the component un-mounts\r\n     */\r\n    componentWillUnmount() {\r\n        this._isMounted = false;\r\n    }\r\n\r\n\r\n    tooltipFormatter = (value, min, max) => {\r\n\r\n        if (value === min)\r\n            return \"min\";\r\n\r\n        else if (value === max)\r\n            return \"max\";\r\n\r\n        else\r\n            return value;\r\n\r\n    };\r\n\r\n\r\n\r\n    /**\r\n     * render function\r\n     * @return {*} - JSX code for the search page\r\n     */\r\n    render() {\r\n\r\n        let {\r\n            isLoading,\r\n            error,\r\n            showSearchLoaderOverlay,\r\n            showExplanationOverlay,\r\n            filterOptions,\r\n            parameters,\r\n            searchResults,\r\n            displayType,\r\n            searchResultsDisplay\r\n        } = this.state;\r\n\r\n        //display loading spinner while the server responds to POST request for the reference data\r\n        if (isLoading) {\r\n            return (\r\n                <LoadingSpinner/>\r\n            )\r\n        }\r\n\r\n        //display the error message screen if an error is caught\r\n        else if (error !== null) {\r\n            return (\r\n                <div id=\"main\">\r\n                    <SearchBar\r\n                        isMobile={this.isMobile}\r\n                        page=\"search\"\r\n                        query={this.state.query}\r\n                    />\r\n                    <div className=\"screen\" id=\"error-screen\">\r\n                        <p>{error.message}</p>\r\n                    </div>\r\n                </div>\r\n            )\r\n        }\r\n\r\n        //build search page otherwise\r\n        else {\r\n\r\n            let season = parameters.season;\r\n\r\n            let aggregateStatSliders = [];\r\n            for (let stat in parameters.aggregateStats){\r\n\r\n                if (stat === \"minutes\"){\r\n                    continue;\r\n                }\r\n\r\n                let statData = this._referenceData.statsReferenceData[stat];\r\n\r\n                aggregateStatSliders.push(\r\n                    <h4 key={statData.key}>{`${statData.label}`}</h4>\r\n                );\r\n\r\n                aggregateStatSliders.push(\r\n                    <Slider\r\n                        key={`aggregateStatSlider-${stat}`}\r\n                        range={true}\r\n                        value={[parameters.aggregateStats[stat].min, parameters.aggregateStats[stat].max]}\r\n                        min={statData.ranges_agg[season].min}\r\n                        max={statData.ranges_agg[season].max + 0.0001}\r\n                        step={statData.step_agg}\r\n                        onChange={(values) => this.handleRangeSliderChange(`aggregateStats.${stat}`, values)}\r\n                    />\r\n                );\r\n\r\n            }\r\n\r\n\r\n            let averageStatsSliders = [];\r\n            for (let stat in parameters.averageStats){\r\n\r\n                let statData = this._referenceData.statsReferenceData[stat];\r\n\r\n                averageStatsSliders.push(\r\n                    <h4 key={statData.key}>{`${statData.label} ${statData.suffix}`}</h4>\r\n                );\r\n\r\n                averageStatsSliders.push(\r\n                    <Slider\r\n                        key={`averageStatslider-${stat}`}\r\n                        range={true}\r\n                        value={[parameters.averageStats[stat].min, parameters.averageStats[stat].max]}\r\n                        min={statData.ranges[season].min}\r\n                        max={statData.ranges[season].max + 0.0001}\r\n                        step={statData.step}\r\n                        onChange={(values) => this.handleRangeSliderChange(`averageStats.${stat}`, values)}\r\n                        tipFormatter={value => {return this.tooltipFormatter(value, statData.ranges[season].min, statData.ranges[season].max)}}\r\n                    />\r\n                );\r\n\r\n            }\r\n\r\n            let percentileRanksSliders = [];\r\n            for (let stat in parameters.percentileRanks){\r\n\r\n                let statData = this._referenceData.statsReferenceData[stat];\r\n\r\n                percentileRanksSliders.push(\r\n                    <h4 key={statData.key}>{`${statData.label} ${statData.suffix}`}</h4>\r\n                );\r\n\r\n                percentileRanksSliders.push(\r\n                    <Slider\r\n                        key={`percentileRanksSlider-${stat}`}\r\n                        disabled={parameters.positions.length !== 1}\r\n                        range={true}\r\n                        value={[parameters.percentileRanks[stat].min, parameters.percentileRanks[stat].max]}\r\n                        min={0}\r\n                        max={season === null ? 0 : 100}\r\n                        step={5}\r\n                        onChange={(values) => this.handleRangeSliderChange(`percentileRanks.${stat}`, values)}\r\n                    />\r\n                );\r\n\r\n            }\r\n\r\n            let minutesReferenceData = this._referenceData.statsReferenceData[\"minutes\"];\r\n\r\n            //return JSX code for the search page\r\n            return (\r\n                <div id=\"main\">\r\n                    <LoaderOverlay\r\n                        display={showSearchLoaderOverlay}\r\n                    />\r\n                    <ExplanationOverlay\r\n                        display={showExplanationOverlay}\r\n                        toggleExplanationOverlay={this.toggleExplanationOverlay}\r\n                    />\r\n                    <SearchBar\r\n                        isMobile={this.isMobile}\r\n                        page=\"search\"\r\n                        query={this.state.query}\r\n                    />\r\n                    <div className=\"screen\" id=\"search-screen\">\r\n                        <div className=\"filter\" id=\"advanced-search-filters\">\r\n                            <div className=\"filter-inputs search-filter-inputs\" id=\"advanced-search-filter-inputs\">\r\n                                <button className=\"fas fa-question-circle explanation-button\" onClick={this.toggleExplanationOverlay}/>\r\n                                <h4 style={{'display': this.isMobile ? \"none\" : \"block\"}}>Results Display</h4>\r\n                                <div style={{'display': this.isMobile ? \"none\" : \"block\"}} id=\"display-type-buttons-container\">\r\n                                    <button\r\n                                        className={`fas fa-th display-type-button ${displayType === \"cards\" ? \"selected\" : null}`}\r\n                                        onClick={this.handleCardsButtonClick}\r\n                                    />\r\n                                    \r\n                                    <button\r\n                                        className={`fas fa-table display-type-button ${displayType === \"table\" ? \"selected\" : null}`}\r\n                                        onClick={this.handleTableButtonClick}\r\n                                    />\r\n                                </div>\r\n                                <h4>Season</h4>\r\n                                <Select\r\n                                    value={parameters.season}\r\n                                    placeholder={\"Select a season\"}\r\n                                    style={{ width: '100%' }}\r\n                                    onChange={(val) => this.handleSingleSelectChange(\"season\", val)}\r\n                                >\r\n                                    {filterOptions.seasons}\r\n                                </Select>\r\n                                <label\r\n                                    className={`${parameters.includeEuropeanCompetitions ? \"selected-label\" : null} selectable-label`}\r\n                                    key={'includeEuropeanCompetitionsCheckbox'}\r\n                                >\r\n                                    <input className=\"\"\r\n                                           type=\"checkbox\"\r\n                                           value={\"Include European Competitions\"}\r\n                                           onChange={this.handleIncludeEuropeanCompetitionsClick}\r\n                                           checked={parameters.includeEuropeanCompetitions}\r\n                                    /> <b>Include CL/EL Stats?</b>\r\n                                </label>\r\n                                <Collapsible\r\n                                    open={!this.isMobile}\r\n                                    trigger=\"Metadata\"\r\n                                    className=\"filter-headers\"\r\n                                    transitionTime={200}\r\n                                    transitionCloseTime={200}\r\n                                >\r\n                                    <h4>Current Age</h4>\r\n                                    <Slider\r\n                                        value={[parameters.ages.min, parameters.ages.max]}\r\n                                        range={true}\r\n                                        defaultValue={[filterOptions.ages.min, filterOptions.ages.max]}\r\n                                        min={filterOptions.ages.min}\r\n                                        max={filterOptions.ages.max}\r\n                                        onChange={(values) => this.handleRangeSliderChange(\"ages\", values)}\r\n                                    />\r\n                                    <h4>Minutes</h4>\r\n                                    <Slider\r\n                                        key={`averageStatslider-minutes`}\r\n                                        range={true}\r\n                                        value={[parameters.aggregateStats[\"minutes\"].min, parameters.aggregateStats[\"minutes\"].max]}\r\n                                        min={minutesReferenceData.ranges_agg[season].min}\r\n                                        max={minutesReferenceData.ranges_agg[season].max + 0.0001}\r\n                                        step={minutesReferenceData.step_agg}\r\n                                        onChange={(values) => this.handleRangeSliderChange(`aggregateStats.minutes`, values)}\r\n                                    />\r\n                                    <h4>Nationalities</h4>\r\n                                    <Select\r\n                                        value={parameters.nationalities.map(x => x)}\r\n                                        placeholder={\"Select nationalities\"}\r\n                                        style={{ width: '100%' }}\r\n                                        mode={\"multiple\"}\r\n                                        allowClear={true}\r\n                                        onSelect={(val) => this.handleSelectListAdd(\"nationalities\", val)}\r\n                                        onDeselect={(val) => this.handleSelectListRemove(\"nationalities\", val)}\r\n                                        onClear={() => this.handleSelectListClear(\"nationalities\")}\r\n                                        filterOption={(input, option) =>\r\n                                            option.props.children.toLowerCase().indexOf(input.toLowerCase()) >= 0\r\n                                        }\r\n                                    >\r\n                                        {filterOptions.nationalities}\r\n                                    </Select>\r\n                                    <h4>Leagues</h4>\r\n                                    <Tooltip\r\n                                        title={\"Select a season to use this filter\"}\r\n                                        overlayClassName={parameters.season !== null ? \"hideTooltip\" : null}\r\n                                    >\r\n                                        <Select\r\n                                            value={parameters.leagues.map(x => x)}\r\n                                            placeholder={\"Select leagues\"}\r\n                                            style={{ width: '100%' }}\r\n                                            mode={\"multiple\"}\r\n                                            allowClear={true}\r\n                                            onSelect={(val) => this.handleSelectListAdd(\"leagues\", val)}\r\n                                            onDeselect={(val) => this.handleSelectListRemove(\"leagues\", val)}\r\n                                            onClear={() => this.handleSelectListClear(\"leagues\")}\r\n                                            filterOption={(input, option) =>\r\n                                                option.props.children.toLowerCase().indexOf(input.toLowerCase()) >= 0\r\n                                            }\r\n                                        >\r\n                                            {filterOptions.leagues}\r\n                                        </Select>\r\n                                    </Tooltip>\r\n                                    <h4>Clubs</h4>\r\n                                    <Tooltip\r\n                                        title={\"Select a season to use this filter\"}\r\n                                        overlayClassName={parameters.season !== null ? \"hideTooltip\" : null}\r\n                                    >\r\n                                        <Select\r\n                                            value={parameters.clubs.map(x => x)}\r\n                                            placeholder={\"Select clubs\"}\r\n                                            style={{ width: '100%' }}\r\n                                            disabled={parameters.season === null}\r\n                                            mode={\"multiple\"}\r\n                                            allowClear={true}\r\n                                            onSelect={(val) => this.handleSelectListAdd(\"clubs\", val)}\r\n                                            onDeselect={(val) => this.handleSelectListRemove(\"clubs\", val)}\r\n                                            onClear={() => this.handleSelectListClear(\"clubs\")}\r\n                                            filterOption={(input, option) =>\r\n                                                option.props.children.toLowerCase().indexOf(input.toLowerCase()) >= 0\r\n                                            }\r\n                                        >\r\n                                            {filterOptions.clubs}\r\n                                        </Select>\r\n                                    </Tooltip>\r\n                                    <h4>Positions</h4>\r\n                                    <Tooltip\r\n                                        title={\"Select a season to use this filter\"}\r\n                                        overlayClassName={parameters.season !== null ? \"hideTooltip\" : null}\r\n                                    >\r\n                                        <Select\r\n                                            value={parameters.positions.map(x => x)}\r\n                                            placeholder={\"Select positions\"}\r\n                                            style={{ width: '100%' }}\r\n                                            disabled={parameters.season === null}\r\n                                            mode={\"multiple\"}\r\n                                            allowClear={true}\r\n                                            onSelect={(val) => this.handleSelectListAdd(\"positions\", val)}\r\n                                            onDeselect={(val) => this.handleSelectListRemove(\"positions\", val)}\r\n                                            onClear={() => this.handleSelectListClear(\"positions\")}\r\n                                            filterOption={(input, option) =>\r\n                                                option.props.children.toLowerCase().indexOf(input.toLowerCase()) >= 0\r\n                                            }\r\n                                        >\r\n                                            {filterOptions.positions}\r\n                                        </Select>\r\n                                    </Tooltip>\r\n                                </Collapsible>\r\n                                <Collapsible\r\n                                    open={!this.isMobile}\r\n                                    trigger=\"Totals\"\r\n                                    className=\"filter-headers\"\r\n                                    transitionTime={200}\r\n                                    transitionCloseTime={200}\r\n                                >\r\n                                    <Tooltip\r\n                                        title={\"Select a season to use this filter\"}\r\n                                        overlayClassName={parameters.season !== null ? \"hideTooltip\" : null}\r\n                                    >\r\n                                        <Select\r\n                                            value={Object.keys(parameters.aggregateStats).filter(i => i !== \"minutes\")}\r\n                                            placeholder={\"Select stats to add range sliders\"}\r\n                                            style={{ width: '100%' }}\r\n                                            disabled={parameters.season === null}\r\n                                            mode={\"multiple\"}\r\n                                            allowClear={true}\r\n                                            onSelect={(val) => this.handleLookupStatSelectListAdd(\"aggregateStats\", val)}\r\n                                            onDeselect={(val) => this.handleLookupStatSelectListRemove(\"aggregateStats\", val)}\r\n                                            onClear={() => this.handleLookupStatsSelectListClear(\"aggregateStats\")}\r\n                                            filterOption={(input, option) =>\r\n                                                option.props.children.toLowerCase().indexOf(input.toLowerCase()) >= 0\r\n                                            }\r\n                                        >\r\n                                            {filterOptions.aggregateStats}\r\n                                        </Select>\r\n                                    </Tooltip>\r\n                                    {aggregateStatSliders}\r\n                                </Collapsible>\r\n                                <Collapsible\r\n                                    open={!this.isMobile}\r\n                                    trigger=\"Averages\"\r\n                                    className=\"filter-headers\"\r\n                                    transitionTime={200}\r\n                                    transitionCloseTime={200}\r\n                                >\r\n                                    <Tooltip\r\n                                        title={\"Select a season to use this filter\"}\r\n                                        overlayClassName={parameters.season !== null ? \"hideTooltip\" : null}\r\n                                    >\r\n                                        <Select\r\n                                            value={Object.keys(parameters.averageStats)}\r\n                                            placeholder={\"Select stats to add range sliders\"}\r\n                                            style={{ width: '100%' }}\r\n                                            disabled={parameters.season === null}\r\n                                            mode={\"multiple\"}\r\n                                            allowClear={true}\r\n                                            onSelect={(val) => this.handleLookupStatSelectListAdd(\"averageStats\", val)}\r\n                                            onDeselect={(val) => this.handleLookupStatSelectListRemove(\"averageStats\", val)}\r\n                                            onClear={() => this.handleLookupStatsSelectListClear(\"averageStats\")}\r\n                                            filterOption={(input, option) =>\r\n                                                option.props.children.toLowerCase().indexOf(input.toLowerCase()) >= 0\r\n                                            }\r\n                                        >\r\n                                            {filterOptions.averageStats}\r\n                                        </Select>\r\n                                    </Tooltip>\r\n                                    {averageStatsSliders}\r\n                                </Collapsible>\r\n                                <Collapsible\r\n                                    open={!this.isMobile}\r\n                                    trigger=\"Percentile Ranks\"\r\n                                    className=\"filter-headers\"\r\n                                    transitionTime={200}\r\n                                    transitionCloseTime={200}\r\n                                >\r\n                                    <Tooltip\r\n                                        title={parameters.season === null ? \"Select a season to use this filter\" : \"Select exactly one position to use this filter\"}\r\n                                        overlayClassName={parameters.season !== null && parameters.positions.length === 1 ? \"hideTooltip\" : null}\r\n                                    >\r\n                                        <Select\r\n                                            value={Object.keys(parameters.percentileRanks)}\r\n                                            placeholder={\"Select stats to add range sliders\"}\r\n                                            style={{ width: '100%' }}\r\n                                            disabled={parameters.season === null || parameters.positions.length !== 1}\r\n                                            mode={\"multiple\"}\r\n                                            allowClear={true}\r\n                                            onSelect={(val) => this.handleLookupStatSelectListAdd(\"percentileRanks\", val)}\r\n                                            onDeselect={(val) => this.handleLookupStatSelectListRemove(\"percentileRanks\", val)}\r\n                                            onClear={() => this.handleLookupStatsSelectListClear(\"percentileRanks\")}\r\n                                            filterOption={(input, option) =>\r\n                                                option.props.children.toLowerCase().indexOf(input.toLowerCase()) >= 0\r\n                                            }\r\n                                        >\r\n                                            {filterOptions.percentileRanks}\r\n                                        </Select>\r\n                                    </Tooltip>\r\n                                    {percentileRanksSliders}\r\n                                </Collapsible>\r\n                            </div>\r\n                            <div className=\"filter-buttons\" id=\"advanced-search-filter-buttons\">\r\n                                <div className=\"filter-button\">\r\n                                    <button id=\"reset-filters-button\" type=\"button\" onClick={this.resetParameters}>Reset</button>\r\n                                </div>\r\n                                <div className=\"filter-button\">\r\n                                    <button id=\"search-button\" type=\"button\" onClick={this.getSearchResults}>Search</button>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div className={`result ${displayType === \"cards\" ? \"scrollable\" : null}`} id=\"search-results\">\r\n                            {\r\n                                searchResults.length > 0 ?\r\n                                <p style={{marginLeft: '0px', lineHeight: '1.3'}}>\r\n                                    Season: {parameters.season.replace(\"-\", \"/\")} | {parameters.includeEuropeanCompetitions ? 'League + CL/EL Stats' : 'League Stats Only'}\r\n                                    <br/>\r\n                                    Data Sources: FBref.com & StatsBomb | Last Updated: {dateFormat(searchResults[0].lastUpdated, \"dd/mm/yyyy, h:MM TT\", true)} UTC\r\n                                </p> :\r\n                                null\r\n                            }\r\n                            {searchResults.length === 0 && this._firstSearchMade ? <p>No results found</p> : null}\r\n                            {searchResultsDisplay}\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            );\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default withQueryParams({\r\n    parameters: JsonParam\r\n}, withRouter(AdvancedSearch));\r\n\r\n","import React, { Component } from 'react';\r\nimport { withRouter, Route, Switch } from 'react-router-dom';\r\nimport { createBrowserHistory } from 'history'\r\nimport ReactGA from 'react-ga';\r\nimport {isMobileOnly, isSafari} from 'react-device-detect';\r\n\r\n//import pages\r\nimport Home from './pages/Home';\r\nimport Search from './pages/Search';\r\nimport Stats from './pages/Stats';\r\nimport Compare from './pages/Compare';\r\nimport Error from './pages/Error';\r\nimport AdvancedSearch from \"./pages/AdvancedSearch\";\r\n\r\n//import stylesheets, including mobile stylesheet if it is a mobile device\r\nrequire('./stylesheets/App.css');\r\nif (isMobileOnly){\r\n    import('./stylesheets/Mobile.css')\r\n    .then( () => {\r\n    });\r\n}\r\n\r\n//initialize Google Analytics\r\nReactGA.initialize('UA-179497563-1');\r\n\r\nconst history = createBrowserHistory();\r\nhistory.listen((location, action) => {\r\n    if (location.action === \"POP\" && location.location.pathname === \"/advancedSearch\"){\r\n        window.location.reload(false);\r\n    }\r\n});\r\n\r\n\r\n/**\r\n * Main app component. Handles routing, and the retrieval of percentile arrays.\r\n */\r\nclass App extends Component {\r\n\r\n\r\n    /**\r\n     * Constructor\r\n     * @param props\r\n     */\r\n    constructor(props) {\r\n\r\n        super(props);\r\n\r\n        let percentileArrays = JSON.parse(localStorage.getItem('percentileArrays'));\r\n\r\n        if (percentileArrays === null){\r\n            percentileArrays = {\r\n                lastUpdated: null\r\n            }\r\n        }\r\n\r\n        this.state = {\r\n            isLoading: true,\r\n            percentileArrays: percentileArrays,\r\n        };\r\n\r\n        this.getPercentileArrays();\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * Function to send a POST request to the server to retrieve the percentile arrays\r\n     */\r\n    getPercentileArrays = () => {\r\n\r\n        //retrieve percentile arrays and set isLoading to false\r\n        fetch('/api/percentiles', {\r\n            method: 'post',\r\n            headers: {\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            body: JSON.stringify({\r\n                \"percentilesTimestamp\": this.state.percentileArrays['lastUpdated']\r\n            })\r\n        })\r\n        .then(res => {\r\n            return res.json()\r\n        })\r\n        .then(percentileArrays => {\r\n            if (percentileArrays === null){\r\n                this.setState({isLoading: false})\r\n            }\r\n            else {\r\n                localStorage.setItem('percentileArrays', JSON.stringify(percentileArrays));\r\n                this.setState({percentileArrays: percentileArrays, isLoading: false})\r\n            }\r\n        })\r\n        .catch();\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Function to record a Google Analytics page view\r\n     * Passed to page components as a prop, and called on page load\r\n     * @param {string} location - the URL of the page for which the view is being recorded\r\n     */\r\n    recordPageViewGA = (location) => {\r\n\r\n        ReactGA.pageview(location);\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Function to update percentile arrays (called from Stats and Compare pages)\r\n     * @param {Object} newPercentileArrays - the object representing the new percentile arrays\r\n     */\r\n    updatePercentileArrays = (newPercentileArrays) => {\r\n\r\n        localStorage.setItem('percentileArrays', JSON.stringify(newPercentileArrays));\r\n\r\n        this.setState({\r\n            percentileArrays: newPercentileArrays\r\n        })\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * render function\r\n     * @return {*} - JSX code for the website routing\r\n     */\r\n    render() {\r\n\r\n        let { isLoading } = this.state;\r\n\r\n        //display loading message while server responds to POST request for the percentile arrays\r\n        if (isLoading) {\r\n            return (\r\n                <div id=\"main\">\r\n                    <div className=\"screen\" id=\"loading-screen\">\r\n                        <p>Connecting...</p>\r\n                    </div>\r\n                </div>\r\n            )\r\n        }\r\n\r\n        //return routing code otherwise\r\n        else {\r\n\r\n            return (\r\n                <Switch>\r\n                    <Route exact path='/' render={(props) =>\r\n                        <Home\r\n                            {...props}\r\n                            isMobile={isMobileOnly}\r\n                            recordPageViewGA={this.recordPageViewGA}\r\n                        />}\r\n                    />\r\n                    <Route exact path='/search/:query/:searchByClub?' render={(props) =>\r\n                        <Search\r\n                            {...props}\r\n                            isMobile={isMobileOnly}\r\n                            recordPageViewGA={this.recordPageViewGA}\r\n                        />}\r\n                    />\r\n                    <Route exact path='/advancedSearch' render={(props) =>\r\n                        <AdvancedSearch\r\n                            {...props}\r\n                            isMobile={isMobileOnly}\r\n                            recordPageViewGA={this.recordPageViewGA}\r\n                        />}\r\n                    />\r\n                    <Route exact path='/stats/:code' render={(props) =>\r\n                        <Stats\r\n                            {...props}\r\n                            isMobile={isMobileOnly}\r\n                            isSafari={isSafari}\r\n                            recordPageViewGA={this.recordPageViewGA}\r\n                            percentileArrays={this.state.percentileArrays}\r\n                            updatePercentileArrays={this.updatePercentileArrays}\r\n                        />}\r\n                    />\r\n                    <Route exact path='/compare/:codes' render={(props) =>\r\n                        <Compare\r\n                            {...props}\r\n                            isMobile={isMobileOnly}\r\n                            isSafari={isSafari}\r\n                            recordPageViewGA={this.recordPageViewGA}\r\n                            percentileArrays={this.state.percentileArrays}\r\n                            updatePercentileArrays={this.updatePercentileArrays}\r\n                        />}\r\n                    />\r\n                    <Route component={Error}/>\r\n                </Switch>\r\n            );\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default withRouter(App);\r\n","import React from 'react';\r\nimport { render } from 'react-dom';\r\nimport { BrowserRouter } from 'react-router-dom';\r\n\r\nimport './index.less';\r\nimport App from './App/App';\r\n\r\nimport { QueryParamProvider } from 'use-query-params';\r\n\r\nrender((\r\n    <BrowserRouter>\r\n        <QueryParamProvider\r\n        >\r\n            <App />\r\n        </QueryParamProvider>\r\n    </BrowserRouter>\r\n), document.getElementById('root'));\r\n"],"sourceRoot":""}