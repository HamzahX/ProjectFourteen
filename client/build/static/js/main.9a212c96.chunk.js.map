{"version":3,"sources":["App/assets/mockups.png","App/pages/Error.js","App/components/PlayerSearchResult.js","App/components/ClubSearchResult.js","App/components/SearchBar.js","App/components/LoadingSpinner.js","App/pages/Home.js","App/pages/Search.js","App/utilities/SliceUtilities.js","App/components/SliceOptions.js","App/components/Slice.js","App/components/CompareSearchOverlay.js","App/components/ExportLoaderOverlay.js","App/pages/Stats.js","App/pages/Compare.js","App/App.js","index.js"],"names":["module","exports","Error","Component","PlayerSearchResult","props","isMobile","positions","clubs","percentileEntries","seasons","Object","keys","length","i","currentSeasonPositions","undefined","state","page","forComparison","comparisonCode","code","name","age","nationality","countryCode","link","this","flagSizeMultiplier","to","tabIndex","className","basePath","country","format","pngSize","width","height","shiny","alt","join","ClubSearchResult","SearchBar","_isMounted","_firstRequest","getSearchResults","query","signal","liveSearchEnabled","controller","AbortController","Promise","resolve","reject","fetch","method","headers","body","JSON","stringify","then","res","ok","json","searchResults","catch","error","handleChange","event","setState","target","value","handleChangeLive","abort","liveResultsOpen","isLoading","updateLiveSearchResults","playerSearchResults","clubSearchResults","handleFocus","$","css","handleBlur","handleSubmit","preventDefault","history","push","handleSubmitLive","currentPlayerCode","e","containerID","displayHomeButton","playerCards","current","key","clubCards","id","style","display","color","onOutsideClick","onSubmit","type","placeholder","autoComplete","onChange","onFocus","withRouter","LoadingSpinner","Home","getDatabaseSize","databaseSize","Math","max","document","documentElement","clientHeight","window","innerHeight","addClass","toggleNavbar","responsiveNavbar","attr","removeClass","hideNavbar","title","message","onClick","href","rel","toLocaleString","fontWeight","src","mockUps","backgroundColor","Search","searchByClub","processSearchResults","filteredPlayerSearchResults","filterByName","parse","input","normalize","replace","toUpperCase","includes","filterValue","match","params","nextProps","nextContext","searchText","marginTop","cookies","Cookies","filterStats","stats","selectedCompetitions","playerCode","filteredStats","season","competition","stat","calculateStats","percentileSeason","percentileArrays","template","selectedSeasons","percentileArrayOccurrences","statsPer90","percentiles","minutes","isFinite","percentileRank","array","occurrences","constructChartInput","playerName","playerAge","index","alignments","colors","null","verticalAlignments","horizontalAlignments","isSecondPlayer","p90_labels","someStats","threeDigitStats","precision","parseFloat","round","toFixed","truncate","percentile_labels","roundedStats","roundNumbers","chartInput","y","p90_label","percentile_label","ordinalSuffix","dataLabels","align","verticalAlign","Highcharts","Color","setOpacity","get","borderColor","borderWidth","aNumber","j","k","changeTemplate","isAnimated","changeSelectedCompetitions","entry","clickedSeason","clickedCompetition","clickedValues","split","isLastCompetition","counter","splice","indexOf","changeLabelType","labelType","set","path","toggleCreditsPosition","newPosition","creditsPosition","exportChart","a","showExportLoaderOverlay","renderForExport","values","names","node","getElementById","domtoimage","toPng","bgcolor","blob","saveAs","setTimeout","console","log","alert","toggleCompareSearch","currentState","showCompareSearchOverlay","focus","SliceOptions","constructPlayerCompetitions","competitions","competitionsForms","competitionLabels","multipleClubs","marginBottom","currentCompetition","isIncluded","label","substring","checked","templateOpen","codes","labelTypes","templateLabels","mobileTemplateLabels","position","mobileClassName","disabled","playerCompetitions","templatesForm","mobileTemplatesForm","open","trigger","transitionTime","transitionCloseTime","labelTypeLabels","labelTypeForm","HighchartsMore","Slice","isForExport","isForComparison","fontSizes","subtitle","noData","xAxisLabels","dataLabelsOutline","tooltipHeader","tooltip","legend","credits","yAxisLabels","legendTitle","categories","titleColors","primaryColors","subtitles","chartEvents","xAxisLabelDistance","startAngle","load","element","onclick","tooltipPositioner","labelWidth","labelHeight","point","x","plotX","plotY","creditsText","lastUpdated","chartOptions","useHTML","text","fontSize","margin","pane","chart","fontFamily","animation","polar","marginLeft","marginRight","events","xAxis","labels","zIndex","distance","padding","gridLineWidth","gridLineColor","gridZIndex","yAxis","enabled","lineWidth","endOnTick","showFirstLabel","showLastLabel","min","tickPositions","series","plotOptions","duration","isAnimatedInitial","legendItemClick","slice","seriesOptions","options","update","drawLegendBorders","states","hover","textOutline","allowOverlap","z","mouseOut","hide","column","grouping","shadow","hasTooltip","shared","positioner","followPointer","headerFormat","pointFormat","symbolPadding","layout","itemStyle","itemHoverStyle","itemMarginTop","lineHeight","lang","responsive","rules","condition","maxWidth","wrap","Axis","prototype","proceed","call","seriesGroup","renderer","g","add","coll","gridGroup","afterChartCreated","bind","each","allItems","item","legendSymbol","setAttribute","prevProps","prevState","snapshot","url","hasUndefined","map","data","pointPadding","groupPadding","stickyTracking","numColors","gradientStops","stop","radialGradient","cx","cy","r","stops","constructorType","highcharts","containerProps","callback","CompareSearchOverlay","currentPlayerName","ExportLoaderOverlay","Stats","getStats","response","processStats","redirect","newPercentileArrays","updatePercentileArrays","playerStats","fbrefURL","dateFormat","isSafari","labelTypeCookie","creditsPositionCookie","calculatedStats","exportSlice","require","Compare","urls","ages","code1","code2","isMobileOnly","ReactGA","initialize","createBrowserHistory","listen","location","action","pageview","pathname","search","App","getPercentileArrays","exact","render","component"],"mappings":"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","file":"static/js/main.9a212c96.chunk.js","sourcesContent":["module.exports = __webpack_public_path__ + \"static/media/mockups.7dea4274.png\";","import React, { Component } from 'react';\r\n\r\n/**\r\n * 404 component\r\n */\r\nclass Error extends Component {\r\n\r\n    /**\r\n     * render function\r\n     * @return {*} - JSX code for the homepage\r\n     */\r\n    render() {\r\n\r\n        return (\r\n            <h1>404 - Page not found</h1>\r\n        )\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default Error;\r\n","import React, { Component } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport Flag from \"react-flags\";\r\n\r\n/**\r\n * Component to render a player search result\r\n */\r\nclass PlayerSearchResult extends Component {\r\n\r\n    constructor(props) {\r\n\r\n        super(props);\r\n\r\n        this.isMobile = this.props.isMobile;\r\n\r\n        let clubs = this.props.clubs;\r\n        let percentileEntries = this.props.percentileEntries;\r\n        let seasons = Object.keys(clubs);\r\n\r\n        //set the player clubs entry to their most recent season's clubs\r\n        clubs = clubs[seasons[seasons.length-1]];\r\n\r\n        //set the player positions to the latest season for which they have position info\r\n        let positions;\r\n        for (let i=seasons.length-1; i>=0; i--){\r\n            let season = seasons[i];\r\n            let currentSeasonPositions = percentileEntries[season];\r\n            positions = (currentSeasonPositions === undefined || currentSeasonPositions.length < 1) ? [\"-\"] : currentSeasonPositions;\r\n            if (positions[0] !== \"-\"){\r\n                break;\r\n            }\r\n        }\r\n\r\n        this.state = {\r\n            page: this.props.page,\r\n            forComparison: this.props.forComparison,\r\n            comparisonCode: this.props.comparisonCode,\r\n            code: this.props.code,\r\n            name: this.props.name,\r\n            age: this.props.age,\r\n            clubs: clubs,\r\n            nationality: this.props.nationality,\r\n            countryCode: this.props.countryCode,\r\n            positions: positions\r\n        };\r\n\r\n    }\r\n\r\n    /**\r\n     * render function\r\n     * @return {*} - JSX code for a player search result\r\n     */\r\n    render() {\r\n\r\n        let {\r\n            page,\r\n            forComparison,\r\n            comparisonCode,\r\n            code,\r\n            name,\r\n            age,\r\n            clubs,\r\n            nationality,\r\n            countryCode,\r\n            positions\r\n        } = this.state;\r\n\r\n        let link;\r\n        //set the link to the comparison page if it is a result for a player comparison\r\n        if (forComparison) {\r\n            link = `/compare/${comparisonCode}_${code}`;\r\n        }\r\n        //set the link to the stats page otherwise\r\n        else {\r\n            link = `/stats/${code}`;\r\n        }\r\n\r\n        let flagSizeMultiplier = this.isMobile ? 1.8 : 1;\r\n\r\n        return (\r\n            <Link to={link}>\r\n                <div tabIndex=\"0\" className=\"search-result\">\r\n                    <div className=\"bio\">\r\n                        <span className=\"name\">{name}</span>\r\n                        <Flag\r\n                            basePath={\"/flags\"}\r\n                            country={countryCode}\r\n                            format=\"png\"\r\n                            pngSize={32}\r\n                            width={(page === \"live\" ? 24 : 28) * flagSizeMultiplier}\r\n                            height={(page === \"live\" ? 24 : 28) * flagSizeMultiplier}\r\n                            shiny={true}\r\n                            alt={`${nationality} Flag`}\r\n                        />\r\n                    </div>\r\n                    <div className=\"bio-extra\">\r\n                        <span className=\"club\">{clubs.join(\", \")}</span>\r\n                        <span className=\"position-age\">{`${age} | ${positions.join(\", \")}`}</span>\r\n                    </div>\r\n                </div>\r\n            </Link>\r\n        );\r\n    }\r\n\r\n}\r\n\r\nexport default (PlayerSearchResult);\r\n","import React, { Component } from 'react';\r\nimport { Link } from 'react-router-dom';\r\nimport Flag from \"react-flags\";\r\n\r\n\r\n/**\r\n * Component to render a club search result\r\n */\r\nclass ClubSearchResult extends Component {\r\n\r\n    constructor(props) {\r\n\r\n        super(props);\r\n\r\n        this.isMobile = this.props.isMobile;\r\n\r\n        this.state = {\r\n            page: this.props.page,\r\n            name: this.props.name,\r\n            countryCode: this.props.countryCode\r\n        };\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * render function\r\n     * @return {*} - JSX code for a club search result\r\n     */\r\n    render() {\r\n\r\n        let { page, name, countryCode } = this.state;\r\n\r\n        let flagSizeMultiplier = this.isMobile ? 2 : 1;\r\n\r\n        return (\r\n            <Link to={\"/search/\" + name + \"/all\"}>\r\n                <div tabIndex=\"0\" className=\"search-result\">\r\n                    <div className=\"bio\">\r\n                        <span className=\"name\">{name}</span>\r\n                        <Flag\r\n                            basePath={\"/flags\"}\r\n                            country={countryCode}\r\n                            format=\"png\"\r\n                            pngSize={32}\r\n                            width={(page === \"live\" ? 24 : 28) * flagSizeMultiplier}\r\n                            height={(page === \"live\" ? 24 : 28) * flagSizeMultiplier}\r\n                            shiny={true}\r\n                            alt={`${countryCode} Flag`}\r\n                        />\r\n                    </div>\r\n                </div>\r\n            </Link>\r\n        );\r\n    }\r\n\r\n}\r\n\r\nexport default (ClubSearchResult);\r\n","import React, { Component } from 'react';\r\nimport { Link, withRouter } from 'react-router-dom';\r\nimport OutsideClickHandler from 'react-outside-click-handler';\r\n\r\n//import components\r\nimport PlayerSearchResult from \"./PlayerSearchResult\";\r\nimport ClubSearchResult from \"./ClubSearchResult\";\r\nimport $ from \"jquery\";\r\n\r\n\r\n/**\r\n * Component to render a div containing a searchbar\r\n * Also handles the live search requests and aborts\r\n */\r\nclass SearchBar extends Component {\r\n\r\n    //class variable to track if the component is mounted\r\n    _isMounted = false;\r\n    _firstRequest = true;\r\n\r\n    constructor(props) {\r\n\r\n        super(props);\r\n\r\n        this.page = this.props.page;\r\n        this.isMobile = this.props.isMobile;\r\n        this.currentPlayerCode = this.props.currentPlayerCode;\r\n        this.liveSearchEnabled = true;\r\n\r\n        //try to create the abort controller for live search requests\r\n        //AbortController is relatively new, so we catch an error and disable live search if it is undefined\r\n        try {\r\n            this.controller = new AbortController();\r\n            // throw new Error(\"ERROR\");\r\n        }\r\n        catch (e) {\r\n            this.liveSearchEnabled = false;\r\n        }\r\n\r\n        //change the searchbar container id based on the page so that the CSS rules modify it accordingly\r\n        this.containerID = \"\";\r\n        switch (this.page) {\r\n            case \"search\":\r\n                this.containerID = \"searchbar-container2\";\r\n                break;\r\n            case \"stats\":\r\n                this.containerID = \"searchbar-container3\";\r\n                break;\r\n            default:\r\n                this.containerID = \"searchbar-container1\";\r\n        }\r\n\r\n        //attach a home button to the searchbar if it is not being displayed on the homepage or the compare dialog\r\n        this.displayHomeButton = 'default';\r\n        if (this.page === \"home\" || this.page === \"compare\"){\r\n            this.displayHomeButton = 'none';\r\n        }\r\n\r\n        this.state = {\r\n            query: this.props.query || \"\",\r\n            isLoading: this.props.query !== undefined,\r\n            error: null,\r\n            liveResultsOpen: false,\r\n            playerSearchResults: [],\r\n            clubSearchResults: [],\r\n        };\r\n\r\n        this.updateLiveSearchResults(this.state.query);\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * Called after component has mounted\r\n     */\r\n    componentDidMount() {\r\n        this._isMounted = true;\r\n    }\r\n\r\n\r\n    /**\r\n     * Function to send a post request to the server to retrieve the search results matching the query\r\n     */\r\n    getSearchResults = (query) => {\r\n\r\n        //create a new abort controller for every request and retrieve its signal\r\n        let signal = null;\r\n        if (this.liveSearchEnabled){\r\n            this.controller = new AbortController();\r\n            signal = this.controller.signal;\r\n        }\r\n\r\n        return new Promise((resolve, reject) => {\r\n            //fetch search results\r\n            //pass signal to the fetch request so it can be cancelled\r\n            //this is done with live searches to cancel the previous request every time a new letter is typed\r\n            fetch('/api/search', {\r\n                signal,\r\n                method: 'post',\r\n                headers: {\r\n                    \"Content-Type\": \"application/json\"\r\n                },\r\n                body: JSON.stringify({\r\n                    \"query\": query,\r\n                    \"type\": \"playersAndClubs\",\r\n                    \"isLive\": true\r\n                })\r\n            })\r\n                .then(res => {\r\n                    if (res.ok) {\r\n                        return res.json()\r\n                    }\r\n                    else {\r\n                        throw new Error(\"Failed to fetch search results. Please refresh the page and try again.\")\r\n                    }\r\n                },\r\n                    () => {\r\n                        reject()\r\n                    })\r\n                .then(searchResults => {\r\n                    resolve(searchResults);\r\n                })\r\n                .catch(error => {\r\n                    reject(error);\r\n                });\r\n        })\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Called just before the component un-mounts\r\n     */\r\n    componentWillUnmount() {\r\n        this._isMounted = false;\r\n    }\r\n\r\n\r\n    /**\r\n     * Function to handle an input to the searchbar if live search is NOT enabled\r\n     * Updates searchbar input value\r\n     * @param {Object} event - the input event from the searchbar input\r\n     */\r\n    handleChange = (event) => {\r\n\r\n        this.setState({\r\n            query: event.target.value,\r\n        });\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Function to handle an input to the searchbar if live search is enabled\r\n     * Updates searchbar input value, fetches search results and sets state\r\n     * @param {Object} event - the input event from the searchbar input\r\n     */\r\n    handleChangeLive = (event) => {\r\n\r\n        let query = event.target.value;\r\n\r\n        //cancel previous request if it's not the first request\r\n        if (this._firstRequest){\r\n            this._firstRequest = false;\r\n        }\r\n        else {\r\n            this.controller.abort();\r\n        }\r\n\r\n        //set searchbar input value and open live search results container\r\n        this.setState({\r\n            query: query,\r\n            liveResultsOpen: query.length > 0,\r\n            isLoading: true\r\n        });\r\n\r\n        this.updateLiveSearchResults(query);\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Function to update the arrays of search results\r\n     * Also handles the display of the loading spinner and error messages (if applicable) in the live container\r\n     */\r\n    updateLiveSearchResults = (query) => {\r\n\r\n        if (query.length > 0){\r\n            this.getSearchResults(query)\r\n                .then((searchResults) => {\r\n                    let playerSearchResults = searchResults['playerSearchResults'];\r\n                    let clubSearchResults = searchResults['clubSearchResults'];\r\n                    if (this._isMounted){\r\n                        this.setState({\r\n                            playerSearchResults: [],\r\n                            clubSearchResults: []\r\n                        }, () => {\r\n                            this.setState({\r\n                                playerSearchResults: playerSearchResults,\r\n                                clubSearchResults: clubSearchResults,\r\n                                error: null,\r\n                                isLoading: false\r\n                            })\r\n                        })\r\n                    }\r\n                }, (error) => {\r\n                    if (this._isMounted){\r\n                        if (error){\r\n                            this.setState({\r\n                                error: error,\r\n                                isLoading: false\r\n                            })\r\n                        }\r\n                    }\r\n                })\r\n        }\r\n        else {\r\n            if (this._isMounted){\r\n                this.setState({\r\n                    error: null,\r\n                    isLoading: false,\r\n                    playerSearchResults: [],\r\n                    clubSearchResults: []\r\n                })\r\n            }\r\n        }\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Function to handle the searchbar being focused\r\n     * Displays the live search results on focus\r\n     * @param {Object} event - the focus event from the searchbar input\r\n     */\r\n    handleFocus = (event) => {\r\n\r\n        let query = event.target.value;\r\n        if (this.isMobile && this.page === \"home\"){\r\n            $(\"#searchbar-container1\").css({\r\n                \"position\": \"fixed\",\r\n                \"top\": 0,\r\n                \"left\": 0,\r\n                \"width\": \"100%\",\r\n                \"z-index\": 7\r\n            });\r\n            $(\"h1\").css({\r\n                \"display\": \"none\"\r\n            })\r\n        }\r\n        this.setState({\r\n            liveResultsOpen: this.liveSearchEnabled && query.length > 0\r\n        })\r\n\r\n    };\r\n\r\n    /**\r\n     * Function to handle the searchbar being blurred (un-focused)\r\n     * hides the live search results\r\n     */\r\n    handleBlur = () => {\r\n\r\n        if (this.isMobile && this.page === \"home\"){\r\n            $(\"#searchbar-container1\").css({\r\n                \"position\": \"relative\",\r\n                \"width\": '75%',\r\n                \"z-index\": 1\r\n            });\r\n            $(\"h1\").css({\r\n                \"display\": \"block\"\r\n            })\r\n        }\r\n\r\n        this.setState({\r\n            liveResultsOpen: false\r\n        })\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Function to handle submit events from the searchbar input if live search is NOT enabled\r\n     * Redirects to the search URL with the correct URL params\r\n     * @param {Object} event - the submit event from the searchbar input\r\n     */\r\n    handleSubmit = (event) => {\r\n\r\n        event.preventDefault();\r\n\r\n        if (this.page !== \"compare\"){\r\n            this.props.history.push('/search/' + this.state.query);\r\n        }\r\n        else {\r\n\r\n            let query = this.state.query;\r\n\r\n            //open live search results container\r\n            this.setState({\r\n                liveResultsOpen: query.length > 0,\r\n                isLoading: true\r\n            });\r\n\r\n            this.updateLiveSearchResults(query);\r\n\r\n        }\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Function to handle submit events from the searchbar input if live search is enabled\r\n     * Redirects to the search URL with the correct URL params\r\n     * @param {Object} event - the submit event from the searchbar input\r\n     */\r\n    handleSubmitLive = (event) => {\r\n\r\n        event.preventDefault();\r\n\r\n        if (this.page !== \"compare\"){\r\n            this.props.history.push('/search/' + this.state.query);\r\n        }\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * render function\r\n     * modifies searchbar based on the page it is to be displayed on\r\n     * @return {*} - JSX code for the searchbar and its container\r\n     */\r\n    render() {\r\n\r\n        const {\r\n            query,\r\n            isLoading,\r\n            liveResultsOpen,\r\n            playerSearchResults,\r\n            clubSearchResults\r\n        } = this.state;\r\n\r\n        //construct the player cards\r\n        let playerCards = [];\r\n        for (let i=0; i<playerSearchResults.length; i++){\r\n            let current = playerSearchResults[i];\r\n            playerCards.push(\r\n                <PlayerSearchResult\r\n                    isMobile={this.isMobile}\r\n                    page=\"live\"\r\n                    forComparison={this.page === \"compare\"}\r\n                    comparisonCode={this.currentPlayerCode}\r\n                    code={current.code}\r\n                    name={current.name}\r\n                    age={current.age}\r\n                    clubs={current.clubs}\r\n                    nationality={current.nationality}\r\n                    countryCode={current.countryCode}\r\n                    percentileEntries={current.percentileEntries}\r\n                    key={i}\r\n                />\r\n            );\r\n        }\r\n\r\n        //construct the club cards\r\n        let clubCards = [];\r\n        for (let i=0; i<clubSearchResults.length; i++){\r\n            let current = clubSearchResults[i];\r\n            clubCards.push(\r\n                <ClubSearchResult\r\n                    isMobile={this.isMobile}\r\n                    page=\"live\"\r\n                    name={current.name}\r\n                    countryCode={current.countryCode}\r\n                    key={i}\r\n                />\r\n            )\r\n        }\r\n\r\n        //return JSX code for the searchbar\r\n        return (\r\n            <div className=\"searchbar-container\" id={this.containerID}>\r\n                <Link id=\"home-button\" to={'/'}>\r\n                    <div style={{display: this.displayHomeButton}}>\r\n                        <div>\r\n                            Football\r\n                            <span style={{color: '#e4c000', display: 'block'}}>\r\n                                Slices\r\n                                <span style={{color: 'black'}}>.com</span>\r\n                            </span>\r\n                        </div>\r\n                    </div>\r\n                </Link>\r\n                <OutsideClickHandler\r\n                    onOutsideClick={this.handleBlur}\r\n                >\r\n                    <form id=\"searchbar-form\" onSubmit={this.liveSearchEnabled ? this.handleSubmitLive : this.handleSubmit}>\r\n                        <input\r\n                            type=\"text\"\r\n                            id=\"searchbar-input\"\r\n                            value={query}\r\n                            placeholder={this.page === \"compare\" ? \"Search for players...\" : \"Search for players, clubs...\"}\r\n                            autoComplete=\"off\"\r\n                            onChange={this.liveSearchEnabled ? this.handleChangeLive : this.handleChange}\r\n                            onFocus={this.handleFocus}\r\n                        />\r\n                        <div id=\"live-search-results\" style={{display: liveResultsOpen ? 'block' : 'none'}}>\r\n                            <div id=\"live-search-loader\">\r\n                                <div style={{display: isLoading ? 'block' : 'none'}} className=\"loader\">\r\n                                    Loading...\r\n                                </div>\r\n                            </div>\r\n                            <div>\r\n                                <div>\r\n                                    <h3>Players</h3>\r\n                                    {playerCards}\r\n                                    {playerCards.length === 0 ? <p>{isLoading ? \"...\" : \" No results found\"}</p> : null}\r\n                                </div>\r\n                                <div style={{display: this.page === \"compare\" ? 'none' : 'block'}}>\r\n                                    <h3>Clubs</h3>\r\n                                    {clubCards}\r\n                                    {clubCards.length === 0 ? <p>{isLoading ? \"...\" : \" No results found\"}</p> : null}\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </form>\r\n                </OutsideClickHandler>\r\n            </div>\r\n\r\n        );\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default withRouter (SearchBar);\r\n","import React, { Component } from 'react';\r\n\r\n\r\n/**\r\n * Renders a pure CSS loading spinner\r\n * taken from: https://projects.lukehaas.me/css-loaders/\r\n */\r\nclass LoadingSpinner extends Component {\r\n\r\n    render() {\r\n        return (\r\n            <div id=\"main\">\r\n                <div className=\"screen\" id=\"loading-screen\">\r\n                    <div className=\"loader\">Loading...</div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n}\r\nexport default (LoadingSpinner);\r\n","import React, { Component } from 'react';\r\nimport OutsideClickHandler from 'react-outside-click-handler';\r\nimport $ from \"jquery\";\r\n\r\n//import components\r\nimport SearchBar from \"../components/SearchBar\"\r\nimport LoadingSpinner from \"../components/LoadingSpinner\";\r\n\r\n//import assets\r\nimport mockUps from \"../assets/mockups.png\"\r\n\r\n\r\n/**\r\n * Homepage component\r\n */\r\nclass Home extends Component {\r\n\r\n    //class variable to track if the component is mounted\r\n    _isMounted = false;\r\n\r\n    /**\r\n     * Constructor\r\n     * @param props\r\n     */\r\n    constructor(props) {\r\n\r\n        super(props);\r\n\r\n        this.isMobile = this.props.isMobile;\r\n\r\n        this.state = {\r\n            isLoading: true,\r\n            error: null,\r\n            databaseSize: 0,\r\n        };\r\n        this.getDatabaseSize();\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * Called after component has mounted\r\n     */\r\n    componentDidMount() {\r\n        this._isMounted = true;\r\n        document.title = \"Home | Football Slices\";\r\n        // window.location.href = this.props.location.hash;\r\n        // console.log(this.props.location.hash);\r\n    }\r\n\r\n\r\n\r\n    /**\r\n     * Function to send a post request to the server to retrieve the number of players currently in the dataabase\r\n     */\r\n    getDatabaseSize = () => {\r\n\r\n        //fetch sample players\r\n        fetch('/api/databaseSize', {\r\n            method: 'post',\r\n            headers: {\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            body: JSON.stringify({})\r\n        })\r\n        .then(res => res.json())\r\n        .then(databaseSize => {\r\n            //only set state if the component is mounter\r\n            if (this._isMounted){\r\n                this.setState({databaseSize: databaseSize.value, isLoading: false});\r\n                //hard code the height of home and the navbar container if it is a mobile device\r\n                //this is done because the soft keyboards on mobile devices affect the view-height\r\n                if (this.isMobile){\r\n                    let height = Math.max(document.documentElement.clientHeight, window.innerHeight || 0);\r\n                    $(\"#home\").css({\"height\": height});\r\n                }\r\n                //add preload class to the hidden menu to disable the first animation\r\n                $(\"#navbar-hidden\").addClass('preload');\r\n            }\r\n        })\r\n        .catch(error => {\r\n            if (this._isMounted){\r\n                this.setState({\r\n                    error: error,\r\n                    isLoading: false\r\n                })\r\n            }\r\n        });\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Called just before the component un-mounts\r\n     */\r\n    componentWillUnmount() {\r\n        this._isMounted = false;\r\n    }\r\n\r\n\r\n    /**\r\n     * Function to display/hide the responsive navbar\r\n     */\r\n    toggleNavbar = () => {\r\n\r\n        //select the responsive navbar element\r\n        let responsiveNavbar = $(\".responsive-navbar\");\r\n\r\n        //expand or hide based on current state\r\n        if (responsiveNavbar.attr(\"id\") === \"navbar-hidden\"){\r\n            responsiveNavbar.attr(\"id\", \"navbar-expanded\");\r\n        }\r\n        else {\r\n            //remove preload class when expanding to re-enable animations\r\n            $(\"#navbar-expanded\").removeClass('preload');\r\n            responsiveNavbar.attr(\"id\", \"navbar-hidden\");\r\n        }\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Function to hide the navbar (called after one of the menu options is clicked)\r\n     */\r\n    hideNavbar = () => {\r\n\r\n        $(\"#navbar-expanded\").removeClass('preload');\r\n        $(\".responsive-navbar\").attr(\"id\", \"navbar-hidden\");\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * render function\r\n     * @return {*} - JSX code for the homepage\r\n     */\r\n    render() {\r\n\r\n        let { isLoading, error, databaseSize } = this.state;\r\n\r\n        //display loading spinner while the server responds to POST request for the sample players\r\n        if (isLoading) {\r\n            return (\r\n                <LoadingSpinner/>\r\n            )\r\n        }\r\n\r\n        //display the error message screen if an error is caught\r\n        else if (error !== null) {\r\n            return (\r\n                <div id=\"main2\">\r\n                    <SearchBar\r\n                        isMobile={this.isMobile}\r\n                        page=\"home\"\r\n                    />\r\n                    <div className=\"screen\" id=\"error-screen\">\r\n                        <p>{error.message}</p>\r\n                    </div>\r\n                </div>\r\n            )\r\n        }\r\n\r\n        //return homepage code otherwise\r\n        else {\r\n\r\n            // //construct the sample player buttons\r\n            // let samplePlayerButton = [];\r\n            // for (let i=0; i<samplePlayers.length; i++){\r\n            //     let current = samplePlayers[i];\r\n            //     samplePlayerButton.push(\r\n            //         <PlayerSearchResult\r\n            //             page = \"home\"\r\n            //             code = {current.code}\r\n            //             name = {current.name}\r\n            //             clubs = {current.clubs}\r\n            //             nationality = {current.nationality}\r\n            //             key = {i}\r\n            //         />\r\n            //     );\r\n            // }\r\n\r\n            //static JSX code for the homepage\r\n            return (\r\n                <div id=\"homepage\">\r\n                    <OutsideClickHandler\r\n                        onOutsideClick={this.hideNavbar}\r\n                    >\r\n                        <div id=\"navbar-container\">\r\n                            <div className=\"navbar\" id=\"navbar-normal\">\r\n                                <a onClick={this.hideNavbar} href=\"#home\">\r\n                                    <div>Home</div>\r\n                                </a>\r\n                                <a href=\"#about\">\r\n                                    <div>About</div>\r\n                                </a>\r\n                                <a href=\"#glossary\">\r\n                                    <div>Glossary</div>\r\n                                </a>\r\n                                <a href=\"#faq\">\r\n                                    <div>F.A.Q.</div>\r\n                                </a>\r\n                                <a href=\"#contact\">\r\n                                    <div>Contact</div>\r\n                                </a>\r\n                                <button onClick={this.toggleNavbar} id=\"burger-icon-container\">\r\n                                    <div id=\"burgerIcon\"><i className=\"fa fa-bars\"/></div>\r\n                                </button>\r\n                            </div>\r\n                            <div className=\"navbar responsive-navbar\" id=\"navbar-hidden\">\r\n                                <a onClick={this.hideNavbar} href=\"#about\">\r\n                                    <div>About</div>\r\n                                </a>\r\n                                <a onClick={this.hideNavbar} href=\"#glossary\">\r\n                                    <div>Glossary</div>\r\n                                </a>\r\n                                <a onClick={this.hideNavbar} href=\"#faq\">\r\n                                    <div>F.A.Q.</div>\r\n                                </a>\r\n                                <a onClick={this.hideNavbar} href=\"#contact\">\r\n                                    <div>Contact</div>\r\n                                </a>\r\n                            </div>\r\n                        </div>\r\n                    </OutsideClickHandler>\r\n                    <div id=\"home\">\r\n                        <h1>Football<span style={{color: '#e4c000'}}>Slices</span></h1>\r\n                        <SearchBar\r\n                            isMobile={this.isMobile}\r\n                            page=\"home\"\r\n                        />\r\n                        {/*<Link to={\"/stats/\" + samplePlayer.code}>*/}\r\n                        {/*    <button id=\"lucky-button\">*/}\r\n                        {/*        Slice of Luck*/}\r\n                        {/*    </button>*/}\r\n                        {/*</Link>*/}\r\n                        {/*<p>Trending:</p>*/}\r\n                        {/*<div id=\"sample-results\">*/}\r\n                        {/*    {samplePlayerButtons}*/}\r\n                        {/*</div>*/}\r\n                    </div>\r\n                    <div id=\"about\" className=\"homepage-section-container centered-section\">\r\n                        <div id=\"about-section-container\">\r\n                            <div id=\"about-text\">\r\n                                <h2>About</h2>\r\n                                <p>\r\n                                    Football Slices is a stats visualization tool powered\r\n                                    by <a href=\"https://www.highcharts.com\" target=\"_blank\" rel=\"noopener noreferrer\">Highcharts.js</a>,\r\n                                    and adapted from <a href=\"https://projects.fivethirtyeight.com/world-cup-comparisons/\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n                                    FiveThirtyEight's World Cup player profiles.</a>\r\n                                </p>\r\n                                <p>\r\n                                    It is built on a database of <b>{databaseSize.toLocaleString()} players</b> from <b>Europe's top 5 leagues</b>,\r\n                                    with stats from the <b>2018/19</b> and <b>2019/20</b> seasons.\r\n                                </p>\r\n                                <p>\r\n                                    Football Slices is made possible by the incredible work done by the people over\r\n                                    at <a href=\"https://www.fbref.com\" target=\"_blank\" rel=\"noopener noreferrer\">FBref.com</a>,\r\n                                    who provide advanced stats courtesy of <a href=\"https://www.statsbomb.com\" target=\"_blank\" rel=\"noopener noreferrer\">StatsBomb</a>.\r\n                                    Every chart title has a link to the player's page on FBref, where you can find that player's\r\n                                    complete stats sheet. Please do make sure to check out FBref and spread the word about\r\n                                    them if you'd like to see them continue adding more data to their site.\r\n                                </p>\r\n                                <br/>\r\n                                <p><span className=\"accented-p\">Interpreting the Slices</span></p>\r\n                                <p>\r\n                                    Each slice is made up of wedges. The size of each wedge corresponds to the\r\n                                    percentile rank of the selected player with regards to the stat represented by the\r\n                                    wedge. The data labels show the raw values.\r\n                                </p>\r\n                                <p>\r\n                                    The colours help to group similar-ish stats together (as well as improve the charts'\r\n                                    visual impact).\r\n                                </p>\r\n                                <ul>\r\n                                    <li><span style={{color: '#f15c80', fontWeight: 'bold'}}>Red</span> is for goal-scoring & shooting stats,</li>\r\n                                    <li><span style={{color: '#e4c000', fontWeight: 'bold'}}>Yellow</span> is for passing, chance creation & ball progression</li>\r\n                                    <li><span style={{color: '#87e179', fontWeight: 'bold'}}>Green</span> is for dribbling & ball retention</li>\r\n                                    <li><span style={{color: '#7db9f0', fontWeight: 'bold'}}>Blue</span> is for defending</li>\r\n                                    <li>and <span style={{color: '#787ccd', fontWeight: 'bold'}}>Purple</span> is for goalkeeping stats</li>\r\n                                </ul>\r\n                            </div>\r\n                            <div id=\"about-image\">\r\n                                <img src={mockUps} alt=\"Mock-ups\"/>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div id=\"glossary\" style={{backgroundColor: '#f5f6f7'}} className=\"homepage-section-container\">\r\n                        <div id=\"glossary-section-container\">\r\n                            <h2>Glossary</h2>\r\n                            <ul>\r\n                                <li>\r\n                                    <span style={{color: '#f15c80', fontWeight: 'bold'}}>Non-Penalty Goal</span>&nbsp;\r\n                                    A goal that did not stem directly from a penalty kick.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#f15c80', fontWeight: 'bold'}}>Non-Penalty xG (Expected Goals)</span>&nbsp;\r\n                                    Expected goals that did not stem directly from penalty kicks.*\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#f15c80', fontWeight: 'bold'}}>Non-Penalty xG/Shot</span>&nbsp;\r\n                                    The average expected goal value of shots taken, excluding penalty kicks.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#f15c80', fontWeight: 'bold'}}>Conversion Rate</span>&nbsp;\r\n                                    The percentage of shots that resulted in goals, excluding penalty kicks.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#f15c80', fontWeight: 'bold'}}>Aerial Win %</span>&nbsp;\r\n                                    The percentage of aerials duels contested that were won.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#e4c000', fontWeight: 'bold'}}>Touch in Box</span>&nbsp;\r\n                                    Having possession of the ball in the opposition's penalty area.\r\n                                    (Note: Receiving a pass, then dribbling, then sending a pass counts as one touch)\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#e4c000', fontWeight: 'bold'}}>xA (Expected Assists)</span>&nbsp;\r\n                                    Expected goals that resulted from shot assists, including set pieces.*\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#e4c000', fontWeight: 'bold'}}>OP (Open Play) Shot-Creating Action</span>&nbsp;\r\n                                    Excluding set pieces, one of the last two offensive actions that directly\r\n                                    led to a shot; such as a pass, dribble or a drawn foul.\r\n                                    (Note: A single player can receive credit for multiple actions and the shot-taker can also receive credit)\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#e4c000', fontWeight: 'bold'}}>Pass into Box</span>&nbsp;\r\n                                    A completed pass that entered the opposition's penalty area, excluding set pieces.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#e4c000', fontWeight: 'bold'}}>Pass into Final 1/3</span>&nbsp;\r\n                                    A completed pass that entered the third of the pitch that is closest to the opposition's goal, excluding set pieces.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#e4c000', fontWeight: 'bold'}}>Progressive Distance</span>&nbsp;\r\n                                    Distance, in yards, that the ball was moved towards the oppositions's goal\r\n                                    with passes and carries.\r\n                                    (Note: Passes and carries away from the oppositions's goal are counted as zero progressive yards)\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#e4c000', fontWeight: 'bold'}}>Pass Completion %</span>&nbsp;\r\n                                    The percentage of attempted passes that successfully found a teammate.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#e4c000', fontWeight: 'bold'}}>Long Pass Completion %</span>&nbsp;\r\n                                    The percentage of attempted passes of 25 yards or more that successfully found a teammate.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#e4c000', fontWeight: 'bold'}}>Launched Pass Completion %</span>&nbsp;\r\n                                    The percentage of attempted passes of 40 yards or more that successfully found a teammate, including goal kicks.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#87e179', fontWeight: 'bold'}}>Successful Dribble</span>&nbsp;\r\n                                    A successful attempt at taking on a player and making it past them whilst retaining possession.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#87e179', fontWeight: 'bold'}}>Dribble Success %</span>&nbsp;\r\n                                    The percentage of attempted dribbles that were successful.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#87e179', fontWeight: 'bold'}}>Dispossessed</span>&nbsp;\r\n                                    Being tackled by an opponent and losing control of the ball without attempting a dribble.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#7db9f0', fontWeight: 'bold'}}>pAdj</span>&nbsp;\r\n                                    Possession Adjusted (using the StatsBomb sigmoid function).**\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#7db9f0', fontWeight: 'bold'}}>Successful Pressure</span>&nbsp;\r\n                                    A pressing action that led to the team regaining possession within the next 5 seconds.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#7db9f0', fontWeight: 'bold'}}>Interception</span>&nbsp;\r\n                                    A prevention of an opponent's pass from reaching another opponent by moving into the line of the pass.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#7db9f0', fontWeight: 'bold'}}>Tackle Won</span>&nbsp;\r\n                                    A dispossession of an opponent such that the tackling player's team won possession of the ball.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#7db9f0', fontWeight: 'bold'}}>Tackle/Dribbled Past %</span>&nbsp;\r\n                                    The percentage of dribblers faced that were tackled.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#7db9f0', fontWeight: 'bold'}}>Aerial Win</span>&nbsp;\r\n                                    Winning the ball in a duel that was challenged in the air.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#7db9f0', fontWeight: 'bold'}}>Aerial Win %</span>&nbsp;\r\n                                    The percentage of aerials duels contested that were won.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#7db9f0', fontWeight: 'bold'}}>Clearance</span>&nbsp;\r\n                                    An action where a player kicked/headed the ball away from their own goal.\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#787ccd', fontWeight: 'bold'}}>GSAA (Goals Saved Above Average) %</span>&nbsp;\r\n                                    (Post-Shot xG  Goals Conceded (excluding own goals))  Shots on Target Faced.***\r\n                                </li>\r\n                                <li>\r\n                                    <span style={{color: '#787ccd', fontWeight: 'bold'}}>Cross Stopping %</span>&nbsp;\r\n                                    The percentage of attempted crosses into the penalty area that were stopped by the goalkeeper.\r\n                                </li>\r\n                            </ul>\r\n                            <div id=\"glossary-links\">\r\n                                <span>\r\n                                    * <a href=\"https://fbref.com/en/expected-goals-model-explained/\" target=\"_blank\" rel=\"noopener noreferrer\">Expected goals/assists model explanation</a>\r\n                                </span>\r\n                                <span>\r\n                                    ** <a href=\"https://statsbomb.com/2014/06/introducing-possession-adjusted-player-stats/\" target=\"_blank\" rel=\"noopener noreferrer\">Possession adjustment explanation</a>\r\n                                </span>\r\n                                <span>\r\n                                    *** <a href=\"https://statsbomb.com/2018/12/introducing-goalkeeper-radars/\" target=\"_blank\" rel=\"noopener noreferrer\">GSAA % explanation</a>\r\n                                </span>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div id=\"faq\" className=\"homepage-section-container\">\r\n                        <div id=\"faq-section-container\">\r\n                            <h2>F.A.Q.</h2>\r\n                            <div id=\"faq-container\">\r\n                                <div className=\"faq-item\">\r\n                                    <p><span className=\"accented-p\">Where does the data come from?</span></p>\r\n                                    <p>\r\n                                        All stats are from <a href=\"https://www.fbref.com\" target=\"_blank\" rel=\"noopener noreferrer\">FBref.com</a>,\r\n                                        who provide advanced stats courtesy of <a href=\"https://www.statsbomb.com\" target=\"_blank\" rel=\"noopener noreferrer\">StatsBomb</a>.\r\n                                        The metadata is from <a href=\"https://www.whoscored.com\" target=\"_blank\" rel=\"noopener noreferrer\">WhoScored.com</a>.\r\n                                    </p>\r\n                                </div>\r\n                                <div className=\"faq-item\">\r\n                                    <p><span className=\"accented-p\">Who's included in the database? How often is it updated?</span></p>\r\n                                    <p>\r\n                                        The database includes all top 5 league players who've made 4 or more league appearances\r\n                                        in the 2018/19 or 2019/20 seasons. It's updated about once a week.\r\n                                    </p>\r\n                                </div>\r\n                                <div className=\"faq-item\">\r\n                                    <p><span className=\"accented-p\">How are the percentile ranks calculated?</span></p>\r\n                                    <p>\r\n                                        The percentile rank of a score is the percentage of scores within a dataset\r\n                                        that are equal to or lower than the score. This is reversed for stats where\r\n                                        a lower value is better, such as 'times dispossessed'.\r\n                                    </p>\r\n                                    <p>\r\n                                        The percentile ranks for FootballSlices are position-specific. For example,\r\n                                        selecting the 'forward' template compares the selected player only to other forwards in the\r\n                                        database. The percentile ranks are also season-specific. For example, selecting competitions\r\n                                        from the 2018/19 season will only compare the selected player to the 2018/19 dataset. Selecting\r\n                                        competitions from multiple seasons will compare the selected player to the combined dataset.\r\n                                    </p>\r\n                                    <p>\r\n                                        However, please note that the percentile ranks are not competition-specific. In other words,\r\n                                        the selected player's stats are always compared to other players' stats from all competitions, regardless\r\n                                        of which competitions are toggled for the selected player.\r\n                                    </p>\r\n                                </div>\r\n                                <div className=\"faq-item\">\r\n                                    <p><span className=\"accented-p\">How are the possession-adjusted stats calculated?</span></p>\r\n                                    <p>\r\n                                        Defensive stats are adjusted for possession using the StatsBomb sigmoid function,\r\n                                        which you can read more about <a href=\"https://statsbomb.com/2014/06/introducing-possession-adjusted-player-stats/\"\r\n                                                                    target=\"_blank\" rel=\"noopener noreferrer\">here</a>.\r\n                                        Each player's stats for a particular competition are adjusted based on their team's\r\n                                        average possession during said competition.\r\n                                    </p>\r\n                                    <p>\r\n                                        Ideally, a player's stats should be adjusted based on the possession\r\n                                        stats from only the games they played in. However, I don't have access to that\r\n                                        data and so I used the next best thing; which is the team's average possession\r\n                                        across all games in the competition.\r\n                                    </p>\r\n                                </div>\r\n                                <div className=\"faq-item\">\r\n                                    <p><span className=\"accented-p\">How are the player positions decided?</span></p>\r\n                                    <p>\r\n                                        Position data is obtained using the 'detailed' tab of the <a href=\"https://whoscored.com/Statistics\" target=\"_blank\" rel=\"noopener noreferrer\">\r\n                                        WhoScored.com player statistics table</a> to find all players who've made 10 or more\r\n                                        league starts in each of the template positions during a particular season.\r\n                                    </p>\r\n                                </div>\r\n                                <div className=\"faq-item\">\r\n                                    <p><span className=\"accented-p\">\r\n                                        Will the database be expanded to include seasons before 2018/19 and players outside the top 5 leagues?\r\n                                    </span></p>\r\n                                    <p>\r\n                                        Probably not. At present, <a href=\"https://www.fbref.com\" target=\"_blank\" rel=\"noopener noreferrer\">FBref.com</a>'s advanced stats\r\n                                        are only available for a few seasons and leagues.\r\n                                    </p>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    <div id=\"contact\" style={{backgroundColor: '#f5f6f7'}} className=\"homepage-section-container\">\r\n                        <div id=\"contact-section-container\">\r\n                            <h2>Contact</h2>\r\n                            <p>\r\n                                For any bug reports, suggestions or questions, please feel free to reach out to me\r\n                                at either of the following:\r\n                            </p>\r\n                            <ul>\r\n                                <li>Twitter: <a href=\"https://twitter.com/FootballSlices\" target=\"_blank\" rel=\"noopener noreferrer\">@FootballSlices</a></li>\r\n                                <li>Email: <a href=\"mailto:footballslices@gmail.com\" target=\"_blank\" rel=\"noopener noreferrer\">FootballSlices@gmail.com</a></li>\r\n                            </ul>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            );\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default Home;\r\n","import React, { Component } from 'react';\r\n\r\n//import components\r\nimport SearchBar from \"../components/SearchBar\";\r\nimport LoadingSpinner from \"../components/LoadingSpinner\";\r\nimport PlayerSearchResult from \"../components/PlayerSearchResult\";\r\nimport ClubSearchResult from \"../components/ClubSearchResult\";\r\n\r\n\r\n/**\r\n * Search page component\r\n */\r\nclass Search extends Component {\r\n\r\n    //class variable to track if the component is mounted\r\n    _isMounted = false;\r\n\r\n    /**\r\n     * Constructor\r\n     * @param props\r\n     */\r\n    constructor(props){\r\n\r\n        super(props);\r\n\r\n        this.isMobile = this.props.isMobile;\r\n\r\n        this.state = {\r\n            isLoading: true,\r\n            error: null,\r\n            query: props.match.params.query,\r\n            searchByClub: props.match.params.searchByClub,\r\n            playerSearchResults: [],\r\n            filteredPlayerSearchResults: [],\r\n            clubSearchResults: [],\r\n            filterValue: \"\"\r\n        };\r\n\r\n        this.getSearchResults();\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * Called after component has mounted\r\n     */\r\n    componentDidMount() {\r\n        this._isMounted = true;\r\n    }\r\n\r\n\r\n    /**\r\n     * Called just before the component receives new props. This is done to ensure that new props trigger a setState()\r\n     * @param nextProps\r\n     * @param nextContext\r\n     */\r\n    //TODO: re-factor because componentWillReceiveProps has been deprecated\r\n    UNSAFE_componentWillReceiveProps(nextProps, nextContext) {\r\n        let { query, searchByClub } = nextProps.match.params;\r\n        this.setState({\r\n            isLoading: true,\r\n            query: query,\r\n            searchByClub: searchByClub\r\n        }, () => {\r\n            this.getSearchResults();\r\n        });\r\n    }\r\n\r\n\r\n    /**\r\n     * Function to send a post request to the server to retrieve the search results matching the query\r\n     */\r\n    getSearchResults = () => {\r\n\r\n        let searchByClub = this.state.searchByClub;\r\n        let type = searchByClub === undefined ? \"playersAndClubs\" : \"playersByClub\";\r\n\r\n        //retrieve search results\r\n        fetch('/api/search', {\r\n            method: 'post',\r\n            headers: {\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            body: JSON.stringify({\r\n                \"query\": this.state.query,\r\n                \"type\": type\r\n            })\r\n        })\r\n        .then(res => {\r\n            if (res.ok) {\r\n                return res.json()\r\n            }\r\n            else {\r\n               throw new Error(\"Failed to fetch search results. Please refresh the page and try again.\")\r\n            }\r\n        })\r\n        .then(searchResults => this.processSearchResults(searchResults))\r\n        .catch(error => {\r\n            if (this._isMounted){\r\n                this.setState({error, isLoading: false})\r\n            }\r\n        });\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Function to process the search results and save to state\r\n     * @param {Object} searchResults - object containing search results\r\n     */\r\n    processSearchResults = (searchResults) => {\r\n\r\n        let playerSearchResults = searchResults['playerSearchResults'];\r\n        let clubSearchResults = searchResults['clubSearchResults'];\r\n\r\n        if (this._isMounted){\r\n            this.setState({\r\n                error: null,\r\n                isLoading: false,\r\n                playerSearchResults: playerSearchResults,\r\n                filteredPlayerSearchResults: playerSearchResults,\r\n                clubSearchResults: clubSearchResults,\r\n            });\r\n            document.title = \"Search Results | Football Slices\"\r\n        }\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Called just before the component un-mounts\r\n     */\r\n    componentWillUnmount() {\r\n        this._isMounted = false;\r\n    }\r\n\r\n\r\n    /**\r\n     * Function to filter player search results\r\n     * @param {Object} event - the input event from the search result filter\r\n     */\r\n    filterByName = (event) => {\r\n\r\n        //create a deep-copy of playerSearchResults to avoid modifying the original\r\n        let playerSearchResults = JSON.parse(JSON.stringify(this.state.playerSearchResults));\r\n        let filteredPlayerSearchResults = [];\r\n\r\n        let input = \"\";\r\n        if (event === null) {\r\n            filteredPlayerSearchResults = playerSearchResults;\r\n        }\r\n        else {\r\n            //retrieve the input text and remove diacritics\r\n            input = event.target.value\r\n                .normalize(\"NFD\")\r\n                .replace(/[\\u0300-\\u036f]/g, \"\")\r\n                .replace(\"\", \"O\")\r\n                .replace(\"\", \"o\");\r\n            for (let i=0; i<playerSearchResults.length; i++){\r\n                //remove diacritics from each search result\r\n                let name = playerSearchResults[i].name.normalize(\"NFD\")\r\n                    .replace(/[\\u0300-\\u036f]/g, \"\")\r\n                    .replace(\"\", \"O\")\r\n                    .replace(\"\", \"o\");\r\n                //push matches to filteredSearchResults\r\n                if (name.toUpperCase().includes(input.toUpperCase())){\r\n                    filteredPlayerSearchResults.push(playerSearchResults[i]);\r\n                }\r\n            }\r\n        }\r\n\r\n        //set state by clearing filteredSearchResults first, and the re-populating it on callback\r\n        this.setState({\r\n            filteredPlayerSearchResults: [],\r\n            filterValue: input\r\n        }, () => {\r\n            this.setState({\r\n                filteredPlayerSearchResults: filteredPlayerSearchResults,\r\n            })\r\n        });\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * render function\r\n     * @return {*} - JSX code for the search page\r\n     */\r\n    render() {\r\n\r\n        let {\r\n            isLoading,\r\n            error,\r\n            filteredPlayerSearchResults,\r\n            clubSearchResults,\r\n            searchByClub,\r\n            filterValue\r\n        } = this.state;\r\n\r\n        //display loading spinner while the server responds to POST request for the search results\r\n        if (isLoading) {\r\n            return (\r\n                <LoadingSpinner/>\r\n            )\r\n        }\r\n\r\n        //display the error message screen if an error is caught\r\n        else if (error !== null) {\r\n            return (\r\n                <div id=\"main\">\r\n                    <SearchBar\r\n                        isMobile={this.isMobile}\r\n                        page=\"search\"\r\n                        query={this.state.query}\r\n                    />\r\n                    <div className=\"screen\" id=\"error-screen\">\r\n                        <p>{error.message}</p>\r\n                    </div>\r\n                </div>\r\n            )\r\n        }\r\n\r\n        //build search page otherwise\r\n        else {\r\n\r\n            //construct the player cards\r\n            let playerCards = [];\r\n            for (let i=0; i<filteredPlayerSearchResults.length; i++){\r\n                let current = filteredPlayerSearchResults[i];\r\n                playerCards.push(\r\n                    <PlayerSearchResult\r\n                        isMobile={this.isMobile}\r\n                        page=\"search\"\r\n                        code={current.code}\r\n                        name={current.name}\r\n                        age={current.age}\r\n                        clubs={current.clubs}\r\n                        nationality={current.nationality}\r\n                        countryCode={current.countryCode}\r\n                        percentileEntries={current.percentileEntries}\r\n                        key={i}\r\n                    />\r\n                );\r\n            }\r\n\r\n            //construct the club cards\r\n            let clubCards = [];\r\n            for (let i=0; i<clubSearchResults.length; i++){\r\n                let current = clubSearchResults[i];\r\n                clubCards.push(\r\n                    <ClubSearchResult\r\n                        isMobile={this.isMobile}\r\n                        page=\"search\"\r\n                        name={current.name}\r\n                        countryCode={current.countryCode}\r\n                        key={i}\r\n                    />\r\n                )\r\n            }\r\n\r\n            //build header for search results\r\n            let searchText;\r\n            if (searchByClub === undefined){\r\n                searchText = <h3>Search results for <br/>\"{this.state.query}\"</h3>;\r\n            }\r\n            else {\r\n                searchText = <h3>Search results for <br/>\"player.club[19-20] = {this.state.query}\"</h3>;\r\n            }\r\n\r\n            //return JSX code for the search page\r\n            return (\r\n                <div id=\"main\">\r\n                    <SearchBar\r\n                        isMobile={this.isMobile}\r\n                        page=\"search\"\r\n                        query={this.state.query}\r\n                    />\r\n                    <div className=\"screen\" id=\"search-screen\">\r\n                        <div className=\"filter\" id=\"search-filters\">\r\n                            {searchText}\r\n                            <br />\r\n                            <div id=\"search-filter-inputs\">\r\n                                <input\r\n                                    type=\"text\"\r\n                                    value={filterValue}\r\n                                    placeholder={\"Filter players by name\"}\r\n                                    onChange={this.filterByName}\r\n                                />\r\n                            </div>\r\n                        </div>\r\n                        <div className=\"result\" id=\"search-results\">\r\n                            {searchByClub === undefined ? <h3>Players</h3> : null}\r\n                            {playerCards.length === 0 && searchByClub === undefined ? <p>No results found</p> : null}\r\n                            <div id=\"player-search-results\">\r\n                                {playerCards}\r\n                            </div>\r\n                            {searchByClub === undefined ? <h3 style={{marginTop: '20px'}}>Clubs</h3> : null}\r\n                            {clubCards.length === 0 && searchByClub === undefined ? <p>No results found</p> : null}\r\n                            <div id=\"club-search-results\">\r\n                                {clubCards}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            );\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default Search;\r\n","import $ from \"jquery\";\r\n\r\n//import dependencies\r\nimport Cookies from 'universal-cookie';\r\nimport Highcharts from \"highcharts\";\r\nimport domtoimage from \"dom-to-image\";\r\nimport saveAs from \"file-saver\";\r\n\r\n//initialize cookies\r\nconst cookies = new Cookies();\r\n\r\n//initialize helper to stringify JSON objects with circular references\r\n//const stringify = require('json-stringify-safe');\r\n\r\n/**\r\n * Function to filter the complete stats based on the selected competitions\r\n * @param {Object} stats - object containing the complete stats of the player\r\n * @param {String} playerCode - the code of the player whose stats are being filtered (used for comparisons)\r\n * @return {Object} filteredStats - object containing aggregated totals of the filtered stats\r\n */\r\nexport function filterStats(stats, playerCode = undefined){\r\n\r\n    let selectedCompetitions;\r\n    if (playerCode === undefined) {\r\n        selectedCompetitions = this.state.selectedCompetitions;\r\n    }\r\n    else {\r\n        selectedCompetitions = this.state.selectedCompetitions[playerCode];\r\n    }\r\n\r\n    //iterate through complete stats, check if a competition is selected, and add the stats for said competition\r\n    //to the aggregated stats if so\r\n    let filteredStats = {};\r\n    for (let season in stats){\r\n        for (let competition in stats[season]){\r\n            if (selectedCompetitions[season].includes(competition)) {\r\n                for (let stat in stats[season][competition]) {\r\n                    if (!(stat in filteredStats)) {\r\n                        filteredStats[stat] = stats[season][competition][stat];\r\n                    }\r\n                    else {\r\n                        filteredStats[stat] += stats[season][competition][stat];\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    return filteredStats;\r\n\r\n}\r\n\r\n\r\n/**\r\n * Function to calculate the 'per90' stats and percentile ranks of the filtered stats\r\n * @param {Object} filteredStats - object containing the aggregated totals from the selected competitions\r\n * @param playerCode\r\n * @return {{statsPer90, percentiles}} - object containing the per90 stats and percentile ranks\r\n */\r\nexport function calculateStats(filteredStats, playerCode = undefined){\r\n\r\n    let percentileArrays = this.state.percentileArrays;\r\n    let template = this.state.template;\r\n    let selectedCompetitions = this.state.selectedCompetitions;\r\n\r\n    let percentileEntries;\r\n    let selectedSeasons = [];\r\n    if (playerCode === undefined){\r\n\r\n        percentileEntries = this.state.percentileEntries;\r\n\r\n        //iterate through selected competitions and list the seasons they span\r\n        for (let season in selectedCompetitions) {\r\n            if (selectedCompetitions[season].length !== 0) {\r\n                selectedSeasons.push(season);\r\n            }\r\n        }\r\n\r\n    }\r\n    else {\r\n\r\n        percentileEntries = this.state.percentileEntries[playerCode];\r\n        for (let code in selectedCompetitions){\r\n            //iterate through selected competitions and list the seasons they span\r\n            for (let season in selectedCompetitions[code]) {\r\n                if (selectedCompetitions[code][season].length !== 0) {\r\n                    if (!selectedSeasons.includes(season)){\r\n                        selectedSeasons.push(season);\r\n                    }\r\n                }\r\n            }\r\n        }\r\n\r\n    }\r\n\r\n    let percentileSeason;\r\n    //if only one season is selected, set the percentile season to that season\r\n    if (selectedSeasons.length === 1) {\r\n        percentileSeason = selectedSeasons[0];\r\n    }\r\n    //set the percentile season to the combined dataset otherwise\r\n    else {\r\n        percentileSeason = \"combined\";\r\n    }\r\n\r\n    let percentileArrayOccurrences = 0;\r\n    //count how many of the entries in the percentile array belong to the player\r\n    //this is done so that the percentile rank can be adjusted in order not to double count a player's entries\r\n    for (let season in percentileEntries) {\r\n        if (percentileSeason === season || percentileSeason === \"combined\") {\r\n            if (percentileEntries[season].includes(template)) {\r\n                percentileArrayOccurrences = 1;\r\n            }\r\n        }\r\n    }\r\n\r\n    let statsPer90 = {};\r\n    let percentiles = {};\r\n\r\n    //calculate per90 stats\r\n    let minutes = filteredStats['minutes'];\r\n    switch (template) {\r\n        case \"FW\":\r\n            statsPer90[\"npg\"] = filteredStats[\"npg\"] / (minutes / 90);\r\n            statsPer90[\"npxg\"] = filteredStats[\"npxg\"] / (minutes / 90);\r\n            statsPer90[\"npxgPerShot\"] = filteredStats[\"npxg\"] / filteredStats[\"shots\"];\r\n            statsPer90[\"conversionRate\"] = (filteredStats[\"npg\"] / filteredStats[\"shots\"]) * 100;\r\n            statsPer90[\"aerialSuccRate\"] = (filteredStats[\"succAerials\"] / filteredStats[\"attAerials\"]) * 100;\r\n            statsPer90[\"boxTouches\"] = filteredStats[\"boxTouches\"] / (minutes / 90);\r\n            statsPer90[\"xa\"] = filteredStats[\"xa\"] / (minutes / 90);\r\n            statsPer90[\"ppa\"] = filteredStats[\"ppa\"] / (minutes / 90);\r\n            statsPer90[\"succDribbles\"] = filteredStats[\"succDribbles\"] / (minutes / 90);\r\n            statsPer90[\"dribbleSuccRate\"] = (filteredStats[\"succDribbles\"] / filteredStats[\"attDribbles\"]) * 100;\r\n            statsPer90[\"timesDispossessed\"] = filteredStats[\"timesDispossessed\"] / (minutes / 90);\r\n            statsPer90[\"succPressures\"] = filteredStats[\"succPressures\"] / (minutes/90);\r\n            // statsPer90[\"padjSuccPressures\"] = filteredStats[\"padjSuccPressures\"] / (minutes / 90);\r\n            break;\r\n        case \"AM\":\r\n            statsPer90[\"npg\"] = filteredStats[\"npg\"] / (minutes / 90);\r\n            statsPer90[\"npxg\"] = filteredStats[\"npxg\"] / (minutes / 90);\r\n            statsPer90[\"npxgPerShot\"] = filteredStats[\"npxg\"] / filteredStats[\"shots\"];\r\n            statsPer90[\"xa\"] = filteredStats[\"xa\"] / (minutes / 90);\r\n            statsPer90[\"sca\"] = filteredStats[\"sca\"] / (minutes / 90);\r\n            statsPer90[\"ppa\"] = filteredStats[\"ppa\"] / (minutes / 90);\r\n            statsPer90[\"progDistance\"] = filteredStats[\"progDistance\"] / (minutes / 90);\r\n            statsPer90[\"passSuccRate\"] = (filteredStats[\"succPasses\"] / filteredStats[\"attPasses\"]) * 100;\r\n            statsPer90[\"succDribbles\"] = filteredStats[\"succDribbles\"] / (minutes / 90);\r\n            statsPer90[\"dribbleSuccRate\"] = (filteredStats[\"succDribbles\"] / filteredStats[\"attDribbles\"]) * 100;\r\n            statsPer90[\"timesDispossessed\"] = filteredStats[\"timesDispossessed\"] / (minutes / 90);\r\n            statsPer90[\"succPressures\"] = filteredStats[\"succPressures\"] / (minutes/90);\r\n            // statsPer90[\"padjSuccPressures\"] = filteredStats[\"padjSuccPressures\"] / (minutes / 90);\r\n            break;\r\n        case \"CM\":\r\n            statsPer90[\"xa\"] = filteredStats[\"xa\"] / (minutes / 90);\r\n            statsPer90[\"sca\"] = filteredStats[\"sca\"] / (minutes / 90);\r\n            statsPer90[\"pft\"] = filteredStats[\"pft\"] / (minutes / 90);\r\n            statsPer90[\"progDistance\"] = filteredStats[\"progDistance\"] / (minutes / 90);\r\n            statsPer90[\"passSuccRate\"] = (filteredStats[\"succPasses\"] / filteredStats[\"attPasses\"]) * 100;\r\n            statsPer90[\"succDribbles\"] = filteredStats[\"succDribbles\"] / (minutes / 90);\r\n            statsPer90[\"dribbleSuccRate\"] = (filteredStats[\"succDribbles\"] / filteredStats[\"attDribbles\"]) * 100;\r\n            statsPer90[\"timesDispossessed\"] = filteredStats[\"timesDispossessed\"] / (minutes / 90);\r\n            statsPer90[\"succPressures\"] = filteredStats[\"succPressures\"] / (minutes/90);\r\n            // statsPer90[\"padjSuccPressures\"] = filteredStats[\"padjSuccPressures\"] / (minutes / 90);\r\n            // statsPer90[\"interceptions\"] = filteredStats[\"interceptions\"] / (minutes/90);\r\n            statsPer90[\"padjInterceptions\"] = filteredStats[\"padjInterceptions\"] / (minutes / 90);\r\n            // statsPer90[\"tacklesWon\"] = filteredStats[\"tacklesWon\"] / (minutes/90);\r\n            statsPer90[\"padjTacklesWon\"] = filteredStats[\"padjTacklesWon\"] / (minutes / 90);\r\n            statsPer90[\"dribbleTackleRate\"] = (filteredStats[\"succDribbleTackles\"] / filteredStats[\"attDribbleTackles\"]) * 100;\r\n            break;\r\n        case \"FB\":\r\n            statsPer90[\"xa\"] = filteredStats[\"xa\"] / (minutes / 90);\r\n            statsPer90[\"pft\"] = filteredStats[\"pft\"] / (minutes / 90);\r\n            statsPer90[\"progDistance\"] = filteredStats[\"progDistance\"] / (minutes / 90);\r\n            statsPer90[\"passSuccRate\"] = (filteredStats[\"succPasses\"] / filteredStats[\"attPasses\"]) * 100;\r\n            statsPer90[\"succDribbles\"] = filteredStats[\"succDribbles\"] / (minutes / 90);\r\n            statsPer90[\"dribbleSuccRate\"] = (filteredStats[\"succDribbles\"] / filteredStats[\"attDribbles\"]) * 100;\r\n            statsPer90[\"timesDispossessed\"] = filteredStats[\"timesDispossessed\"] / (minutes / 90);\r\n            statsPer90[\"succPressures\"] = filteredStats[\"succPressures\"] / (minutes/90);\r\n            // statsPer90[\"padjSuccPressures\"] = filteredStats[\"padjSuccPressures\"] / (minutes / 90);\r\n            // statsPer90[\"interceptions\"] = filteredStats[\"interceptions\"] / (minutes/90);\r\n            statsPer90[\"padjInterceptions\"] = filteredStats[\"padjInterceptions\"] / (minutes / 90);\r\n            // statsPer90[\"tacklesWon\"] = filteredStats[\"tacklesWon\"] / (minutes/90);\r\n            statsPer90[\"padjTacklesWon\"] = filteredStats[\"padjTacklesWon\"] / (minutes / 90);\r\n            statsPer90[\"dribbleTackleRate\"] = (filteredStats[\"succDribbleTackles\"] / filteredStats[\"attDribbleTackles\"]) * 100;\r\n            statsPer90[\"aerialSuccRate\"] = (filteredStats[\"succAerials\"] / filteredStats[\"attAerials\"]) * 100;\r\n            break;\r\n        case \"CB\":\r\n            statsPer90[\"pft\"] = filteredStats[\"pft\"] / (minutes / 90);\r\n            statsPer90[\"progDistance\"] = filteredStats[\"progDistance\"] / (minutes / 90);\r\n            statsPer90[\"passSuccRate\"] = (filteredStats[\"succPasses\"] / filteredStats[\"attPasses\"]) * 100;\r\n            statsPer90[\"longPassSuccRate\"] = (filteredStats[\"succLongPasses\"] / filteredStats[\"attLongPasses\"]) * 100;\r\n            statsPer90[\"succPressures\"] = filteredStats[\"succPressures\"] / (minutes/90);\r\n            // statsPer90[\"padjSuccPressures\"] = filteredStats[\"padjSuccPressures\"] / (minutes / 90);\r\n            // statsPer90[\"interceptions\"] = filteredStats[\"interceptions\"] / (minutes/90);\r\n            statsPer90[\"padjInterceptions\"] = filteredStats[\"padjInterceptions\"] / (minutes / 90);\r\n            // statsPer90[\"tacklesWon\"] = filteredStats[\"tacklesWon\"] / (minutes/90);\r\n            statsPer90[\"padjTacklesWon\"] = filteredStats[\"padjTacklesWon\"] / (minutes / 90);\r\n            statsPer90[\"dribbleTackleRate\"] = (filteredStats[\"succDribbleTackles\"] / filteredStats[\"attDribbleTackles\"]) * 100;\r\n            // statsPer90[\"fouls\"] = filteredStats[\"fouls\"] / (minutes/90);\r\n            statsPer90[\"padjFouls\"] = filteredStats[\"padjFouls\"] / (minutes / 90);\r\n            statsPer90[\"succAerials\"] = filteredStats[\"succAerials\"] / (minutes / 90);\r\n            statsPer90[\"aerialSuccRate\"] = (filteredStats[\"succAerials\"] / filteredStats[\"attAerials\"]) * 100;\r\n            // statsPer90[\"clearances\"] = filteredStats[\"clearances\"] / (minutes/90);\r\n            statsPer90[\"padjClearances\"] = filteredStats[\"padjClearances\"] / (minutes / 90);\r\n            break;\r\n        case \"GK\":\r\n            statsPer90[\"gsaa\"] = ((filteredStats[\"psxg\"] - filteredStats[\"goalsAgainst\"]) / filteredStats[\"sota\"]) * 100;\r\n            statsPer90[\"crossStopRate\"] = (filteredStats[\"stoppedCrosses\"] / filteredStats[\"attCrosses\"]) * 100;\r\n            statsPer90[\"launchedPassSuccRate\"] = (filteredStats[\"succLaunchedPasses\"] / filteredStats[\"attLaunchedPasses\"]) * 100;\r\n            break;\r\n        default:\r\n            statsPer90[\"npg\"] = 0;\r\n            statsPer90[\"npxg\"] = 0;\r\n            statsPer90[\"npxgPerShot\"] = 0;\r\n            statsPer90[\"conversionRate\"] = 0;\r\n            statsPer90[\"succAerials\"] = 0;\r\n            statsPer90[\"boxTouches\"] = 0;\r\n            statsPer90[\"xa\"] = 0;\r\n            statsPer90[\"ppa\"] = 0;\r\n            statsPer90[\"succDribbles\"] = 0;\r\n            statsPer90[\"dribbleSuccRate\"] = 0;\r\n            statsPer90[\"timesDispossessed\"] = 0;\r\n            // statsPer90[\"succPressures\"] = 0;\r\n            statsPer90[\"padjSuccPressures\"] = 0;\r\n    }\r\n\r\n    // for (let stat in statsPer90){\r\n    //     percentiles[stat] = 100;\r\n    // }\r\n\r\n    //calculate percentile ranks\r\n    if (template !== \"N/A\") {\r\n        for (let stat in statsPer90) {\r\n            if (isFinite(statsPer90[stat])) {\r\n                percentiles[stat] = percentileRank(percentileArrays[percentileSeason][template][stat], statsPer90[stat], percentileArrayOccurrences) * 100;\r\n            }\r\n            //handle cases where the per 90 value is NaN (e.g.: as a result of divide by 0 error)\r\n            else {\r\n                statsPer90[stat] = 0;\r\n                percentiles[stat] = 0;\r\n            }\r\n            //reverse percentile ranks for \"less is better\" stats\r\n            if (stat === \"padjFouls\" || stat === \"timesDispossessed\") {\r\n                percentiles[stat] = 100 - percentiles[stat];\r\n            }\r\n        }\r\n    }\r\n    else {\r\n        for (let stat in statsPer90) {\r\n            percentiles[stat] = 0;\r\n        }\r\n    }\r\n\r\n    return {\r\n        statsPer90: statsPer90,\r\n        percentiles: percentiles\r\n    };\r\n\r\n}\r\n\r\n\r\n/**\r\n * Function to calculate the percentile rank of a given value within a given array\r\n * @param {Array} array - the array of values\r\n * @param {number} value - the value for which the percentile rank is being calculated\r\n * @param {Integer} occurrences - the number of occurrences of the player's numbers within the percentile array\r\n * @return {number} the percentile rank of the value in the array (adjusted for the double-counting problem)\r\n */\r\nfunction percentileRank(array, value, occurrences){\r\n\r\n    //taken from: https://gist.github.com/IceCreamYou/6ffa1b18c4c8f6aeaad2\r\n    if (!isFinite(value)){\r\n        value = 0;\r\n    }\r\n    for (let i = 0, length = array.length; i < length; i++) {\r\n        if (value < array[i]) {\r\n            while (i < length && value === array[i]) i++;\r\n            if (i === 0) return 0;\r\n            if (value !== array[i-1]) {\r\n                i += (value - array[i-1]) / (array[i] - array[i-1]);\r\n            }\r\n            //adjust the returned percentile by disregarding the entries that belong to the player\r\n            return (i / length) - (occurrences/array.length);\r\n        }\r\n    }\r\n    return 1;\r\n\r\n}\r\n\r\n\r\n/**\r\n * Function to construct the input given to the Highcharts component\r\n * @param {Object} statsPer90 - object containing the per90 stats\r\n * @param {Object} percentiles - object containing the percentile ranks\r\n * @param playerCode\r\n * @param playerName\r\n * @param playerAge\r\n * @param minutes\r\n * @param index\r\n * @return {Array} chartInput - array containing information for each data point in the Highcharts plot\r\n */\r\nexport function constructChartInput(statsPer90, percentiles, playerCode, playerName, playerAge, minutes, index){\r\n\r\n    //colors used in the Slices\r\n    const colorArrays = {\r\n        \"FW\": ['#f15c80', '#f15c80', '#f15c80', '#f15c80', '#f15c80', '#e4d354',\r\n            '#e4d354', '#e4d354', '#90ed7d', '#90ed7d', '#90ed7d', '#7cb5ec'],\r\n        \"AM\": ['#f15c80', '#f15c80', '#f15c80', '#e4d354', '#e4d354', '#e4d354',\r\n            '#e4d354', '#e4d354', '#90ed7d', '#90ed7d', '#90ed7d', '#7cb5ec'],\r\n        \"CM\": ['#e4d354', '#e4d354', '#e4d354', '#e4d354', '#e4d354', '#90ed7d',\r\n            '#90ed7d', '#90ed7d', '#7cb5ec', '#7cb5ec', '#7cb5ec', '#7cb5ec'],\r\n        \"FB\": ['#e4d354', '#e4d354', '#e4d354', '#e4d354', '#90ed7d', '#90ed7d',\r\n            '#90ed7d', '#7cb5ec', '#7cb5ec', '#7cb5ec', '#7cb5ec', '#7cb5ec'],\r\n        \"CB\": ['#e4d354', '#e4d354', '#e4d354', '#e4d354', '#7cb5ec', '#7cb5ec',\r\n            '#7cb5ec', '#7cb5ec', '#7cb5ec', '#7cb5ec', '#7cb5ec', '#7cb5ec'],\r\n        \"GK\": ['#9499ff', '#9499ff', '#e4d354'],\r\n        \"N/A\": ['#7cb5ec', '#7cb5ec', '#7cb5ec', '#7cb5ec', '#7cb5ec', '#7cb5ec',\r\n            '#7cb5ec', '#7cb5ec', '#7cb5ec', '#7cb5ec', '#7cb5ec', '#7cb5ec'],\r\n        null: ['#7cb5ec', '#7cb5ec', '#7cb5ec', '#7cb5ec', '#7cb5ec', '#7cb5ec',\r\n            '#7cb5ec', '#7cb5ec', '#7cb5ec', '#7cb5ec', '#7cb5ec', '#7cb5ec']\r\n    };\r\n\r\n    const alignments = {\r\n        \"vertical\": {\r\n            \"GK\": [\"bottom\", \"top\", \"top\"],\r\n            \"other\": [\"bottom\", \"middle\", \"middle\", \"middle\", \"middle\", \"top\",\r\n                \"top\", \"top\", \"middle\", \"middle\", \"middle\", \"bottom\"\r\n            ]\r\n        },\r\n        \"horizontal\": {\r\n            \"GK\": [\"center\", \"left\", \"right\"],\r\n            \"other\": [\"center\", \"left\", \"left\", \"left\", \"left\", \"center\",\r\n                \"center\", \"center\", \"right\", \"right\", \"right\", \"center\"\r\n            ]\r\n        }\r\n    };\r\n\r\n    let template = this.state.template;\r\n    let colors = colorArrays[template];\r\n    let verticalAlignments = alignments['vertical'][template === \"GK\" ? \"GK\" : \"other\"];\r\n    let horizontalAlignments = alignments['horizontal'][template === \"GK\" ? \"GK\" : \"other\"];\r\n\r\n    let isSecondPlayer = index === 1;\r\n\r\n    //remove unnecessary precision from the per90 labels and the percentile ranks\r\n    let p90_labels = truncate(statsPer90);\r\n    let percentile_labels = roundNumbers(percentiles, 0);\r\n\r\n    //iterate through per90 stats and percentile ranks and construct objects for each point on the Highcharts plot\r\n    let chartInput = [];\r\n    let i = 0;\r\n    for (let key in percentiles){\r\n        chartInput[i] = {\r\n            playerName: playerCode !== undefined ? playerName : null,\r\n            y: percentiles[key],\r\n            p90_label: p90_labels[key],\r\n            percentile_label: ordinalSuffix(percentile_labels[key]),\r\n            dataLabels: {\r\n                align: horizontalAlignments[i],\r\n                verticalAlign: verticalAlignments[i]\r\n            },\r\n            color: Highcharts.Color(colors[i]).setOpacity(index !== 1 ? 0.85 : 0).get(),\r\n            borderColor: isSecondPlayer ? 'black' : null,\r\n            borderWidth: isSecondPlayer ? 6 : 0\r\n        };\r\n        i++;\r\n    }\r\n    return chartInput;\r\n\r\n}\r\n\r\n\r\n/**\r\n * Function to truncate all values in an object to 3 digits\r\n * @param {Object} someStats - object containing the values that need to be reduced to 3 digits\r\n * @return {Object} threeDigitStats - object containing value of someStats reduced to 3 digits\r\n */\r\nfunction truncate(someStats){\r\n\r\n    let threeDigitStats = {};\r\n\r\n    for (let stat in someStats){\r\n        let precision;\r\n        if (\r\n            stat === \"progDistance\" ||\r\n            someStats[stat] === 0\r\n        ) {\r\n            precision = 0;\r\n        }\r\n        else if (\r\n            stat === \"conversionRate\" ||\r\n            stat === \"aerialSuccRate\" ||\r\n            stat === \"dribbleSuccRate\" ||\r\n            stat === \"passSuccRate\" ||\r\n            stat === \"dribbleTackleRate\" ||\r\n            stat === \"longPassSuccRate\" ||\r\n            stat === \"launchedPassSuccRate\"\r\n        ) {\r\n            precision = 1;\r\n        }\r\n        else if (\r\n            stat === \"npxgPerShot\"\r\n        ){\r\n            precision = 3;\r\n        }\r\n        else {\r\n            precision = 2;\r\n        }\r\n        threeDigitStats[stat] = parseFloat(Math.round(someStats[stat] * (10**precision)) / (10**precision)).toFixed(precision);\r\n    }\r\n    return threeDigitStats;\r\n\r\n}\r\n\r\n\r\n/**\r\n * Function to round all values in an object to a specified precision\r\n * @param {Object} someStats - object containing the values that need to be rounded\r\n * @param {number} precision - the number of decimal places each number should be rounded to\r\n * @return {Object}\r\n */\r\nfunction roundNumbers(someStats, precision){\r\n\r\n    let roundedStats = {};\r\n\r\n    for (let stat in someStats){\r\n        roundedStats[stat] = Math.round(someStats[stat] * (10**precision)) / (10**precision);\r\n    }\r\n\r\n    return roundedStats;\r\n\r\n}\r\n\r\n\r\n/**\r\n * Function to append an ordinal suffix (-st, -nd, -rd, -th) to numbers\r\n * @param {number} aNumber - the number to which the ordinal suffix is being appended\r\n * @return {string} - the number with the ordinal suffix appended to it\r\n */\r\nfunction ordinalSuffix(aNumber){\r\n\r\n    //taken from: https://stackoverflow.com/questions/13627308/add-st-nd-rd-and-th-ordinal-suffix-to-a-number\r\n    let j = aNumber % 10,\r\n        k = aNumber % 100;\r\n    if (j === 1 && k !== 11) {\r\n        return aNumber + \"st\";\r\n    }\r\n    if (j === 2 && k !== 12) {\r\n        return aNumber + \"nd\";\r\n    }\r\n    if (j === 3 && k !== 13) {\r\n        return aNumber + \"rd\";\r\n    }\r\n    return aNumber + \"th\";\r\n\r\n}\r\n\r\n\r\n/**\r\n * Function to change the selected template\r\n * @param {Object} event - the input event from the template form\r\n */\r\nexport function changeTemplate(event){\r\n\r\n    let template = event.target.value;\r\n\r\n    this.setState({\r\n        template: template,\r\n        isAnimated: true\r\n    });\r\n\r\n}\r\n\r\n\r\n/**\r\n * Function to change the list of selected competitions\r\n * @param {Object} event - the input event from the competitions form\r\n */\r\nexport function changeSelectedCompetitions(event){\r\n\r\n    let clickedValues = event.target.value.split(\"_\");\r\n    let selectedCompetitions = this.state.selectedCompetitions;\r\n\r\n    //check if the function was called from a 'compare' page, where the checkbox values include an extra value\r\n    let forComparison = clickedValues.length > 2;\r\n\r\n    //retrieve the information of the clicked checkbox\r\n    let code;\r\n    let entry;\r\n    let clickedSeason;\r\n    let clickedCompetition;\r\n    let isLastCompetition = false;\r\n\r\n    //retrieve the season and competition from the clicked checkbox\r\n    clickedSeason = clickedValues[0];\r\n    clickedCompetition = clickedValues[1];\r\n\r\n    //if so, retrieve the player code from the clicked checkbox\r\n    if (forComparison) {\r\n        code = clickedValues[2];\r\n        entry = selectedCompetitions[code][clickedSeason];\r\n        //determine if the click competition is the last checked competition\r\n        let counter = 0;\r\n        for (let season in selectedCompetitions[code]) {\r\n            counter += selectedCompetitions[code][season].length;\r\n        }\r\n        isLastCompetition = counter === 1;\r\n    }\r\n    else {\r\n        entry = selectedCompetitions[clickedSeason];\r\n    }\r\n\r\n    //remove the clicked competition from selected competitions if it is already included\r\n    //don't remove a clicked competition if it is the last checked competition of a player on a compare page\r\n    if (entry.includes(clickedCompetition) && !isLastCompetition){\r\n        entry.splice(entry.indexOf(clickedCompetition), 1);\r\n    }\r\n    //add it otherwise\r\n    else {\r\n        if (!entry.includes(clickedCompetition)){\r\n            entry.push(clickedCompetition);\r\n        }\r\n    }\r\n\r\n    this.setState({\r\n        selectedCompetitions: selectedCompetitions,\r\n        isAnimated: true\r\n    });\r\n\r\n}\r\n\r\n\r\n/**\r\n * Function to change the type of data labels\r\n * @param {Object} event - the input event from the data labels form\r\n */\r\nexport function changeLabelType(event){\r\n\r\n    let labelType = event.target.value;\r\n\r\n    cookies.set('labelType', labelType, {path: '/'});\r\n\r\n    this.setState({\r\n        labelType: labelType,\r\n        isAnimated: false\r\n    })\r\n\r\n}\r\n\r\n\r\n/**\r\n * Function to change the position of the credits at the bottom of the Slice container\r\n */\r\nexport function toggleCreditsPosition(){\r\n\r\n    let oldPosition = this.state.creditsPosition;\r\n    let newPosition = oldPosition === \"right\" ? \"center\" : \"right\";\r\n\r\n    cookies.set('creditsPosition', newPosition, {path: '/'});\r\n    this.setState({\r\n        isAnimated: false,\r\n        creditsPosition: newPosition\r\n    })\r\n\r\n}\r\n\r\n\r\n/**\r\n * Function to export the chart in a standardized 2400 * 2200 downloadable PNG format\r\n * Triggers the page to temporarily load a second slice to the \"#export\" div, which has fixed height and width\r\n * Passes the second slice to the \"dom-to-image\" package, which converts it to an image (with 4x scaling)\r\n * Adds the FootballSlices watermark to the exported image\r\n * @return {Promise<void>}\r\n */\r\nexport async function exportChart(){\r\n\r\n    //render the second slice and then export it.\r\n    //callback executes after the page has re-rendered with the second slice\r\n    this.setState({\r\n        showExportLoaderOverlay: true,\r\n        renderForExport: true\r\n    }, () => {\r\n\r\n        let name = this.state.name;\r\n        if (name === undefined) {\r\n            name = Object.values(this.state.names).join(\"-vs-\");\r\n        }\r\n\r\n        const node = document.getElementById('export');\r\n\r\n        domtoimage.toPng(node, {\r\n            bgcolor: '#fafbfc',\r\n            width: 1200,\r\n            height: 1100,\r\n            style: {\r\n                //make the export div visible\r\n                'opacity': '1',\r\n                'transform': `scale(1)`,\r\n            }\r\n        })\r\n            .then(async (blob) => {\r\n                //download the image and revert 'renderForExport' to false so the second slice doesn't continue being updated\r\n                saveAs(blob, `${name.replace(\" \", \"-\")}.png`);\r\n                setTimeout(() => {\r\n                    this.setState({\r\n                        showExportLoaderOverlay: false,\r\n                        renderForExport: false\r\n                    })\r\n                }, 1000);\r\n            })\r\n            .catch(function (error) {\r\n                console.log(error);\r\n                alert(\"An error occurred while exporting. Please refresh the page and try again.\")\r\n            });\r\n\r\n    });\r\n\r\n}\r\n\r\n/**\r\n * Function to the show the search dialog for the comparison functionality\r\n */\r\nexport function toggleCompareSearch(){\r\n\r\n    let currentState = this.state.showCompareSearchOverlay;\r\n\r\n    this.setState({\r\n        showCompareSearchOverlay: !currentState\r\n    });\r\n\r\n    if (!this.isMobile){\r\n        $(\"#compare-search-screen #searchbar-input\").focus()\r\n    }\r\n\r\n}\r\n\r\n","import React, {Component} from 'react';\r\nimport Collapsible from 'react-collapsible';\r\n\r\n/**\r\n * Component to render the options for the displayed slice\r\n */\r\nclass SliceOptions extends Component {\r\n\r\n    constructor(props) {\r\n\r\n        super(props);\r\n\r\n        this.isMobile = this.props.isMobile;\r\n        this.templateOpen = this.props.template === \"N/A\";\r\n        this.competitions = this.props.competitions;\r\n        this.codes = this.props.codes;\r\n        this.names = this.props.names;\r\n        this.clubs = this.props.clubs;\r\n\r\n        this.positions = {};\r\n        if (this.isMobile){\r\n            this.positions = {\r\n                \"FW\": \"FW\",\r\n                \"AM\": \"AM\",\r\n                \"CM\": \"CM / DM\",\r\n                \"FB\": \"FB\",\r\n                \"CB\": \"CB\",\r\n                \"GK\": \"GK\"\r\n            };\r\n        }\r\n        else {\r\n            this.positions = {\r\n                \"FW\": \"Forward\",\r\n                \"AM\": \"Attacking Midfielder / Winger\",\r\n                \"CM\": \"Central / Defensive Midfielder\",\r\n                \"FB\": \"Full-back\",\r\n                \"CB\": \"Center-back\",\r\n                \"GK\": \"Goalkeeper\"\r\n            };\r\n        }\r\n\r\n        this.labelTypes = {\r\n            \"raw\": \"Raw Values\",\r\n            \"percentiles\": \"Percentile Ranks\"\r\n        };\r\n\r\n        this.state = {\r\n        };\r\n\r\n    }\r\n\r\n    constructPlayerCompetitions = (forComparison, code) => {\r\n\r\n        let competitions = forComparison ? this.competitions[code] : this.competitions;\r\n        let clubs = forComparison ? this.clubs[code] : this.clubs;\r\n        let selectedCompetitions = forComparison ? this.props.selectedCompetitions[code] : this.props.selectedCompetitions;\r\n\r\n        let competitionsForms = [];\r\n        let counter = 0;\r\n        for (let season in competitions){\r\n            let competitionLabels = [];\r\n            let multipleClubs = clubs[season].length !== 1;\r\n            competitionsForms.push(\r\n                <h4\r\n                    key={`${season}_header`}\r\n                    style={{\r\n                        marginBottom: this.isMobile ? '20px' : '10px',\r\n                        marginTop: (counter === 0) ? (this.isMobile ? '15px' : '10px') : (this.isMobile ? '20px' : '12px')\r\n                    }}\r\n                >\r\n                    {season.replace(\"-\", \"/\")} {multipleClubs === false ? ' | ' + clubs[season][0] : null}\r\n                </h4>\r\n            );\r\n            for (let i=0; i<competitions[season].length; i++){\r\n                let currentCompetition = competitions[season][i];\r\n                let isIncluded = selectedCompetitions[season].includes(currentCompetition);\r\n                let label = currentCompetition;\r\n                if (clubs[season].length === 1){\r\n                    label = label.substring(0, label.indexOf(\"|\")-1)\r\n                }\r\n                competitionLabels.push(\r\n                    <label\r\n                        className={`${isIncluded ? \"selected-label\" : null} selectable-label`}\r\n                        key={forComparison ? `${season}_${currentCompetition}_${code}` : `${season}_${currentCompetition}`}\r\n                    >\r\n                        <input className=\"competition\"\r\n                               type=\"checkbox\"\r\n                               value={forComparison ? `${season}_${currentCompetition}_${code}` : `${season}_${currentCompetition}`}\r\n                               onChange={this.props.changeSelectedCompetitions}\r\n                               checked={isIncluded}\r\n                        /> {label}\r\n                    </label>\r\n                )\r\n            }\r\n            competitionsForms.push(<form key={forComparison ? `${code}_${season}_form` : `${season}_form`} className=\"competitions\">{competitionLabels}</form>);\r\n            counter++;\r\n        }\r\n\r\n        return competitionsForms;\r\n\r\n    };\r\n\r\n    /**\r\n     * render function\r\n     * @return {*} - JSX code for the slice options\r\n     */\r\n    render() {\r\n\r\n        let template = this.props.template;\r\n        let labelType = this.props.labelType;\r\n\r\n        //construct templates form\r\n        let templateLabels = [];\r\n        let mobileTemplateLabels = [];\r\n        for (let position in this.positions){\r\n            let className;\r\n            let mobileClassName;\r\n            let disabled;\r\n            if (position !== \"GK\"){\r\n                className = template !== \"GK\" ? \"selectable-label\" : \"blocked-label\";\r\n                mobileClassName = `${template === position ? \"selected-label\" : null} ${template !== \"GK\" ? \"selectable-label\" : null}`;\r\n                disabled = template === \"GK\";\r\n            }\r\n            else {\r\n                className = template === \"GK\" ? \"selectable-label\" : \"blocked-label\";\r\n                mobileClassName = `${template === position ? \"selected-label\" : null} ${template === \"GK\" ? \"selectable-label\" : null}`;\r\n                disabled = template !== \"GK\";\r\n            }\r\n            templateLabels.push(\r\n                <label\r\n                    className={className}\r\n                    key={`${position}_label`}\r\n                >\r\n                    <input type=\"radio\"\r\n                           name=\"template\"\r\n                           value={position}\r\n                           checked={template === position}\r\n                           disabled={disabled}\r\n                           onChange={this.props.changeTemplate}\r\n                    /> {this.positions[position]}\r\n                </label>\r\n            );\r\n            mobileTemplateLabels.push(\r\n                <label\r\n                    className={mobileClassName}\r\n                    key={`${position}_label_mobile`}\r\n                >\r\n                    <input type=\"radio\"\r\n                           name=\"template\"\r\n                           value={position}\r\n                           checked={template === position}\r\n                           disabled={disabled}\r\n                           onChange={this.props.changeTemplate}\r\n                    /> {this.positions[position]}\r\n                </label>\r\n            );\r\n        }\r\n        let templatesForm = <form id=\"templates\">{templateLabels}</form>;\r\n        let mobileTemplatesForm = <form id=\"templates\">{mobileTemplateLabels}</form>;\r\n\r\n        //construct competitions forms\r\n        let competitionsForms = [];\r\n        let playerCompetitions;\r\n        if (this.codes !== undefined){\r\n            playerCompetitions = {};\r\n            for (let i=0; i<this.codes.length; i++){\r\n                let code = this.codes[i];\r\n                playerCompetitions[code] = this.constructPlayerCompetitions(true, code);\r\n                competitionsForms.push(\r\n                    <Collapsible\r\n                        key={`Competitions (${code})`}\r\n                        open={!this.templateOpen && !this.isMobile}\r\n                        trigger={`Competitions (${this.names[this.codes[i]]})`}\r\n                        className=\"chart-filter-headers\"\r\n                        transitionTime={200}\r\n                        transitionCloseTime={200}\r\n                    >\r\n                        {playerCompetitions[code]}\r\n                    </Collapsible>\r\n                )\r\n            }\r\n        }\r\n        else {\r\n            playerCompetitions = this.constructPlayerCompetitions(false);\r\n            competitionsForms.push(\r\n                <Collapsible\r\n                    key={\"_\"}\r\n                    open={!this.templateOpen && !this.isMobile}\r\n                    trigger={`Competitions`}\r\n                    className=\"chart-filter-headers\"\r\n                    transitionTime={200}\r\n                    transitionCloseTime={200}\r\n                >\r\n                    {playerCompetitions}\r\n                </Collapsible>\r\n            )\r\n        }\r\n\r\n        //construct label type form\r\n        let labelTypeLabels = [];\r\n        for (let type in this.labelTypes){\r\n            labelTypeLabels.push(\r\n                <label\r\n                    className={`selectable-label ${labelType === type ? \"selected-label\" : null}`}\r\n                    key={type}\r\n                >\r\n                    <input\r\n                        type=\"radio\"\r\n                        name=\"labelType\"\r\n                        value={type}\r\n                        checked={labelType === type}\r\n                        onChange={this.props.changeLabelType}\r\n                    /> {this.labelTypes[type]}\r\n                </label>\r\n            )\r\n        }\r\n        let labelTypeForm = <form id=\"data-labels\">{labelTypeLabels}</form>;\r\n\r\n        return (\r\n            <div className=\"filter\" id=\"chart-filters\">\r\n                <div className=\"chart-filter-inputs\" id=\"chart-filter-inputs-laptop\">\r\n                    <Collapsible\r\n                        open={this.templateOpen}\r\n                        trigger=\"Template\"\r\n                        className=\"chart-filter-headers\"\r\n                        transitionTime={200}\r\n                        transitionCloseTime={200}\r\n                    >\r\n                        {templatesForm}\r\n                    </Collapsible>\r\n                    {competitionsForms}\r\n                    <Collapsible\r\n                        open={false}\r\n                        trigger=\"Data Labels\"\r\n                        className=\"chart-filter-headers\"\r\n                        transitionTime={200}\r\n                        transitionCloseTime={200}\r\n                    >\r\n                        {labelTypeForm}\r\n                    </Collapsible>\r\n                </div>\r\n                <div className=\"chart-filter-inputs\" id=\"chart-filter-inputs-mobile\">\r\n                    <Collapsible\r\n                        open={false}\r\n                        trigger=\"Template\"\r\n                        className=\"chart-filter-headers\"\r\n                        transitionTime={200}\r\n                        transitionCloseTime={200}\r\n                    >\r\n                        {mobileTemplatesForm}\r\n                    </Collapsible>\r\n                    {competitionsForms}\r\n                    <Collapsible\r\n                        open={false}\r\n                        trigger=\"Data Labels\"\r\n                        className=\"chart-filter-headers\"\r\n                        transitionTime={200}\r\n                        transitionCloseTime={200}\r\n                    >\r\n                        {labelTypeForm}\r\n                    </Collapsible>\r\n                </div>\r\n                <div id=\"filter-buttons\">\r\n                    <div className=\"filter-button\">\r\n                        <button id=\"toggleCreditsButton\" type=\"button\" onClick={this.props.toggleCreditsPosition}>Toggle Credits Position</button>\r\n                    </div>\r\n                    <div className=\"filter-button\">\r\n                        <button id=\"compareButton\" type=\"button\" onClick={this.props.toggleCompareSearch}>Compare</button>\r\n                    </div>\r\n                    <div className=\"filter-button\">\r\n                        <button id=\"exportButton\" type=\"button\" onClick={this.props.exportChart}>Export Chart</button>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        )\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default (SliceOptions);\r\n","import React, {Component} from 'react';\r\n\r\n//import dependencies\r\nimport Highcharts from 'highcharts/highstock'\r\nimport HighchartsReact from 'highcharts-react-official'\r\nimport HighchartsMore from 'highcharts/highcharts-more'\r\nimport $ from \"jquery\"\r\nHighchartsMore(Highcharts);\r\n\r\n\r\n/**\r\n * Component to render Slices (charts)\r\n */\r\nclass Slice extends Component {\r\n\r\n    constructor(props) {\r\n\r\n        super(props);\r\n\r\n        this.isMobile = this.props.isMobile;\r\n        this.isForExport = this.props.isForExport;\r\n        this.isForComparison = this.props.isForComparison;\r\n\r\n        //set font size constants\r\n        this.fontSizes = undefined;\r\n        if (this.isForExport){\r\n            this.fontSizes =  {\r\n                title: this.isMobile ? '4.6vw' : '2.3em',\r\n                subtitle: '2em',\r\n                noData: '1.76em',\r\n                xAxisLabels: '1.8em',\r\n                dataLabels: '1.95em',\r\n                dataLabelsOutline: '0.13em',\r\n                tooltipHeader: '0em',\r\n                tooltip: '0em',\r\n                legend: '1.6em',\r\n                credits: '1.5em',\r\n                yAxisLabels: '0.65em'\r\n            };\r\n        }\r\n        else {\r\n            this.fontSizes =  {\r\n                title: this.isMobile ? '4vw' : '1.7em',\r\n                subtitle: this.isMobile ? '2.6vw' : '1.4em',\r\n                noData: this.isMobile ? '2.7vw' : '1.35em',\r\n                xAxisLabels: this.isMobile ? '2.3vw' : '1.15em',\r\n                dataLabels: this.isMobile ? '2.3vw' : '1.15em',\r\n                dataLabelsOutline: this.isMobile ? '0.3vw' : '0.18em',\r\n                tooltipHeader: this.isMobile ? '2.3vw' : '1em',\r\n                tooltip: this.isMobile ? '2.3vw' : '1.25em',\r\n                legend: this.isMobile ? '2.8vw' : '1.4em',\r\n                legendTitle: this.isMobile ? '2vw' : '1em',\r\n                credits: this.isMobile ? '2.3vw' : '1.2em',\r\n                yAxisLabels: this.isMobile ? '1vw' : '0.5em'\r\n            };\r\n        }\r\n\r\n        //set categories (x-axis labels) constants\r\n        this.categories = {\r\n            \"FW\": [\r\n                'Non-Penalty Goals',\r\n                'Non-Penalty xG',\r\n                'Non-Penalty xG/Shot',\r\n                `${this.isMobile && !this.isForExport ? \"Conver-sion Rate\" : \"Conversion Rate\"}`,\r\n                'Aerial Win %',\r\n                'Touches in Box',\r\n                'xA',\r\n                'Passes into Box',\r\n                'Successful Dribbles',\r\n                'Dribble Success %',\r\n                'Times Dispossessed',\r\n                'Successful Pressures',\r\n            ],\r\n            \"AM\": [\r\n                'Non-Penalty Goals',\r\n                'Non-Penalty xG',\r\n                'Non-Penalty xG/Shot',\r\n                'xA',\r\n                'OP Shot-Creating Actions',\r\n                'Passes into Box',\r\n                'Progressive Distance',\r\n                `${this.isMobile && !this.isForExport ? \"Pass Comp. %\" : \"Pass Completion %\"}`,\r\n                'Successful Dribbles',\r\n                'Dribble Success %',\r\n                'Times Dispossessed',\r\n                'Successful Pressures',\r\n            ],\r\n            \"CM\": [\r\n                'xA',\r\n                'OP Shot-Creating Actions',\r\n                'Passes into Final 1/3',\r\n                `${this.isMobile && !this.isForExport ? \"Prog-ressive Distance\" : \"Progressive Distance\"}`,\r\n                `${this.isMobile && !this.isForExport ? \"Pass Comp. %\" : \"Pass Completion %\"}`,\r\n                'Successful Dribbles',\r\n                'Dribble Success %',\r\n                'Times Dispossessed',\r\n                'Successful Pressures',\r\n                `${this.isMobile && !this.isForExport ? \"(pAdj) Inter-ceptions\" : \"(pAdj) Interceptions\"}`,\r\n                '(pAdj) Tackles Won',\r\n                `${this.isForExport ? \"Tackle/Dribbled Past %\" : \"Tackle/ Dribbled Past %\"}`\r\n            ],\r\n            \"FB\": [\r\n                'xA',\r\n                'Passes into Final 1/3',\r\n                'Progressive Distance',\r\n                `${this.isMobile && !this.isForExport ? \"Pass Comp. %\" : \"Pass Completion %\"}`,\r\n                'Successful Dribbles',\r\n                'Dribble Success %',\r\n                'Times Dispossessed',\r\n                'Successful Pressures',\r\n                '(pAdj) Interceptions',\r\n                \"(pAdj) Tackles Won\",\r\n                `${this.isForExport ? \"Tackle/Dribbled Past %\" : \"Tackle/ Dribbled Past %\"}`,\r\n                'Aerial Win %'\r\n            ],\r\n            \"CB\": [\r\n                'Passes into Final 1/3',\r\n                'Progressive Distance',\r\n                `${this.isMobile && !this.isForExport ? \"Pass Comp. %\" : \"Pass Completion %\"}`,\r\n                `${this.isMobile && !this.isForExport ? \"Long Pass Comp. %\" : \"Long Pass Completion %\"}`,\r\n                'Successful Pressures',\r\n                '(pAdj) Interceptions',\r\n                '(pAdj) Tackles Won',\r\n                `${this.isForExport ? \"Tackle/Dribbled Past %\" : \"Tackle/ Dribbled Past %\"}`,\r\n                '(pAdj) Fouls Committed',\r\n                'Aerials Won',\r\n                'Aerial Win %',\r\n                '(pAdj) Clearances'\r\n            ],\r\n            \"GK\": [\r\n                \"GSAA %\",\r\n                \"Cross Stopping %\",\r\n                \"Launched Pass Completion %\"\r\n            ],\r\n            \"N/A\": [\r\n                \"-\",\r\n                \"-\",\r\n                \"-\",\r\n                \"-\",\r\n                \"-\",\r\n                \"-\",\r\n                \"-\",\r\n                \"-\",\r\n                \"-\",\r\n                \"-\",\r\n                \"-\",\r\n                \"-\"\r\n            ]\r\n        };\r\n\r\n        // this.titleClassNames = {\r\n        //     \"FW\": \"multi-color-1\",\r\n        //     \"AM\": \"multi-color-1\",\r\n        //     \"CM\": \"multi-color-2\",\r\n        //     \"FB\": \"multi-color-2\",\r\n        //     \"CB\": \"multi-color-3\",\r\n        //     \"GK\": \"multi-color-4\",\r\n        //     \"N/A\": \"multi-color-1\"\r\n        // };\r\n\r\n        this.titleColors = {\r\n            \"FW\": ['#f15c80', '#e4d354', '#90ed7d', '#7cb5ec'],\r\n            \"AM\": ['#f15c80', '#e4d354', '#90ed7d', '#7cb5ec'],\r\n            \"CM\": ['#e4d354', '#90ed7d', '#7cb5ec'],\r\n            \"FB\": ['#e4d354', '#90ed7d', '#7cb5ec'],\r\n            \"CB\": ['#e4d354', '#7cb5ec'],\r\n            \"GK\": ['#9499ff', '#e4d354'],\r\n            \"N/A\": ['#000000'],\r\n        };\r\n\r\n        this.primaryColors = {\r\n            \"FW\": '#f15c80',\r\n            \"AM\": '#e4d354',\r\n            \"CM\": '#e4d354',\r\n            \"FB\": '#7cb5ec',\r\n            \"CB\": '#7cb5ec',\r\n            \"GK\": '#9499ff',\r\n            \"N/A\": '#000000',\r\n        };\r\n\r\n        //set subtitle constants\r\n        this.subtitles = {\r\n            \"FW\": \"vs Top-5 League Players with 10+ Starts as <b>Forwards</b>\",\r\n            \"AM\": \"vs Top-5 League Players with 10+ Starts as <b>Attacking Midfielders / Wingers</b>\",\r\n            \"CM\": \"vs Top-5 League Players with 10+ Starts as <b>Central / Defensive Midfielders</b>\",\r\n            \"FB\": \"vs Top-5 League Players with 10+ Starts as <b>Full-backs</b>\",\r\n            \"CB\": \"vs Top-5 League Players with 10+ Starts as <b>Center-backs</b>\",\r\n            \"GK\": \"vs Top-5 League Players with 10+ Starts as <b>Goalkeepers</b>\",\r\n            \"N/A\": \"No Template Selected\"\r\n        };\r\n\r\n        //calculate the start angle based on the number of wedges\r\n        //the goal is to have the first wedge pointing to 0 degrees\r\n        let startAngle = -((360/this.categories[this.props.template].length)/2);\r\n\r\n        //add a link to the credits if the chart is not for export\r\n        let chartEvents;\r\n        if (!this.isForExport){\r\n            chartEvents = {\r\n                load: function() {\r\n                    this.credits.element.onclick = function() {\r\n                        window.open('https://fbref.com', '_blank');\r\n                    };\r\n                },\r\n            };\r\n        }\r\n\r\n        //set x-axis label distance\r\n        let xAxisLabelDistance;\r\n        if (this.isForExport){\r\n            xAxisLabelDistance = 60;\r\n        }\r\n        else {\r\n            xAxisLabelDistance = this.isMobile ? 60 : 40;\r\n        }\r\n\r\n        //define the tooltip positioner for shared tooltips (used for comparisons)\r\n        let tooltipPositioner = undefined;\r\n        if (this.isForComparison) {\r\n            tooltipPositioner = function (labelWidth, labelHeight, point) {\r\n                let xPos = point.plotX;\r\n                let yPos = point.plotY - 33;\r\n                return {x: xPos, y: yPos};\r\n            }\r\n        }\r\n\r\n        //define the text for the credits\r\n        let creditsText = this.isForExport ? \"\" : \"Data Sources: FBref.com | StatsBomb<br/>\";\r\n        creditsText += `Last Updated: ${this.props.lastUpdated} UTC`;\r\n\r\n        //Highcharts chart options\r\n        //variable options are initialized to undefined, and then modified on render using props\r\n        //consult the Highcharts API reference for detailed explanations of each option\r\n        //https://api.highcharts.com/highcharts/\r\n        this.chartOptions = {\r\n            title: {\r\n                useHTML: true,\r\n                text: undefined,\r\n                style: {\r\n                    color: '#e75453',\r\n                    fontSize: this.fontSizes['title'],\r\n                    fontWeight: 'bold',\r\n                },\r\n                margin: 35\r\n            },\r\n            subtitle: {\r\n                text: undefined,\r\n                style: {\r\n                    color: 'black',\r\n                    fontSize: this.fontSizes['subtitle'],\r\n                }\r\n            },\r\n            pane: {\r\n                startAngle: startAngle\r\n            },\r\n            chart: {\r\n                backgroundColor: 'rgba(0, 0, 0, 0)',\r\n                style: {\r\n                    fontFamily: 'sans-serif'\r\n                },\r\n                animation: undefined,\r\n                polar: true,\r\n                type: 'column',\r\n                marginLeft: 90,\r\n                marginRight: 90,\r\n                marginTop: undefined,\r\n                marginBottom: undefined,\r\n                events: chartEvents\r\n            },\r\n            xAxis: {\r\n                categories: undefined,\r\n                labels: {\r\n                    zIndex: 0,\r\n                    distance: xAxisLabelDistance,\r\n                    style: {\r\n                        color: 'black',\r\n                        fontSize: this.fontSizes['xAxisLabels'],\r\n                    },\r\n                    padding: 31\r\n                },\r\n                gridLineWidth: 2,\r\n                gridLineColor: 'black',\r\n                gridZIndex: 2\r\n            },\r\n            yAxis: {\r\n                labels: {\r\n                    enabled: false,\r\n                    // style: {\r\n                    //     color: '#444444',\r\n                    //     fontSize: this.fontSizes['yAxisLabels'],\r\n                    // }\r\n                },\r\n                gridZIndex: 4,\r\n                lineWidth: 0,\r\n                endOnTick: true,\r\n                showFirstLabel: false,\r\n                showLastLabel: true,\r\n                min: -15,\r\n                max: 100,\r\n                tickPositions: [-15, 0, 25, 50, 75, 100, 102]\r\n            },\r\n            series: undefined,\r\n            colors: undefined,\r\n            plotOptions: {\r\n                series: {\r\n                    animation: {\r\n                        duration: this.props.isAnimatedInitial ? 750 : 0\r\n                    },\r\n                    events: {\r\n                        legendItemClick: (event) => {\r\n                            event.preventDefault();\r\n                            let series = this.slice.series[event.target.index];\r\n                            let seriesOptions = series.options;\r\n                            seriesOptions.dataLabels.enabled = !seriesOptions.dataLabels.enabled;\r\n                            seriesOptions.animation = false;\r\n                            series.update(seriesOptions);\r\n                            this.drawLegendBorders()\r\n                        }\r\n                    },\r\n                    states: {\r\n                        hover: {\r\n                            enabled: this.props.isAnimatedInitial\r\n                        }\r\n                    },\r\n                    dataLabels: {\r\n                        enabled: undefined,\r\n                        // crop: false,\r\n                        // overflow: 'allow',\r\n                        style: {\r\n                            fontWeight: 'bold',\r\n                            fontSize: this.fontSizes['dataLabels'],\r\n                            textOutline: this.fontSizes['dataLabelsOutline'] + \" #fafbfc\",\r\n                        },\r\n                        format: undefined,\r\n                        padding: 0,\r\n                        allowOverlap: true,\r\n                        z: 7\r\n                    },\r\n                    point: {\r\n                        events: {\r\n                            mouseOut: () => {\r\n                                if (this.isForComparison){\r\n                                    this.slice.tooltip.hide();\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                },\r\n                column: {\r\n                    grouping: false,\r\n                    shadow: false,\r\n                }\r\n            },\r\n            tooltip: {\r\n                enabled: this.props.hasTooltip,\r\n                shared: this.isForComparison,\r\n                positioner: tooltipPositioner,\r\n                followPointer: !this.isMobile,\r\n                headerFormat: `<span style=\"font-size: ${this.fontSizes['tooltipHeader']}; font-weight: bold\">{point.key}</span><br/>-----`,\r\n                pointFormat: '<br><b>{point.playerName}</b><br>Raw Value: <b>{point.p90_label}</b><br/>Percentile Rank: <b>{point.percentile_label}</b>',\r\n                style: {\r\n                    fontSize: this.fontSizes['tooltip']\r\n                },\r\n                backgroundColor: '#fafbfc',\r\n                borderWidth: 2\r\n            },\r\n            legend: {\r\n                enabled: this.isForComparison,\r\n                title: {\r\n                    // text: \"Click to toggle data labels\",\r\n                    style: {\r\n                        fontSize: this.fontSizes['legendTitle']\r\n                    }\r\n                },\r\n                symbolPadding: this.isMobile ? 20 : 7,\r\n                align: 'left',\r\n                verticalAlign: 'bottom',\r\n                layout: 'vertical',\r\n                itemStyle: {\r\n                    color: 'black',\r\n                    fontSize: this.fontSizes['legend']\r\n                },\r\n                itemHoverStyle: {\r\n                    color: '#666666'\r\n                },\r\n                y: this.isForExport ? 5 : 10,\r\n                margin: 0,\r\n                padding: 0,\r\n                itemMarginTop: 3\r\n            },\r\n            credits: {\r\n                text: creditsText,\r\n                position: {\r\n                    align: undefined,\r\n                    x: undefined,\r\n                    // y: this.isMobile ? -30 : (this.isForExport ? -15 : -20)\r\n                    y: this.isForExport ? -10 : (this.isMobile ? -30 : -20)\r\n                },\r\n                style: {\r\n                    lineHeight: this.isMobile || this.isForExport ? (this.isForExport ? \"20px\" : \"25px\") : null,\r\n                    fontSize: this.fontSizes['credits']\r\n                },\r\n            },\r\n            lang: {\r\n                noData: \"Select a competition\"\r\n            },\r\n            noData: {\r\n                attr: {\r\n                    zIndex: 7\r\n                },\r\n                style: {\r\n                    fontWeight: 'bold',\r\n                    fontSize: this.fontSizes['noData'],\r\n                    color: '#303030'\r\n                }\r\n            },\r\n            responsive: {\r\n                rules: [{\r\n                    condition: {\r\n                        maxWidth: 960\r\n                    },\r\n                    chartOptions: {\r\n                        legend: {\r\n                            verticalAlign: 'bottom'\r\n                        }\r\n                    }\r\n                }]\r\n            }\r\n        };\r\n\r\n        //wrap the default Highcharts axis render function to group axis grids with the data series\r\n        //this is done in order to be able to set z-indices on the series relative to the axis grids\r\n        //relevant github issue and further explanation: https://github.com/highcharts/highcharts/issues/3321\r\n        Highcharts.wrap(Highcharts.Axis.prototype, 'render', function (proceed) {\r\n\r\n            //console.log(this);\r\n            proceed.call(this);\r\n            let chart = this.chart;\r\n\r\n            if (!chart.seriesGroup) {\r\n                chart.seriesGroup = chart.renderer.g('series-group')\r\n                    .attr({\r\n                        zIndex: 3\r\n                    })\r\n                    .add();\r\n            }\r\n\r\n            if (this.coll === \"xAxis\" || this.coll === \"yAxis\"){\r\n                this.gridGroup\r\n                    .attr({\r\n                        zIndex: this.options.gridZIndex\r\n                    })\r\n                    .add(chart.seriesGroup);\r\n            }\r\n\r\n            return this;\r\n\r\n        });\r\n\r\n        // Highcharts.wrap(Highcharts.Tick.prototype, 'render', function (proceed) {\r\n        //\r\n        //     console.log(this);\r\n        //     proceed.call(this);\r\n        //     let chart = this.chart;\r\n        //     let axis = this.axis;\r\n        //\r\n        //     if (chart !== undefined){\r\n        //         // if (!chart.seriesGroup) {\r\n        //         //     chart.seriesGroup = chart.renderer.g('series-group')\r\n        //         //         .attr({\r\n        //         //             zIndex: 3\r\n        //         //         })\r\n        //         //         .add();\r\n        //         // }\r\n        //         axis.axisGroup\r\n        //             .attr({\r\n        //                 zIndex: this.pos === 0 ? 4 : 1,\r\n        //                 opacity: 0\r\n        //             })\r\n        //             .add(chart.seriesGroup);\r\n        //     }\r\n        //\r\n        // });\r\n\r\n        this.afterChartCreated = this.afterChartCreated.bind(this);\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * Called just after the Highcharts component is created\r\n     * Stores a reference to the chart in the class\r\n     * @param chart\r\n     */\r\n    afterChartCreated(chart) {\r\n        this.slice = chart;\r\n    }\r\n\r\n\r\n    /**\r\n     * Function to add borders to legend symbols\r\n     */\r\n    drawLegendBorders() {\r\n\r\n        let chart = this.slice;\r\n\r\n        let borderColor = this.primaryColors[this.props.template];\r\n        if (borderColor === '#e4d354'){\r\n            borderColor = '#ebb320';\r\n        }\r\n\r\n        $.each(chart.legend.allItems, function (i, item) {\r\n            item.legendSymbol.element.setAttribute(\"stroke-width\", \"3\");\r\n            //primary color border to first symbol, black border to second symbol\r\n            item.legendSymbol.element.setAttribute(\"stroke\", i === 0 ? borderColor : \"#000000\")\r\n        });\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * Called just after the component mount\r\n     */\r\n    componentDidMount() {\r\n        this.drawLegendBorders();\r\n    }\r\n\r\n\r\n    /**\r\n     * Called whenever the component updates. NOT called on the first render\r\n     * @param prevProps\r\n     * @param prevState\r\n     * @param snapshot\r\n     */\r\n    componentDidUpdate(prevProps, prevState, snapshot) {\r\n        this.drawLegendBorders();\r\n    }\r\n\r\n\r\n    // splitText(text, colors) {\r\n    //\r\n    //     let chunks = [];\r\n    //\r\n    //     let textLength = text.length;\r\n    //     let numColors = colors.length;\r\n    //\r\n    //     if (textLength % numColors === 0) {\r\n    //         let chunkSize = Math.floor(textLength / numColors);\r\n    //         for (let i=0; i<textLength; i+=chunkSize){\r\n    //             chunks.push(text.slice(i, i+chunkSize));\r\n    //         }\r\n    //     }\r\n    //\r\n    //     else {\r\n    //         let chunkSize = Math.ceil((textLength) / numColors--);\r\n    //         for (let i=0; i<textLength; i+=chunkSize) {\r\n    //             chunkSize = Math.ceil((textLength - i) / numColors--);\r\n    //             chunks.push(text.slice(i, i+chunkSize));\r\n    //         }\r\n    //     }\r\n    //\r\n    //     return chunks;\r\n    //\r\n    // }\r\n\r\n\r\n    /**\r\n     * render function\r\n     * configures chart options based on props and draws the slice charts\r\n     * @return {*} - JSX code for the slice charts\r\n     */\r\n    render() {\r\n\r\n        let chartOptions = this.chartOptions;\r\n\r\n        let title = \"\";\r\n        let titleColor = \"#e75453\";\r\n        if (this.isForComparison) {\r\n            chartOptions.title.style.color = titleColor;\r\n            title += `<span class=\"chart-title\"><a href=${this.props.url[0]} target=\"_blank\" rel=\"noopener noreferrer\">${this.props.name[0]}</a></span>`;\r\n            title += `<span style='color: black;'> vs <span class=\"chart-title\"><a href=${this.props.url[1]} target=\"_blank\" rel=\"noopener noreferrer\">${this.props.name[1]}</a></span></span>`;\r\n        }\r\n        else {\r\n            title = `<span class=\"chart-title\"><a href=${this.props.url} target=\"_blank\" rel=\"noopener noreferrer\">${this.props.name}</a>`;\r\n            if (!this.isForExport){\r\n                title += `<a href=${this.props.url} target=\"_blank\" rel=\"noopener noreferrer\"><i id=\"link-icon\" class=\"fa fa-external-link\"></i></a></span>`;\r\n            }\r\n        }\r\n        chartOptions.title.text = title;\r\n\r\n        //build the subtitle\r\n        let subtitle = \"\";\r\n        if (this.props.series.length === 0 || this.props.hasUndefined){\r\n            subtitle = \"-<br>-<br>-\";\r\n        }\r\n        else {\r\n            if (this.isForComparison) {\r\n                subtitle += `<span style='color: ${titleColor}'>Age: <span style='font-weight: bold; color: ${titleColor}'>${this.props.age[0]}  </span></span>`;\r\n                subtitle += `<span style='color: ${titleColor}'>Minutes Played: <span style='font-weight: bold; color: ${titleColor}'>${this.props.minutes[0].toLocaleString()}</span></span>`;\r\n                subtitle += \" - \";\r\n                subtitle += `Age: <b>${this.props.age[1]}</b>  `;\r\n                subtitle += `Minutes Played: <b>${this.props.minutes[1].toLocaleString()}</b><br>`;\r\n            }\r\n            else {\r\n                subtitle += `Age: <span style=\"font-weight: bold; color: #e75453\">${this.props.age}</span>  `;\r\n                subtitle += `Minutes Played: <span style=\"font-weight: bold; color: #e75453\">${this.props.minutes.toLocaleString()}</span><br>`;\r\n            }\r\n            subtitle += \"Percentile Rank Bars (per 90 stats)<br>\";\r\n            subtitle += this.subtitles[this.props.template];\r\n        }\r\n        //set the subtitle\r\n        chartOptions.subtitle.text = subtitle;\r\n\r\n        let chart = chartOptions.chart;\r\n        //set animation (on update) to true or false\r\n        chart.animation = this.props.isAnimated;\r\n        //set chart margins\r\n        if (this.isForExport){\r\n            chart.marginTop = 230;\r\n            chart.marginBottom = 130;\r\n        }\r\n        else {\r\n            chart.marginBottom = (this.props.creditsPosition === \"right\" && !this.props.isMobile) ? 30 : 60;\r\n        }\r\n\r\n        let xAxis = chartOptions.xAxis;\r\n        //set x-axis labels\r\n        xAxis.categories = this.categories[this.props.template];\r\n\r\n        //set data points\r\n        chartOptions.series = this.props.series.map((data, index) => {\r\n            return {\r\n                name: data[0].playerName,\r\n                data: data,\r\n                zIndex: index === 0 ? 0 : 3,\r\n                pointPadding: 0,\r\n                groupPadding: 0,\r\n                stickyTracking: false,\r\n            };\r\n        });\r\n\r\n        //set series color\r\n        let titleColors = this.titleColors[this.props.template];\r\n        let numColors = titleColors.length;\r\n        let gradientStops = [];\r\n        let stop = 0;\r\n        for (let i=0; i<numColors; i++){\r\n            if (titleColors[numColors - 1 - i] !== this.primaryColors[this.props.template]){\r\n                gradientStops.push([stop, titleColors[numColors - 1 - i]]);\r\n                stop++\r\n            }\r\n        }\r\n        chartOptions.colors = [\r\n            {\r\n                radialGradient: {\r\n                    cx: 0.5,\r\n                    cy: 0.5,\r\n                    r: 0.3,\r\n                },\r\n                stops: gradientStops\r\n            },\r\n            // {\r\n            //     linearGradient: {\r\n            //         x1: 0,\r\n            //         x2: 0,\r\n            //         y1: 0,\r\n            //         y2: 1\r\n            //     },\r\n            //     stops: gradientStops\r\n            // },\r\n            '#fafbfc'\r\n        ];\r\n\r\n        //set data labels\r\n        let dataLabels = chartOptions.plotOptions.series.dataLabels;\r\n        dataLabels.enabled = this.props.template !== \"N/A\" && !this.isForComparison;\r\n        dataLabels.format = this.props.labelType === \"raw\" ? '{point.p90_label}' : '{point.percentile_label}';\r\n\r\n        //set credits position\r\n        let credits = chartOptions.credits;\r\n        let creditsPosition = this.props.creditsPosition;\r\n        credits.position.align = this.isForExport ? \"center\" : creditsPosition;\r\n        credits.position.x = this.isForExport || creditsPosition === \"center\" ? 0 : -10;\r\n\r\n        let className = this.isForExport ? undefined : \"result\";\r\n        let id = this.isForExport ? \"export\" : \"chart\";\r\n\r\n        //pass chart options to the Highcharts component and render\r\n        return (\r\n            <div className={className} id={id}>\r\n                <HighchartsReact\r\n                    constructorType={\"chart\"}\r\n                    highcharts={Highcharts}\r\n                    containerProps={{style: {width: '100%', height: '100%'}}}\r\n                    options={chartOptions}\r\n                    callback={this.afterChartCreated}\r\n                />\r\n            </div>\r\n        );\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default (Slice);\r\n","import React, { Component } from 'react';\r\nimport SearchBar from \"./SearchBar\";\r\n\r\n\r\n/**\r\n * Component to render the player comparison search screen\r\n * Also handles the live search requests and aborts\r\n */\r\nclass CompareSearchOverlay extends Component {\r\n\r\n    constructor(props) {\r\n\r\n        super(props);\r\n\r\n        this.isMobile = this.props.isMobile;\r\n\r\n        this.toggleCompareSearch = this.props.toggleCompareSearch;\r\n        this.currentPlayerName = this.props.currentPlayerName;\r\n        this.currentPlayerCode = this.props.currentPlayerCode;\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * render function\r\n     * displays the player comparison search screen\r\n     * @return {*} - JSX code for the searchbar and its container\r\n     */\r\n    render() {\r\n\r\n        //return JSX code for the searchbar\r\n        return (\r\n            <div className={`overlay ${this.props.display ? \"open\" : \"closed\"}`} id=\"compare-search-overlay\">\r\n                <button className=\"far fa-times\" onClick={this.toggleCompareSearch} id=\"close-compare-search-overlay\">\r\n                </button>\r\n                <span><h3>Compare {this.currentPlayerName} to...</h3></span>\r\n                <SearchBar\r\n                    isMobile={this.isMobile}\r\n                    page=\"compare\"\r\n                    currentPlayerCode={this.currentPlayerCode}\r\n                />\r\n            </div>\r\n\r\n        );\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default (CompareSearchOverlay);\r\n","import React, { Component } from 'react';\r\n\r\n\r\n/**\r\n * Component to render the player comparison search screen\r\n * Also handles the live search requests and aborts\r\n */\r\nclass ExportLoaderOverlay extends Component {\r\n\r\n    /**\r\n     * render function\r\n     * displays the export loader overlay\r\n     * @return {*} - JSX code for the searchbar and its container\r\n     */\r\n    render() {\r\n\r\n        //return JSX code for the searchbar\r\n        return (\r\n            <div className={`overlay ${this.props.display ? \"open\" : \"closed\"}`} id=\"export-loader-overlay\">\r\n                <div className=\"loader\">Loading...</div>\r\n            </div>\r\n\r\n        );\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default (ExportLoaderOverlay);\r\n","import React, { Component } from 'react';\r\nimport { Redirect } from 'react-router-dom'\r\n\r\n//import dependencies\r\nimport Cookies from 'universal-cookie';\r\nimport dateFormat from 'dateformat';\r\n\r\n//import utility functions\r\nimport {\r\n    filterStats,\r\n    calculateStats,\r\n    constructChartInput,\r\n    changeTemplate,\r\n    changeSelectedCompetitions,\r\n    changeLabelType,\r\n    toggleCreditsPosition,\r\n    exportChart,\r\n    toggleCompareSearch\r\n} from \"../utilities/SliceUtilities\"\r\n\r\n//import components\r\nimport LoadingSpinner from \"../components/LoadingSpinner\";\r\nimport SearchBar from \"../components/SearchBar\";\r\nimport SliceOptions from \"../components/SliceOptions\";\r\nimport Slice from \"../components/Slice\";\r\nimport CompareSearchScreen from \"../components/CompareSearchOverlay\";\r\nimport ExportLoaderScreen from \"../components/ExportLoaderOverlay\";\r\n\r\n//initialize cookies\r\nconst cookies = new Cookies();\r\n\r\n\r\n/**\r\n * Stats page component\r\n */\r\nclass Stats extends Component {\r\n\r\n    //class variable to track if the component is mounted\r\n    _isMounted = false;\r\n\r\n    /**\r\n     * Constructor\r\n     * @param props\r\n     */\r\n    constructor(props){\r\n\r\n        super(props);\r\n\r\n        //bind utility functions to this context\r\n        this.filterStats = filterStats.bind(this);\r\n        this.calculateStats = calculateStats.bind(this);\r\n        this.constructChartInput = constructChartInput.bind(this);\r\n        this.changeTemplate = changeTemplate.bind(this);\r\n        this.changeSelectedCompetitions = changeSelectedCompetitions.bind(this);\r\n        this.changeLabelType = changeLabelType.bind(this);\r\n        this.toggleCreditsPosition = toggleCreditsPosition.bind(this);\r\n        this.exportChart = exportChart.bind(this);\r\n        this.toggleCompareSearch = toggleCompareSearch.bind(this);\r\n\r\n        //device and browser info\r\n        this.isMobile = this.props.isMobile;\r\n        this.isSafari = this.props.isSafari;\r\n\r\n        //cookies\r\n        let labelTypeCookie = cookies.get('labelType');\r\n        let creditsPositionCookie = cookies.get('creditsPosition');\r\n\r\n        this.state = {\r\n            isLoading: true,\r\n            error: null,\r\n            redirect: false,\r\n            showCompareSearchOverlay: false,\r\n            showExportLoaderOverlay: false,\r\n            renderForExport: false,\r\n            percentileArrays: this.props.percentileArrays,\r\n            code: this.props.match.params.code,\r\n            name: '',\r\n            url: '',\r\n            age: 0,\r\n            clubs: {},\r\n            percentileEntries: {},\r\n            stats: {},\r\n            lastUpdated: null,\r\n            template: null,\r\n            competitions: {},\r\n            selectedCompetitions: {},\r\n            labelType: labelTypeCookie === undefined ? \"raw\" : labelTypeCookie,\r\n            creditsPosition: creditsPositionCookie === undefined ? \"right\" : creditsPositionCookie,\r\n            isAnimated: true\r\n        };\r\n\r\n        this.getStats();\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * Called after component has mounted\r\n     */\r\n    componentDidMount() {\r\n        this._isMounted = true;\r\n    }\r\n\r\n\r\n    /**\r\n     * Called just before the component receives new props. This is done to ensure that new props trigger a re-render\r\n     * @param nextProps\r\n     * @param nextContext\r\n     */\r\n    //TODO: re-factor because componentWillReceiveProps has been deprecated\r\n    UNSAFE_componentWillReceiveProps(nextProps, nextContext) {\r\n        let { code } = nextProps.match.params;\r\n        this.setState({\r\n            redirect: false,\r\n            isLoading: true,\r\n            code: code\r\n        }, () => {\r\n            this.getStats();\r\n        });\r\n    }\r\n\r\n\r\n    /**\r\n     * Function to send a post request to the server to retrieve the stats of the player\r\n     */\r\n    getStats = () => {\r\n\r\n        const code = this.state.code;\r\n\r\n        //fetch stats\r\n        fetch('/api/stats', {\r\n            method: 'post',\r\n            headers: {\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            body: JSON.stringify({\r\n                \"code\": code,\r\n                \"percentilesTimestamp\": this.state.percentileArrays['lastUpdated']\r\n            })\r\n        })\r\n        .then(res => {\r\n            if (res.ok) {\r\n                return res.json()\r\n            }\r\n            else {\r\n                throw new Error(\"Failed to fetch. This is likely due to a malformed URL. Please try searching for the player again.\")\r\n            }\r\n        })\r\n        .then(response => this.processStats(response))\r\n        .catch(error => {\r\n            if (this._isMounted){\r\n                //redirect if a v1 URL is detected\r\n                if (code.match(\"^Players_[0-9]+_Show_\")){\r\n                    this.setState({\r\n                        redirect: true,\r\n                        isLoading: false,\r\n                        code: code.split(\"_\")[1]\r\n                    })\r\n                }\r\n                else {\r\n                    this.setState({\r\n                        error: error,\r\n                        isLoading: false\r\n                    })\r\n                }\r\n            }\r\n        });\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Function to process retrieved player stats and save to state\r\n     * @param {Object} response - object containing the player metadata and stats, as well as new percentile arrays\r\n     * in the event that the server needs to update a client's percentile arrays.\r\n     */\r\n    processStats = (response) => {\r\n\r\n        //check if the stats object contains new percentile arrays\r\n        if (response.newPercentileArrays !== undefined){\r\n            //update percentile arrays in parent component as required\r\n            this.props.updatePercentileArrays(response.newPercentileArrays);\r\n        }\r\n\r\n        let playerStats = response.stats;\r\n\r\n        //process player position entry and set template. template is set to the most recent non-\"N/A\" position\r\n        //in the player's position entries\r\n        let template = \"N/A\";\r\n        for (let season in playerStats.positions){\r\n            let position = playerStats.positions[season];\r\n            if (position !== \"N/A\"){\r\n                template = position;\r\n            }\r\n        }\r\n\r\n        //retrieve player competitions. stored in an object where the keys are seasons and the values are arrays\r\n        //of the competitions for the season\r\n        let competitions = {};\r\n        for (let season in playerStats.stats){\r\n            competitions[season] = [];\r\n            for (let competition in playerStats.stats[season]){\r\n                competitions[season].push(competition);\r\n            }\r\n        }\r\n\r\n        if (this._isMounted){\r\n            this.setState({\r\n                isLoading: false,\r\n                name: playerStats.name,\r\n                url: \"https://www.fbref.com\" + playerStats.fbrefURL,\r\n                age: playerStats.age,\r\n                clubs: playerStats.clubs,\r\n                percentileEntries: playerStats.percentileEntries,\r\n                stats: playerStats.stats,\r\n                lastUpdated: dateFormat(playerStats.lastUpdated, \"dd/mm/yyyy, h:MM TT\", true),\r\n                template: template,\r\n                competitions: JSON.parse(JSON.stringify(competitions)),\r\n                selectedCompetitions: JSON.parse(JSON.stringify(competitions))\r\n            });\r\n            document.title = `${playerStats.name} | Football Slices`\r\n        }\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Called just before the component un-mounts\r\n     */\r\n    componentWillUnmount() {\r\n        this._isMounted = false;\r\n    }\r\n\r\n\r\n    /**\r\n     * render function\r\n     * @return {*} - JSX code for the stats page\r\n     */\r\n    render() {\r\n\r\n        let {\r\n            isLoading,\r\n            error,\r\n            redirect,\r\n            showCompareSearchOverlay,\r\n            showExportLoaderOverlay,\r\n            renderForExport,\r\n            code,\r\n            url,\r\n            name,\r\n            age,\r\n            clubs,\r\n            stats,\r\n            lastUpdated,\r\n            competitions,\r\n            selectedCompetitions,\r\n            template,\r\n            labelType,\r\n            creditsPosition,\r\n            isAnimated\r\n        } = this.state;\r\n\r\n        //display loading spinner while the server responds to POST request for the stats\r\n        if (isLoading) {\r\n            return (\r\n                <LoadingSpinner/>\r\n            )\r\n        }\r\n\r\n        else if (redirect){\r\n            return <Redirect to={`/stats/${code}`}/>\r\n        }\r\n\r\n        //display the error message screen if an error is caught\r\n        else if (error !== null) {\r\n            return (\r\n                <div id=\"main2\">\r\n                    <SearchBar\r\n                        isMobile={this.isMobile}\r\n                        page=\"stats\"\r\n                        query={this.state.query}\r\n                    />\r\n                    <div className=\"screen\" id=\"error-screen\">\r\n                        <p>{error.message}</p>\r\n                    </div>\r\n                </div>\r\n            )\r\n        }\r\n\r\n        //build stats page otherwise\r\n        else {\r\n\r\n            //calculate stats and construct chart input\r\n            let filteredStats = {};\r\n            let series = [];\r\n            if (template !== null) {\r\n                filteredStats = this.filterStats(stats);\r\n                if (Object.keys(filteredStats).length !== 0){\r\n                    let calculatedStats = this.calculateStats(filteredStats);\r\n                    let chartInput = this.constructChartInput(calculatedStats.statsPer90, calculatedStats.percentiles);\r\n                    series.push(chartInput);\r\n                }\r\n            }\r\n\r\n            let exportSlice = null;\r\n            if (renderForExport) {\r\n                exportSlice =\r\n                <Slice\r\n                    isMobile={this.isMobile}\r\n                    isForExport={true}\r\n                    isAnimated={false}\r\n                    isAnimatedInitial={false}\r\n                    hasTooltip={false}\r\n                    creditsPosition={creditsPosition}\r\n                    url={null}\r\n                    lastUpdated={lastUpdated}\r\n                    template={template}\r\n                    labelType={labelType}\r\n                    name={name}\r\n                    age={age}\r\n                    minutes={filteredStats['minutes']}\r\n                    series={series}\r\n                />\r\n            }\r\n\r\n            //return JSX code for the stats page\r\n            return (\r\n                <div id=\"main2\">\r\n                    <CompareSearchScreen\r\n                        isMobile={this.isMobile}\r\n                        display={showCompareSearchOverlay}\r\n                        currentPlayerCode={code}\r\n                        currentPlayerName={name}\r\n                        toggleCompareSearch={this.toggleCompareSearch}\r\n                    />\r\n                    <ExportLoaderScreen\r\n                        isMobile={this.isMobile}\r\n                        display={showExportLoaderOverlay}\r\n                    />\r\n                    <SearchBar\r\n                        isMobile={this.isMobile}\r\n                        page=\"stats\"\r\n                    />\r\n                    <div className=\"screen2\" id=\"stats-screen\">\r\n                        <SliceOptions\r\n                            isMobile={this.isMobile}\r\n                            template={template}\r\n                            competitions={competitions}\r\n                            clubs={clubs}\r\n                            selectedCompetitions={selectedCompetitions}\r\n                            labelType={labelType}\r\n                            changeTemplate={this.changeTemplate}\r\n                            changeSelectedCompetitions={this.changeSelectedCompetitions}\r\n                            changeLabelType={this.changeLabelType}\r\n                            toggleCreditsPosition={this.toggleCreditsPosition}\r\n                            exportChart={this.exportChart}\r\n                            toggleCompareSearch={this.toggleCompareSearch}\r\n                        />\r\n                        <Slice\r\n                            isMobile={this.isMobile}\r\n                            isForExport={false}\r\n                            isAnimated={isAnimated}\r\n                            isAnimatedInitial={true}\r\n                            hasTooltip={true}\r\n                            creditsPosition={creditsPosition}\r\n                            url={url}\r\n                            lastUpdated={lastUpdated}\r\n                            template={template}\r\n                            labelType={labelType}\r\n                            name={name}\r\n                            age={age}\r\n                            minutes={filteredStats['minutes']}\r\n                            series={series}\r\n                        />\r\n                    </div>\r\n                    {/*Second slice used for exports. Not displayed*/}\r\n                    {exportSlice}\r\n                </div>\r\n            );\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default Stats;\r\n","import React, { Component } from 'react';\r\n// import $ from \"jquery\";\r\n\r\n//import dependencies\r\nimport Cookies from 'universal-cookie';\r\n\r\n//import components\r\nimport LoadingSpinner from \"../components/LoadingSpinner\";\r\nimport SearchBar from \"../components/SearchBar\";\r\nimport SliceOptions from \"../components/SliceOptions\";\r\nimport Slice from \"../components/Slice\";\r\nimport CompareSearchScreen from \"../components/CompareSearchOverlay\";\r\nimport ExportLoaderScreen from \"../components/ExportLoaderOverlay\";\r\n\r\n//import utility functions\r\nimport {\r\n    filterStats,\r\n    calculateStats,\r\n    constructChartInput,\r\n    changeTemplate,\r\n    changeSelectedCompetitions,\r\n    changeLabelType,\r\n    toggleCreditsPosition,\r\n    exportChart,\r\n    toggleCompareSearch\r\n} from \"../utilities/SliceUtilities\"\r\n\r\n//initialize helpers\r\nconst dateFormat = require('dateformat');\r\nconst cookies = new Cookies();\r\n\r\n\r\n/**\r\n * Compare page component\r\n */\r\nclass Compare extends Component {\r\n\r\n    //class variable to track if the component is mounted\r\n    _isMounted = false;\r\n\r\n    /**\r\n     * Constructor\r\n     * @param props\r\n     */\r\n    constructor(props){\r\n\r\n        super(props);\r\n\r\n        //bind utility function to this context\r\n        this.filterStats = filterStats.bind(this);\r\n        this.calculateStats = calculateStats.bind(this);\r\n        this.constructChartInput = constructChartInput.bind(this);\r\n        this.changeTemplate = changeTemplate.bind(this);\r\n        this.changeSelectedCompetitions = changeSelectedCompetitions.bind(this);\r\n        this.changeLabelType = changeLabelType.bind(this);\r\n        this.toggleCreditsPosition = toggleCreditsPosition.bind(this);\r\n        this.exportChart = exportChart.bind(this);\r\n        this.toggleCompareSearch = toggleCompareSearch.bind(this);\r\n\r\n        //device and browser info\r\n        this.isMobile = this.props.isMobile;\r\n        this.isSafari = this.props.isSafari;\r\n\r\n        //cookies\r\n        let labelTypeCookie = cookies.get('labelType');\r\n        let creditsPositionCookie = cookies.get('creditsPosition');\r\n\r\n        //retrieve player codes from the URL\r\n        let codes = this.props.match.params.codes.split(\"_\");\r\n\r\n        //modify them if they are identical (comparing a player to themselves). This is done so the objects holding\r\n        //the data for the 2 instances of the player can have unique keys\r\n        if (codes[0] === codes[1]) {\r\n            codes[0] = codes[0] + \"|1\";\r\n            codes[1] = codes[1] + \"|2\";\r\n        }\r\n\r\n        this.state = {\r\n            isLoading: true,\r\n            error: null,\r\n            showCompareSearchOverlay: false,\r\n            showExportLoaderOverlay: false,\r\n            renderForExport: false,\r\n            percentileArrays: this.props.percentileArrays,\r\n            codes: codes,\r\n            names: {},\r\n            urls: {},\r\n            ages: {},\r\n            clubs: {},\r\n            percentileEntries: {},\r\n            stats: {},\r\n            template: null,\r\n            competitions: {},\r\n            selectedCompetitions: {},\r\n            labelType: labelTypeCookie === undefined ? \"raw\" : labelTypeCookie,\r\n            creditsPosition: creditsPositionCookie === undefined ? \"right\" : creditsPositionCookie,\r\n            lastUpdated: null,\r\n            isAnimated: true\r\n        };\r\n\r\n        this.getStats();\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * Called after component has mounted\r\n     */\r\n    componentDidMount() {\r\n        this._isMounted = true;\r\n    }\r\n\r\n\r\n    /**\r\n     * Called just before the component receives new props. This is done to ensure that new props trigger a re-render\r\n     * @param nextProps\r\n     * @param nextContext\r\n     */\r\n    //TODO: re-factor because componentWillReceiveProps has been deprecated\r\n    UNSAFE_componentWillReceiveProps(nextProps, nextContext) {\r\n\r\n        //retrieve player codes from the URL\r\n        let codes = nextProps.match.params.codes.split(\"_\");\r\n        //modify them if they are identical (comparing a player to themselves). This is done so the objects holding\r\n        //the data for the 2 iterations of the player can have unique keys\r\n        if (codes[0] === codes[1]) {\r\n            codes[0] = codes[0] + \"|1\";\r\n            codes[1] = codes[1] + \"|2\";\r\n        }\r\n\r\n        this.setState({\r\n            isLoading: true,\r\n            showCompareSearchOverlay: false,\r\n            codes: codes\r\n        }, () => {\r\n            this.getStats();\r\n        });\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * Function to send a post request to the server to retrieve the stats of the player\r\n     */\r\n    getStats = () => {\r\n\r\n        const codes = this.state.codes;\r\n\r\n        //fetch stats\r\n        fetch('/api/comparisonStats', {\r\n            method: 'post',\r\n            headers: {\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            body: JSON.stringify({\r\n                \"codes\": codes,\r\n                \"percentilesTimestamp\": this.state.percentileArrays['lastUpdated']\r\n            })\r\n        })\r\n        .then(res => {\r\n            if (res.ok) {\r\n                return res.json()\r\n            }\r\n            else {\r\n                throw new Error(\"Failed to fetch. This is likely due to a malformed URL. Please try searching for the player again.\")\r\n            }\r\n        })\r\n        .then(response => this.processStats(response))\r\n        .catch(error => {\r\n            console.log(error);\r\n            if (this._isMounted){\r\n                this.setState({\r\n                    error: error,\r\n                    isLoading: false\r\n                })\r\n            }\r\n        });\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Function to process retrieved player stats and save to state\r\n     * @param {Object} response - object containing the players' metadata and stats, as well as new percentile arrays\r\n     * in the event that the server needs to update a client's percentile arrays.\r\n     */\r\n    processStats = (response) => {\r\n\r\n        let codes = this.state.codes;\r\n\r\n        //check if the stats object contains new percentile arrays\r\n        if (response.newPercentileArrays !== undefined){\r\n            //update percentile arrays in parent component as required\r\n            this.props.updatePercentileArrays(response.newPercentileArrays);\r\n        }\r\n\r\n        let playerStats = response.stats;\r\n\r\n        //process player position entry and set template. template is set to the most recent non-\"N/A\" position\r\n        //in the player's position entries\r\n        let template = \"N/A\";\r\n        for (let season in playerStats[codes[0]].positions){\r\n            let position = playerStats[codes[0]].positions[season];\r\n            if (position !== \"N/A\"){\r\n                template = position;\r\n            }\r\n        }\r\n\r\n        let names = {};\r\n        let urls = {};\r\n        let ages = {};\r\n        let clubs = {};\r\n        let percentileEntries = {};\r\n        let stats = {};\r\n        let competitions = {};\r\n\r\n        //retrieve the information for the 2 players and store in objects\r\n        for (let code in playerStats){\r\n            names[code] = playerStats[code].name;\r\n            urls[code] = \"https://www.fbref.com\" + playerStats[code].fbrefURL;\r\n            ages[code] = playerStats[code].age;\r\n            clubs[code] = playerStats[code].clubs;\r\n            percentileEntries[code] = playerStats[code].percentileEntries;\r\n            stats[code] = playerStats[code].stats;\r\n            competitions[code] = {};\r\n            //retrieve player competitions. stored in an object where the keys are seasons and the values are arrays\r\n            //of the competitions for the season\r\n            for (let season in playerStats[code].stats){\r\n                competitions[code][season] = [];\r\n                for (let competition in playerStats[code].stats[season]){\r\n                    competitions[code][season].push(competition);\r\n                }\r\n            }\r\n        }\r\n\r\n        if (this._isMounted){\r\n            this.setState({\r\n                isLoading: false,\r\n                names: JSON.parse(JSON.stringify(names)),\r\n                urls: JSON.parse(JSON.stringify(urls)),\r\n                ages: JSON.parse(JSON.stringify(ages)),\r\n                clubs: JSON.parse(JSON.stringify(clubs)),\r\n                percentileEntries: JSON.parse(JSON.stringify(percentileEntries)),\r\n                stats: JSON.parse(JSON.stringify(stats)),\r\n                template: template,\r\n                competitions: JSON.parse(JSON.stringify(competitions)),\r\n                selectedCompetitions: JSON.parse(JSON.stringify(competitions)),\r\n                lastUpdated: dateFormat(playerStats[codes[0]].lastUpdated, \"dd/mm/yyyy, h:MM TT\", true)\r\n            });\r\n            document.title = `${names[codes[0]]} vs ${names[codes[1]]} | Football Slices`\r\n        }\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Called just before the component un-mounts\r\n     */\r\n    componentWillUnmount() {\r\n        this._isMounted = false;\r\n    }\r\n\r\n\r\n    /**\r\n     * render function\r\n     * @return {*} - JSX code for the compare page\r\n     */\r\n    render() {\r\n\r\n        let {\r\n            isLoading,\r\n            error,\r\n            showCompareSearchOverlay,\r\n            showExportLoaderOverlay,\r\n            renderForExport,\r\n            codes,\r\n            urls,\r\n            names,\r\n            ages,\r\n            clubs,\r\n            stats,\r\n            lastUpdated,\r\n            competitions,\r\n            selectedCompetitions,\r\n            template,\r\n            labelType,\r\n            creditsPosition,\r\n            isAnimated\r\n        } = this.state;\r\n\r\n        //display loading spinner while the server responds to POST request for the stats\r\n        if (isLoading) {\r\n            return (\r\n                <LoadingSpinner/>\r\n            )\r\n        }\r\n\r\n        //display the error message screen if an error is caught\r\n        else if (error !== null) {\r\n            return (\r\n                <div id=\"main2\">\r\n                    <SearchBar\r\n                        isMobile={this.isMobile}\r\n                        page=\"stats\"\r\n                        query={this.state.query}\r\n                    />\r\n                    <div className=\"screen\" id=\"error-screen\">\r\n                        <p>{error.message}</p>\r\n                    </div>\r\n                </div>\r\n            )\r\n        }\r\n\r\n        //build stats page otherwise\r\n        else {\r\n\r\n            //calculate stats and construct chart input\r\n            let filteredStats = {};\r\n            let series = [];\r\n            let hasUndefined;\r\n            if (template !== null) {\r\n                for (let i=0; i<codes.length; i++){\r\n                    let code = codes[i];\r\n                    filteredStats[code] = this.filterStats(stats[code], code);\r\n                    if (Object.keys(filteredStats[code]).length !== 0){\r\n                        let calculatedStats = this.calculateStats(filteredStats[code], code);\r\n                        let chartInput = this.constructChartInput(\r\n                            calculatedStats.statsPer90,\r\n                            calculatedStats.percentiles,\r\n                            code,\r\n                            names[codes[i]],\r\n                            ages[codes[i]],\r\n                            filteredStats[code]['minutes'],\r\n                            i\r\n                        );\r\n                        series.push(chartInput);\r\n                    }\r\n                    else {\r\n                        hasUndefined = true;\r\n                    }\r\n                }\r\n            }\r\n\r\n            let code1 = codes[0];\r\n            let code2 = codes[1];\r\n\r\n            let exportSlice = null;\r\n            if (renderForExport) {\r\n                exportSlice =\r\n                <Slice\r\n                    isMobile={this.isMobile}\r\n                    isForExport={true}\r\n                    isForComparison={true}\r\n                    hasUndefined={hasUndefined}\r\n                    isAnimated={false}\r\n                    isAnimatedInitial={false}\r\n                    hasTooltip={false}\r\n                    creditsPosition={creditsPosition}\r\n                    url={\r\n                        [urls[code1], urls[code2]]\r\n                    }\r\n                    lastUpdated={lastUpdated}\r\n                    template={template}\r\n                    labelType={labelType}\r\n                    name={\r\n                        [names[code1], names[code2]]\r\n                    }\r\n                    age={\r\n                        [ages[code1], ages[code2]]\r\n                    }\r\n                    minutes={\r\n                        [filteredStats[code1]['minutes'], filteredStats[code2]['minutes']]\r\n                    }\r\n                    series={series}\r\n                />\r\n            }\r\n\r\n            //return JSX code for the stats page\r\n            return (\r\n                <div id=\"main2\">\r\n                    <CompareSearchScreen\r\n                        isMobile={this.isMobile}\r\n                        display={showCompareSearchOverlay}\r\n                        currentPlayerCode={codes[0]}\r\n                        currentPlayerName={names[codes[0]]}\r\n                        toggleCompareSearch={this.toggleCompareSearch}\r\n                    />\r\n                    <ExportLoaderScreen\r\n                        isMobile={this.isMobile}\r\n                        display={showExportLoaderOverlay}\r\n                    />\r\n                    <SearchBar\r\n                        isMobile={this.isMobile}\r\n                        page=\"stats\"\r\n                    />\r\n                    <div className=\"screen2\" id=\"compare-screen\">\r\n                        <SliceOptions\r\n                            isMobile={this.isMobile}\r\n                            codes={codes}\r\n                            names={names}\r\n                            template={template}\r\n                            competitions={competitions}\r\n                            clubs={clubs}\r\n                            selectedCompetitions={selectedCompetitions}\r\n                            labelType={labelType}\r\n                            changeTemplate={this.changeTemplate}\r\n                            changeSelectedCompetitions={this.changeSelectedCompetitions}\r\n                            changeLabelType={this.changeLabelType}\r\n                            toggleCreditsPosition={this.toggleCreditsPosition}\r\n                            exportChart={this.exportChart}\r\n                            toggleCompareSearch={this.toggleCompareSearch}\r\n                        />\r\n                        <Slice\r\n                            isMobile={this.isMobile}\r\n                            isForExport={false}\r\n                            isForComparison={true}\r\n                            hasUndefined={hasUndefined}\r\n                            isAnimated={isAnimated}\r\n                            isAnimatedInitial={true}\r\n                            hasTooltip={true}\r\n                            creditsPosition={creditsPosition}\r\n                            url={\r\n                                [urls[code1], urls[code2]]\r\n                            }\r\n                            lastUpdated={lastUpdated}\r\n                            template={template}\r\n                            labelType={labelType}\r\n                            name={\r\n                                [names[code1], names[code2]]\r\n                            }\r\n                            age={\r\n                                [ages[code1], ages[code2]]\r\n                            }\r\n                            minutes={\r\n                                [filteredStats[code1]['minutes'], filteredStats[code2]['minutes']]\r\n                            }\r\n                            series={series}\r\n                        />\r\n                    </div>\r\n                    {/*Second slice used for exports. Not displayed*/}\r\n                    {exportSlice}\r\n                </div>\r\n            );\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default Compare;\r\n","import React, { Component } from 'react';\r\nimport { BrowserRouter, Route, Switch } from 'react-router-dom';\r\nimport { createBrowserHistory } from 'history'\r\nimport ReactGA from 'react-ga';\r\nimport {isMobileOnly, isSafari} from 'react-device-detect';\r\n\r\n//import pages\r\nimport Error from './pages/Error';\r\nimport Home from './pages/Home';\r\nimport Search from './pages/Search';\r\nimport Stats from './pages/Stats';\r\nimport Compare from './pages/Compare';\r\n\r\n//import stylesheets, including mobile stylesheet if it is a mobile device\r\nrequire('./stylesheets/App.css');\r\nif (isMobileOnly){\r\n    import('./stylesheets/Mobile.css')\r\n    .then( () => {\r\n    });\r\n}\r\n\r\n//initialize Google Analytics\r\nReactGA.initialize('UA-168675037-1');\r\n//listen for route changes and record a page-view in Google Analytics for each one\r\nconst history = createBrowserHistory();\r\nhistory.listen((location, action) => {\r\n    ReactGA.pageview(location.pathname + location.search);\r\n});\r\n\r\n\r\n/**\r\n * Main app component. Handles routing, and the retrieval of percentile arrays.\r\n */\r\nclass App extends Component {\r\n\r\n\r\n    /**\r\n     * Constructor\r\n     * @param props\r\n     */\r\n    constructor(props) {\r\n\r\n        super(props);\r\n        this.state = {\r\n            isLoading: true,\r\n            percentileArrays: {},\r\n        };\r\n        this.getPercentileArrays();\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * Called after component has mounted\r\n     */\r\n    componentDidMount() {\r\n\r\n        //record the first page-view in Google Analytics\r\n        //this is done because history.listen() only records route changes, but doesn't record the first page on load\r\n        ReactGA.pageview(window.location.pathname + window.location.search);\r\n\r\n    }\r\n\r\n\r\n    /**\r\n     * Function to send a POST request to the server to retrieve the percentile arrays\r\n     */\r\n    getPercentileArrays = () => {\r\n\r\n        //retrieve percentile arrays and set isLoading to false\r\n        fetch('/api/percentiles', {\r\n            method: 'post',\r\n            headers: {\r\n                \"Content-Type\": \"application/json\"\r\n            },\r\n            body: JSON.stringify({})\r\n        })\r\n        .then(res => {\r\n            return res.json()\r\n        })\r\n        .then(percentileArrays => this.setState({percentileArrays: percentileArrays, isLoading: false}))\r\n        .catch();\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * Function to update percentile arrays (called from Stats and Compare pages)\r\n     * @param {Object} newPercentileArrays - the object representing the new percentile arrays\r\n     */\r\n    updatePercentileArrays = (newPercentileArrays) => {\r\n\r\n        this.setState({\r\n            percentileArrays: newPercentileArrays\r\n        })\r\n\r\n    };\r\n\r\n\r\n    /**\r\n     * render function\r\n     * @return {*} - JSX code for the website routing\r\n     */\r\n    render() {\r\n\r\n        let { isLoading } = this.state;\r\n\r\n        //display loading message while server responds to POST request for the percentile arrays\r\n        if (isLoading) {\r\n            return (\r\n                <div id=\"main\">\r\n                    <div className=\"screen\" id=\"loading-screen\">\r\n                        <p>Connecting...</p>\r\n                    </div>\r\n                </div>\r\n            )\r\n        }\r\n\r\n        //return routing code otherwise\r\n        else {\r\n\r\n            const App = () => (\r\n                <BrowserRouter history={history}>\r\n                    <Switch>\r\n                        <Route exact path='/' render={(props) =>\r\n                            <Home {...props}\r\n                                  isMobile={isMobileOnly}\r\n                            />}\r\n                        />\r\n                        <Route exact path='/search/:query/:searchByClub?' render={(props) =>\r\n                            <Search {...props}\r\n                                   isMobile={isMobileOnly}\r\n                            />}\r\n                        />\r\n                        <Route exact path='/stats/:code' render={(props) =>\r\n                            <Stats {...props}\r\n                                percentileArrays={this.state.percentileArrays}\r\n                                isMobile={isMobileOnly}\r\n                                isSafari={isSafari}\r\n                                updatePercentileArrays={this.updatePercentileArrays}\r\n                            />}\r\n                        />\r\n                        <Route exact path='/compare/:codes' render={(props) =>\r\n                            <Compare {...props}\r\n                                percentileArrays={this.state.percentileArrays}\r\n                                isMobile={isMobileOnly}\r\n                                isSafari={isSafari}\r\n                                updatePercentileArrays={this.updatePercentileArrays}\r\n                            />}\r\n                        />\r\n                        <Route component={Error}/>\r\n                    </Switch>\r\n                </BrowserRouter>\r\n            );\r\n\r\n            return (\r\n                <Switch>\r\n                    <App/>\r\n                </Switch>\r\n            );\r\n\r\n        }\r\n\r\n    }\r\n\r\n}\r\n\r\nexport default App;\r\n","import React from 'react';\r\nimport { render } from 'react-dom';\r\nimport { BrowserRouter } from 'react-router-dom';\r\n\r\nimport './index.css';\r\nimport App from './App/App';\r\n\r\nrender((\r\n    <BrowserRouter>\r\n        <App/>\r\n    </BrowserRouter>\r\n), document.getElementById('root'));"],"sourceRoot":""}